from fastapi import FastAPI, HTTPException
from fastapi.responses import HTMLResponse
from pydantic import BaseModel
import logging
import time
import numpy as np
from sklearn.feature_extraction.text import TfidfVectorizer
from sklearn.metrics.pairwise import cosine_similarity
import json
from pathlib import Path
from typing import Dict, List, Tuple
import base64
import tempfile
import os
import re

# Import the robust TTS stack with gTTS for Indian languages
import whisper
from transformers import pipeline
from gtts import gTTS
import platform

# Configure logging
logging.basicConfig(level=logging.INFO)
logger = logging.getLogger(__name__)

# Load Whisper model (small = good balance of speed & accuracy)
logger.info("üé§ Loading Whisper model (this may take a moment)...")
whisper_model = whisper.load_model("tiny")  # Using tiny model for faster loading
logger.info("‚úÖ Whisper model loaded successfully!")

# Skip DialoGPT - too slow and unhelpful!
logger.info("üåæ Using Fast Agriculture Assistant instead of DialoGPT...")

app = FastAPI(title="üåæ Fast Agriculture AI with Whisper + Smart RAG + gTTS", version="5.0.0")

# Comprehensive Global Agriculture Knowledge Base
FALLBACK_KB = {
    "crops": {
        # Cereals/Grains
        "rice": {
            "en": "Rice is a staple grain crop. Best grown in flooded fields. Requires 4-6 months growing season. Plant during monsoon. Harvest when grains turn golden. Major varieties: Basmati, Jasmine, Arborio.",
            "ta": "‡ÆÖ‡Æ∞‡Æø‡Æö‡Æø ‡Æí‡Æ∞‡ØÅ ‡ÆÆ‡ØÅ‡Æï‡Øç‡Æï‡Æø‡ÆØ ‡Æ§‡Ææ‡Æ©‡Æø‡ÆØ ‡Æ™‡ÆØ‡Æø‡Æ∞‡Øç. ‡Æµ‡ØÜ‡Æ≥‡Øç‡Æ≥‡ÆÆ‡Øç ‡Æ®‡Æø‡Æ±‡Øà‡Æ®‡Øç‡Æ§ ‡Æµ‡ÆØ‡Æ≤‡Øç‡Æï‡Æ≥‡Æø‡Æ≤‡Øç ‡Æö‡Æø‡Æ±‡Æ™‡Øç‡Æ™‡Ææ‡Æï ‡Æµ‡Æ≥‡Æ∞‡ØÅ‡ÆÆ‡Øç. 4-6 ‡ÆÆ‡Ææ‡Æ§ ‡Æµ‡Æ≥‡Æ∞‡Øç‡Æö‡Øç‡Æö‡Æø ‡Æï‡Ææ‡Æ≤‡ÆÆ‡Øç ‡Æ§‡Øá‡Æµ‡Øà‡•§ ‡Æ™‡Æ∞‡ØÅ‡Æµ‡ÆÆ‡Æ¥‡Øà‡Æï‡Øç ‡Æï‡Ææ‡Æ≤‡Æ§‡Øç‡Æ§‡Æø‡Æ≤‡Øç ‡Æ®‡Æü‡Æµ‡ØÅ ‡Æö‡ØÜ‡ÆØ‡Øç‡ÆØ‡Æµ‡ØÅ‡ÆÆ‡Øç‡•§",
            "te": "‡∞µ‡∞∞‡∞ø ‡∞™‡±ç‡∞∞‡∞ß‡∞æ‡∞® ‡∞ß‡∞æ‡∞®‡±ç‡∞Ø ‡∞™‡∞Ç‡∞ü. ‡∞®‡±Ä‡∞∞‡±Å ‡∞®‡∞ø‡∞Ç‡∞°‡∞ø‡∞® ‡∞™‡±ä‡∞≤‡∞æ‡∞≤‡±ç‡∞≤‡±ã ‡∞¨‡∞æ‡∞ó‡∞æ ‡∞™‡±Ü‡∞∞‡±Å‡∞ó‡±Å‡∞§‡±Å‡∞Ç‡∞¶‡∞ø. 4-6 ‡∞®‡±Ü‡∞≤‡∞≤ ‡∞™‡±Ü‡∞∞‡±Å‡∞ó‡±Å‡∞¶‡∞≤ ‡∞ï‡∞æ‡∞≤‡∞Ç ‡∞Ö‡∞µ‡Æö‡∞∞‡∞Ç.",
            "ml": "‡¥Ö‡¥∞‡¥ø ‡¥í‡¥∞‡µÅ ‡¥™‡µç‡¥∞‡¥ß‡¥æ‡¥® ‡¥ß‡¥æ‡¥®‡µç‡¥Ø ‡¥µ‡¥ø‡¥≥. ‡¥µ‡µÜ‡¥≥‡µç‡¥≥‡¥Ç ‡¥®‡¥ø‡¥±‡¥û‡µç‡¥û ‡¥µ‡¥Ø‡¥≤‡µÅ‡¥ï‡¥≥‡¥ø‡µΩ ‡¥®‡¥®‡µç‡¥®‡¥æ‡¥Ø‡¥ø ‡¥µ‡¥≥‡¥∞‡µÅ‡¥Ç. 4-6 ‡¥Æ‡¥æ‡¥∏‡¥§‡µç‡¥§‡µÜ ‡¥µ‡¥≥‡µº‡¥ö‡µç‡¥ö‡¥æ‡¥ï‡¥æ‡¥≤‡¥Ç ‡¥Ü‡¥µ‡¥∂‡µç‡¥Ø‡¥Ç‡•§",
            "hi": "‡§ö‡§æ‡§µ‡§≤ ‡§è‡§ï ‡§Æ‡•Å‡§ñ‡•ç‡§Ø ‡§Ö‡§®‡§æ‡§ú ‡§ï‡•Ä ‡§´‡§∏‡§≤ ‡§π‡•à‡•§ ‡§¨‡§æ‡§¢‡§º ‡§µ‡§æ‡§≤‡•á ‡§ñ‡•á‡§§‡•ã‡§Ç ‡§Æ‡•á‡§Ç ‡§∏‡§¨‡§∏‡•á ‡§Ö‡§ö‡•ç‡§õ‡•Ä ‡§§‡§∞‡§π ‡§â‡§ó‡§§‡§æ ‡§π‡•à‡•§ 4-6 ‡§Æ‡§π‡•Ä‡§®‡•á ‡§ï‡•Ä ‡§¨‡§¢‡§º‡§®‡•á ‡§ï‡•Ä ‡§Ö‡§µ‡§ß‡§ø ‡§ö‡§æ‡§π‡§ø‡§è‡•§"
        },
        "wheat": {
            "en": "Wheat is a major cereal grain. Grows best in temperate climates. Sow in October-November. Harvest in March-April. Requires well-drained soil.",
            "ta": "‡Æï‡Øã‡Æ§‡ØÅ‡ÆÆ‡Øà ‡Æí‡Æ∞‡ØÅ ‡ÆÆ‡ØÅ‡Æï‡Øç‡Æï‡Æø‡ÆØ ‡Æ§‡Ææ‡Æ©‡Æø‡ÆØ ‡Æ™‡ÆØ‡Æø‡Æ∞‡Øç. ‡ÆÆ‡Æø‡Æ§‡ÆÆ‡Ææ‡Æ© ‡Æï‡Ææ‡Æ≤‡Æ®‡Æø‡Æ≤‡Øà‡ÆØ‡Æø‡Æ≤‡Øç ‡Æö‡Æø‡Æ±‡Æ™‡Øç‡Æ™‡Ææ‡Æï ‡Æµ‡Æ≥‡Æ∞‡ØÅ‡ÆÆ‡Øç. ‡ÆÖ‡Æï‡Øç‡Æü‡Øã‡Æ™‡Æ∞‡Øç-‡Æ®‡Æµ‡ÆÆ‡Øç‡Æ™‡Æ∞‡Æø‡Æ≤‡Øç ‡Æµ‡Æø‡Æ§‡Øà‡Æï‡Øç‡Æï‡Æµ‡ØÅ‡ÆÆ‡Øç‡•§",
            "te": "‡∞ó‡±ã‡∞ß‡±Å‡∞Æ ‡∞™‡±ç‡∞∞‡∞ß‡∞æ‡∞® ‡∞ß‡∞æ‡∞®‡±ç‡∞Ø ‡∞™‡∞Ç‡∞ü. ‡∞∏‡∞Æ‡∞∂‡±Ä‡∞§‡±ã‡∞∑‡±ç‡∞£ ‡∞µ‡∞æ‡∞§‡∞æ‡∞µ‡∞∞‡∞£‡∞Ç‡∞≤‡±ã ‡∞¨‡∞æ‡∞ó‡∞æ ‡∞™‡±Ü‡∞∞‡±Å‡∞ó‡±Å‡∞§‡±Å‡∞Ç‡∞¶‡∞ø‡•§",
            "ml": "‡¥ó‡µã‡¥§‡¥Æ‡µç‡¥™‡µç ‡¥í‡¥∞‡µÅ ‡¥™‡µç‡¥∞‡¥ß‡¥æ‡¥® ‡¥ß‡¥æ‡¥®‡µç‡¥Ø ‡¥µ‡¥ø‡¥≥. ‡¥Æ‡¥ø‡¥§‡¥∂‡µÄ‡¥§‡µã‡¥∑‡µç‡¥£ ‡¥ï‡¥æ‡¥≤‡¥æ‡¥µ‡¥∏‡µç‡¥•‡¥Ø‡¥ø‡µΩ ‡¥®‡¥®‡µç‡¥®‡¥æ‡¥Ø‡¥ø ‡¥µ‡¥≥‡¥∞‡µÅ‡¥Ç‡•§",
            "hi": "‡§ó‡•á‡§π‡•Ç‡§Ç ‡§è‡§ï ‡§Æ‡•Å‡§ñ‡•ç‡§Ø ‡§Ö‡§®‡§æ‡§ú ‡§π‡•à‡•§ ‡§∏‡§Æ‡§∂‡•Ä‡§§‡•ã‡§∑‡•ç‡§£ ‡§ú‡§≤‡§µ‡§æ‡§Ø‡•Å ‡§Æ‡•á‡§Ç ‡§∏‡§¨‡§∏‡•á ‡§Ö‡§ö‡•ç‡§õ‡•Ä ‡§§‡§∞‡§π ‡§â‡§ó‡§§‡§æ ‡§π‡•à‡•§"
        },
        "corn": {
            "en": "Corn/Maize is a versatile cereal crop. Requires warm climate and well-drained soil. Plant after last frost. Harvest when kernels are milky. Used for food, feed, and industrial purposes.",
            "ta": "‡Æö‡Øã‡Æ≥‡ÆÆ‡Øç ‡Æí‡Æ∞‡ØÅ ‡Æ™‡Æ≤‡Øç‡Æ®‡Øã‡Æï‡Øç‡Æï‡ØÅ ‡Æ§‡Ææ‡Æ©‡Æø‡ÆØ ‡Æ™‡ÆØ‡Æø‡Æ∞‡Øç. ‡Æµ‡ØÜ‡Æ™‡Øç‡Æ™‡ÆÆ‡Ææ‡Æ© ‡Æï‡Ææ‡Æ≤‡Æ®‡Æø‡Æ≤‡Øà ‡ÆÆ‡Æ±‡Øç‡Æ±‡ØÅ‡ÆÆ‡Øç ‡Æ®‡Æ≤‡Øç‡Æ≤ ‡Æµ‡Æü‡Æø‡Æï‡Ææ‡Æ≤‡Øç ‡ÆÆ‡Æ£‡Øç ‡Æ§‡Øá‡Æµ‡Øà‡•§",
            "te": "‡∞Æ‡±ä‡∞ï‡±ç‡∞ï‡∞ú‡±ä‡∞®‡±ç‡∞® ‡∞¨‡∞π‡±Å‡∞≥ ‡∞â‡∞™‡∞Ø‡±ã‡∞ó ‡∞ß‡∞æ‡∞®‡±ç‡∞Ø ‡∞™‡∞Ç‡∞ü. ‡∞µ‡±Ü‡∞ö‡±ç‡∞ö‡∞®‡∞ø ‡∞µ‡∞æ‡∞§‡∞æ‡∞µ‡∞∞‡∞£‡∞Ç ‡∞Æ‡∞∞‡∞ø‡∞Ø‡±Å ‡∞Æ‡∞Ç‡∞ö‡∞ø ‡∞°‡±ç‡∞∞‡±à‡∞®‡±á‡∞ú‡±ç ‡∞Ö‡∞µ‡∞∏‡∞∞‡∞Ç‡•§",
            "ml": "‡¥ö‡µã‡¥≥‡¥Ç ‡¥í‡¥∞‡µÅ ‡¥¨‡¥π‡µÅ‡¥Æ‡µÅ‡¥ñ ‡¥ß‡¥æ‡¥®‡µç‡¥Ø ‡¥µ‡¥ø‡¥≥. ‡¥ö‡µÇ‡¥ü‡µÅ‡¥≥‡µç‡¥≥ ‡¥ï‡¥æ‡¥≤‡¥æ‡¥µ‡¥∏‡µç‡¥•‡¥Ø‡µÅ‡¥Ç ‡¥®‡¥≤‡µç‡¥≤ ‡¥°‡µç‡¥∞‡µÜ‡¥Ø‡¥ø‡¥®‡µá‡¥ú‡µÅ‡¥Ç ‡¥Ü‡¥µ‡¥∂‡µç‡¥Ø‡¥Ç‡•§",
            "hi": "‡§Æ‡§ï‡•ç‡§ï‡§æ ‡§è‡§ï ‡§¨‡§π‡•Å‡§â‡§™‡§Ø‡•ã‡§ó‡•Ä ‡§Ö‡§®‡§æ‡§ú ‡§ï‡•Ä ‡§´‡§∏‡§≤ ‡§π‡•à‡•§ ‡§ó‡§∞‡•ç‡§Æ ‡§ú‡§≤‡§µ‡§æ‡§Ø‡•Å ‡§î‡§∞ ‡§Ö‡§ö‡•ç‡§õ‡•Ä ‡§ú‡§≤ ‡§®‡§ø‡§ï‡§æ‡§∏‡•Ä ‡§ö‡§æ‡§π‡§ø‡§è‡•§"
        },
        "barley": {
            "en": "Barley is a hardy cereal grain. Tolerates cool, dry conditions. Plant in fall or spring. Used for brewing, animal feed, and food.",
            "ta": "‡Æ™‡Ææ‡Æ∞‡Øç‡Æ≤‡Æø ‡Æí‡Æ∞‡ØÅ ‡Æï‡Æü‡Æø‡Æ©‡ÆÆ‡Ææ‡Æ© ‡Æ§‡Ææ‡Æ©‡Æø‡ÆØ ‡Æ™‡ÆØ‡Æø‡Æ∞‡Øç. ‡Æï‡ØÅ‡Æ≥‡Æø‡Æ∞‡Øç, ‡Æµ‡Æ±‡Æ£‡Øç‡Æü ‡Æ®‡Æø‡Æ≤‡Øà‡ÆÆ‡Øà‡Æï‡Æ≥‡Øà ‡Æ§‡Ææ‡Æô‡Øç‡Æï‡ØÅ‡ÆÆ‡Øç‡•§",
            "te": "‡∞¨‡∞æ‡∞∞‡±ç‡∞≤‡±Ä ‡∞¶‡±É‡∞¢‡∞Æ‡±à‡∞® ‡∞ß‡∞æ‡∞®‡±ç‡∞Ø ‡∞™‡∞Ç‡∞ü. ‡∞ö‡∞≤‡±ç‡∞≤‡∞®‡∞ø, ‡∞™‡±ä‡∞°‡∞ø ‡∞™‡∞∞‡∞ø‡∞∏‡±ç‡∞•‡∞ø‡∞§‡±Å‡∞≤‡∞®‡±Å ‡∞§‡∞ü‡±ç‡∞ü‡±Å‡∞ï‡±ã‡∞ó‡∞≤‡∞¶‡±Å‡•§",
            "ml": "‡¥¨‡¥æ‡µº‡¥≤‡¥ø ‡¥ï‡¥æ‡¥†‡¥ø‡¥®‡µç‡¥Ø‡¥Æ‡µÅ‡¥≥‡µç‡¥≥ ‡¥ß‡¥æ‡¥®‡µç‡¥Ø ‡¥µ‡¥ø‡¥≥. ‡¥§‡¥£‡µÅ‡¥§‡µç‡¥§, ‡¥µ‡¥∞‡¥£‡µç‡¥ü ‡¥Ö‡¥µ‡¥∏‡µç‡¥•‡¥ï‡µæ ‡¥∏‡¥π‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥Ç‡•§",
            "hi": "‡§ú‡•å ‡§è‡§ï ‡§ï‡§†‡•ã‡§∞ ‡§Ö‡§®‡§æ‡§ú ‡§π‡•à‡•§ ‡§†‡§Ç‡§°‡•Ä, ‡§∏‡•Ç‡§ñ‡•Ä ‡§™‡§∞‡§ø‡§∏‡•ç‡§•‡§ø‡§§‡§ø‡§Ø‡•ã‡§Ç ‡§ï‡•ã ‡§∏‡§π‡§® ‡§ï‡§∞‡§§‡§æ ‡§π‡•à‡•§"
        },
        "oats": {
            "en": "Oats are cool-season cereal grain. Prefer cooler climates. Plant in early spring or fall. Good for human consumption and animal feed.",
            "ta": "‡Æì‡Æü‡Øç‡Æ∏‡Øç ‡Æï‡ØÅ‡Æ≥‡Æø‡Æ∞‡Øç‡Æï‡Ææ‡Æ≤ ‡Æ§‡Ææ‡Æ©‡Æø‡ÆØ ‡Æ™‡ÆØ‡Æø‡Æ∞‡Øç. ‡Æï‡ØÅ‡Æ≥‡Æø‡Æ∞‡Øç‡Æ®‡Øç‡Æ§ ‡Æï‡Ææ‡Æ≤‡Æ®‡Æø‡Æ≤‡Øà‡ÆØ‡Øà ‡Æµ‡Æø‡Æ∞‡ØÅ‡ÆÆ‡Øç‡Æ™‡ØÅ‡ÆÆ‡Øç‡•§",
            "te": "‡∞µ‡±ã‡∞ü‡±ç‡∞∏‡±ç ‡∞ö‡∞≤‡±ç‡∞≤‡∞®‡∞ø ‡∞ï‡∞æ‡∞≤‡∞Ç ‡∞ß‡∞æ‡∞®‡±ç‡∞Ø ‡∞™‡∞Ç‡∞ü. ‡∞ö‡∞≤‡±ç‡∞≤‡∞®‡∞ø ‡∞µ‡∞æ‡∞§‡∞æ‡∞µ‡∞∞‡∞£‡∞æ‡∞®‡±ç‡∞®‡∞ø ‡∞á‡∞∑‡±ç‡∞ü‡∞™‡∞°‡±Å‡∞§‡±Å‡∞Ç‡∞¶‡∞ø‡•§",
            "ml": "‡¥ì‡¥ü‡µç‡¥∏‡µç ‡¥§‡¥£‡µÅ‡¥§‡µç‡¥§ ‡¥ï‡¥æ‡¥≤‡¥æ‡¥µ‡¥∏‡µç‡¥•‡¥Ø‡¥ø‡¥≤‡µÜ ‡¥ß‡¥æ‡¥®‡µç‡¥Ø ‡¥µ‡¥ø‡¥≥. ‡¥§‡¥£‡µÅ‡¥§‡µç‡¥§ ‡¥ï‡¥æ‡¥≤‡¥æ‡¥µ‡¥∏‡µç‡¥• ‡¥á‡¥∑‡µç‡¥ü‡¥™‡µç‡¥™‡µÜ‡¥ü‡µÅ‡¥®‡µç‡¥®‡µÅ‡•§",
            "hi": "‡§ú‡§à ‡§†‡§Ç‡§°‡•á ‡§Æ‡•å‡§∏‡§Æ ‡§ï‡§æ ‡§Ö‡§®‡§æ‡§ú ‡§π‡•à‡•§ ‡§†‡§Ç‡§°‡•Ä ‡§ú‡§≤‡§µ‡§æ‡§Ø‡•Å ‡§™‡§∏‡§Ç‡§¶ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à‡•§"
        },
        # Legumes/Pulses
        "soybeans": {
            "en": "Soybeans are protein-rich legumes. Require warm growing season. Plant after soil warms. Fix nitrogen in soil. Harvest when pods rattle.",
            "ta": "‡Æö‡Øã‡ÆØ‡Ææ‡Æ™‡ØÄ‡Æ©‡Øç ‡Æ™‡ØÅ‡Æ∞‡Æ§‡ÆÆ‡Øç ‡Æ®‡Æø‡Æ±‡Øà‡Æ®‡Øç‡Æ§ ‡Æ™‡Æ∞‡ØÅ‡Æ™‡Øç‡Æ™‡ØÅ ‡Æµ‡Æï‡Øà‡•§ ‡Æµ‡ØÜ‡Æ™‡Øç‡Æ™‡ÆÆ‡Ææ‡Æ© ‡Æµ‡Æ≥‡Æ∞‡Øç‡Æö‡Øç‡Æö‡Æø ‡Æï‡Ææ‡Æ≤‡ÆÆ‡Øç ‡Æ§‡Øá‡Æµ‡Øà‡•§",
            "te": "‡∞∏‡±ã‡∞Ø‡∞æ‡∞¨‡±Ä‡∞®‡±ç‡∞∏‡±ç ‡∞™‡±ç‡∞∞‡±ã‡∞ü‡±Ä‡∞®‡±ç ‡∞Ö‡∞ß‡∞ø‡∞ï‡∞Ç‡∞ó‡∞æ ‡∞â‡∞Ç‡∞°‡±á ‡∞ó‡∞ø‡∞Ç‡∞ú‡∞≤‡±Å. ‡∞µ‡±Ü‡∞ö‡±ç‡∞ö‡∞®‡∞ø ‡∞™‡±Ü‡∞∞‡±Å‡∞ó‡±Å‡∞¶‡∞≤ ‡∞ï‡∞æ‡∞≤‡∞Ç ‡∞Ö‡∞µ‡∞∏‡∞∞‡∞Ç‡•§",
            "ml": "‡¥∏‡µã‡¥Ø‡¥æ‡¥¨‡µÄ‡µª ‡¥™‡µç‡¥∞‡µã‡¥ü‡µç‡¥ü‡µÄ‡µª ‡¥∏‡¥Æ‡µç‡¥™‡µÅ‡¥∑‡µç‡¥ü‡¥Æ‡¥æ‡¥Ø ‡¥™‡¥Ø‡µº‡¥µ‡µº‡¥ó‡µç‡¥ó‡¥Ç. ‡¥ö‡µÇ‡¥ü‡µÅ‡¥≥‡µç‡¥≥ ‡¥µ‡¥≥‡µº‡¥ö‡µç‡¥ö‡¥æ ‡¥ï‡¥æ‡¥≤‡¥æ‡¥µ‡¥∏‡µç‡¥• ‡¥Ü‡¥µ‡¥∂‡µç‡¥Ø‡¥Ç‡•§",
            "hi": "‡§∏‡•ã‡§Ø‡§æ‡§¨‡•Ä‡§® ‡§™‡•ç‡§∞‡•ã‡§ü‡•Ä‡§® ‡§Ø‡•Å‡§ï‡•ç‡§§ ‡§¶‡§≤‡§π‡§® ‡§π‡•à‡•§ ‡§ó‡§∞‡•ç‡§Æ ‡§¨‡§¢‡§º‡§®‡•á ‡§ï‡§æ ‡§Æ‡•å‡§∏‡§Æ ‡§ö‡§æ‡§π‡§ø‡§è‡•§"
        },
        "chickpeas": {
            "en": "Chickpeas are drought-tolerant legumes. Prefer cool, dry conditions. Plant in winter/spring. Fix nitrogen. Good protein source.",
            "ta": "‡Æï‡Øä‡Æ£‡Øç‡Æü‡Øà‡Æï‡Øç‡Æï‡Æü‡Æ≤‡Øà ‡Æµ‡Æ±‡Æü‡Øç‡Æö‡Æø‡ÆØ‡Øà ‡Æ§‡Ææ‡Æô‡Øç‡Æï‡ØÅ‡ÆÆ‡Øç ‡Æ™‡Æ∞‡ØÅ‡Æ™‡Øç‡Æ™‡ØÅ ‡Æµ‡Æï‡Øà‡•§ ‡Æï‡ØÅ‡Æ≥‡Æø‡Æ∞‡Øç, ‡Æµ‡Æ±‡Æ£‡Øç‡Æü ‡Æ®‡Æø‡Æ≤‡Øà‡ÆÆ‡Øà‡Æï‡Æ≥‡Øà ‡Æµ‡Æø‡Æ∞‡ØÅ‡ÆÆ‡Øç‡Æ™‡ØÅ‡ÆÆ‡Øç‡•§",
            "te": "‡∞∂‡∞®‡∞ó‡∞≤‡±Å ‡∞ï‡∞∞‡±Å‡∞µ‡±Å ‡∞§‡∞ü‡±ç‡∞ü‡±Å‡∞ï‡±Å‡∞®‡±á ‡∞ó‡∞ø‡∞Ç‡∞ú‡∞≤‡±Å. ‡∞ö‡∞≤‡±ç‡∞≤‡∞®‡∞ø, ‡∞™‡±ä‡∞°‡∞ø ‡∞™‡∞∞‡∞ø‡∞∏‡±ç‡∞•‡∞ø‡∞§‡±Å‡∞≤‡∞®‡±Å ‡∞á‡∞∑‡±ç‡∞ü‡∞™‡∞°‡∞§‡∞æ‡∞Ø‡∞ø‡•§",
            "ml": "‡¥ö‡µÜ‡¥±‡µÅ‡¥™‡¥Ø‡µº ‡¥µ‡¥∞‡µæ‡¥ö‡µç‡¥ö ‡¥∏‡¥π‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥®‡µç‡¥® ‡¥™‡¥Ø‡µº‡¥µ‡µº‡¥ó‡µç‡¥ó‡¥Ç. ‡¥§‡¥£‡µÅ‡¥§‡µç‡¥§, ‡¥µ‡¥∞‡¥£‡µç‡¥ü ‡¥Ö‡¥µ‡¥∏‡µç‡¥•‡¥ï‡µæ ‡¥á‡¥∑‡µç‡¥ü‡¥™‡µç‡¥™‡µÜ‡¥ü‡µÅ‡¥®‡µç‡¥®‡µÅ‡•§",
            "hi": "‡§ö‡§®‡§æ ‡§∏‡•Ç‡§ñ‡§æ ‡§∏‡§π‡§®‡•á ‡§µ‡§æ‡§≤‡•Ä ‡§¶‡§æ‡§≤ ‡§π‡•à‡•§ ‡§†‡§Ç‡§°‡•Ä, ‡§∏‡•Ç‡§ñ‡•Ä ‡§™‡§∞‡§ø‡§∏‡•ç‡§•‡§ø‡§§‡§ø‡§Ø‡§æ‡§Ç ‡§™‡§∏‡§Ç‡§¶ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à‡•§"
        },
        "lentils": {
            "en": "Lentils are cool-season legumes. Tolerate frost. Plant in fall or early spring. Quick-growing protein crop. Various colors available.",
            "ta": "‡Æ™‡Æ∞‡ØÅ‡Æ™‡Øç‡Æ™‡ØÅ ‡Æï‡ØÅ‡Æ≥‡Æø‡Æ∞‡Øç‡Æï‡Ææ‡Æ≤ ‡Æ™‡Æ∞‡ØÅ‡Æ™‡Øç‡Æ™‡ØÅ ‡Æµ‡Æï‡Øà‡•§ ‡Æâ‡Æ±‡Øà‡Æ™‡Æ©‡Æø‡ÆØ‡Øà ‡Æ§‡Ææ‡Æô‡Øç‡Æï‡ØÅ‡ÆÆ‡Øç. ‡Æá‡Æ≤‡Øà‡ÆØ‡ØÅ‡Æ§‡Æø‡Æ∞‡Øç ‡ÆÖ‡Æ≤‡Øç‡Æ≤‡Æ§‡ØÅ ‡Æµ‡Æö‡Æ®‡Øç‡Æ§ ‡Æï‡Ææ‡Æ≤‡Æ§‡Øç‡Æ§‡Æø‡Æ≤‡Øç ‡Æ®‡Æü‡Æµ‡ØÅ‡•§",
            "te": "‡∞Æ‡∞∏‡±Ç‡∞∞‡±ç ‡∞ö‡∞≤‡±ç‡∞≤‡∞®‡∞ø ‡∞ï‡∞æ‡∞≤‡∞Ç ‡∞ó‡∞ø‡∞Ç‡∞ú‡∞≤‡±Å. ‡∞Æ‡∞Ç‡∞ö‡±Å‡∞®‡±Å ‡∞§‡∞ü‡±ç‡∞ü‡±Å‡∞ï‡±Å‡∞Ç‡∞ü‡∞æ‡∞Ø‡∞ø‡•§",
            "ml": "‡¥™‡¥Ø‡µº ‡¥§‡¥£‡µÅ‡¥§‡µç‡¥§ ‡¥ï‡¥æ‡¥≤‡¥æ‡¥µ‡¥∏‡µç‡¥•‡¥Ø‡¥ø‡¥≤‡µÜ ‡¥™‡¥Ø‡µº‡¥µ‡µº‡¥ó‡µç‡¥ó‡¥Ç. ‡¥§‡µÅ‡¥∑‡¥æ‡¥∞‡¥Ç ‡¥∏‡¥π‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥Ç‡•§",
            "hi": "‡§Æ‡§∏‡•Ç‡§∞ ‡§†‡§Ç‡§°‡•á ‡§Æ‡•å‡§∏‡§Æ ‡§ï‡•Ä ‡§¶‡§æ‡§≤ ‡§π‡•à‡•§ ‡§™‡§æ‡§≤‡§æ ‡§∏‡§π‡§® ‡§ï‡§∞‡§§‡•Ä ‡§π‡•à‡•§"
        },
        # Vegetables
        "tomatoes": {
            "en": "Tomatoes are warm-season vegetables. Need support structures. Require consistent watering. Harvest when fully colored but firm.",
            "ta": "‡Æ§‡Æï‡Øç‡Æï‡Ææ‡Æ≥‡Æø ‡Æµ‡ØÜ‡Æ™‡Øç‡Æ™‡Æï‡Ææ‡Æ≤ ‡Æï‡Ææ‡ÆØ‡Øç‡Æï‡Æ±‡Æø‡•§ ‡ÆÜ‡Æ§‡Ææ‡Æ∞ ‡Æï‡Æü‡Øç‡Æü‡ÆÆ‡Øà‡Æ™‡Øç‡Æ™‡ØÅ ‡Æ§‡Øá‡Æµ‡Øà‡•§ ‡Æ®‡Æø‡Æ≤‡Øà‡ÆØ‡Ææ‡Æ© ‡Æ®‡ØÄ‡Æ∞‡Øç‡Æ™‡Øç‡Æ™‡Ææ‡Æö‡Æ©‡ÆÆ‡Øç ‡Æ§‡Øá‡Æµ‡Øà‡•§",
            "te": "‡∞ü‡∞Æ‡±ã‡∞ü‡∞æ‡∞≤‡±Å ‡∞µ‡±á‡∞∏‡∞µ‡∞ø ‡∞ï‡∞æ‡∞≤‡∞™‡±Å ‡∞ï‡±Ç‡∞∞‡∞ó‡∞æ‡∞Ø‡∞≤‡±Å. ‡∞Æ‡∞¶‡±ç‡∞¶‡∞§‡±Å ‡∞®‡∞ø‡∞∞‡±ç‡∞Æ‡∞æ‡∞£‡∞æ‡∞≤‡±Å ‡∞Ö‡∞µ‡∞∏‡∞∞‡∞Ç‡•§",
            "ml": "‡¥§‡¥ï‡µç‡¥ï‡¥æ‡¥≥‡¥ø ‡¥µ‡µá‡¥®‡µΩ‡¥ï‡µç‡¥ï‡¥æ‡¥≤ ‡¥™‡¥ö‡µç‡¥ö‡¥ï‡µç‡¥ï‡¥±‡¥ø. ‡¥™‡¥ø‡¥®‡µç‡¥§‡µÅ‡¥£ ‡¥ò‡¥ü‡¥®‡¥ï‡µæ ‡¥Ü‡¥µ‡¥∂‡µç‡¥Ø‡¥Ç‡•§",
            "hi": "‡§ü‡§Æ‡§æ‡§ü‡§∞ ‡§ó‡§∞‡•ç‡§Æ ‡§Æ‡•å‡§∏‡§Æ ‡§ï‡•Ä ‡§∏‡§¨‡•ç‡§ú‡•Ä ‡§π‡•à‡•§ ‡§∏‡§π‡§æ‡§∞‡•á ‡§ï‡•Ä ‡§∏‡§Ç‡§∞‡§ö‡§®‡§æ ‡§ö‡§æ‡§π‡§ø‡§è‡•§"
        },
        "potatoes": {
            "en": "Potatoes are cool-season tubers. Plant in early spring. Hill soil around plants. Harvest when tops die back. Store in cool, dark place.",
            "ta": "‡Æâ‡Æ∞‡ØÅ‡Æ≥‡Øà‡Æï‡Øç‡Æï‡Æø‡Æ¥‡Æô‡Øç‡Æï‡ØÅ ‡Æï‡ØÅ‡Æ≥‡Æø‡Æ∞‡Øç‡Æï‡Ææ‡Æ≤ ‡Æï‡Æø‡Æ¥‡Æô‡Øç‡Æï‡ØÅ ‡Æµ‡Æï‡Øà‡•§ ‡Æµ‡Æö‡Æ®‡Øç‡Æ§ ‡Æï‡Ææ‡Æ≤‡Æ§‡Øç‡Æ§‡Æø‡Æ©‡Øç ‡ÆÜ‡Æ∞‡ÆÆ‡Øç‡Æ™‡Æ§‡Øç‡Æ§‡Æø‡Æ≤‡Øç ‡Æ®‡Æü‡Æµ‡ØÅ ‡Æö‡ØÜ‡ÆØ‡Øç‡ÆØ‡Æµ‡ØÅ‡ÆÆ‡Øç‡•§",
            "te": "‡∞¨‡∞Ç‡∞ó‡∞æ‡∞≥‡∞æ‡∞¶‡±Å‡∞Ç‡∞™‡∞≤‡±Å ‡∞ö‡∞≤‡±ç‡∞≤‡∞®‡∞ø ‡∞ï‡∞æ‡∞≤‡∞Ç ‡∞ó‡∞°‡±ç‡∞°‡∞ï‡∞Ç‡∞¶. ‡∞µ‡∞∏‡∞Ç‡∞§ ‡∞ã‡∞§‡±Å‡∞µ‡±Å ‡∞™‡±ç‡∞∞‡∞æ‡∞∞‡∞Ç‡∞≠‡∞Ç‡∞≤‡±ã ‡∞®‡∞æ‡∞ü‡∞æ‡∞≤‡∞ø‡•§",
            "ml": "‡¥â‡¥∞‡µÅ‡¥≥‡¥ï‡µç‡¥ï‡¥ø‡¥¥‡¥ô‡µç‡¥ô‡µç ‡¥§‡¥£‡µÅ‡¥§‡µç‡¥§ ‡¥ï‡¥æ‡¥≤‡¥æ‡¥µ‡¥∏‡µç‡¥•‡¥Ø‡¥ø‡¥≤‡µÜ ‡¥ï‡¥ø‡¥¥‡¥ô‡µç‡¥ô‡µç. ‡¥µ‡¥∏‡¥®‡µç‡¥§‡¥§‡µç‡¥§‡¥ø‡¥®‡µç‡¥±‡µÜ ‡¥§‡µÅ‡¥ü‡¥ï‡µç‡¥ï‡¥§‡µç‡¥§‡¥ø‡µΩ ‡¥®‡¥ü‡µÅ‡¥ï‡•§",
            "hi": "‡§Ü‡§≤‡•Ç ‡§†‡§Ç‡§°‡•á ‡§Æ‡•å‡§∏‡§Æ ‡§ï‡§æ ‡§ï‡§Ç‡§¶ ‡§π‡•à‡•§ ‡§µ‡§∏‡§Ç‡§§ ‡§ï‡•Ä ‡§∂‡•Å‡§∞‡•Å‡§Ü‡§§ ‡§Æ‡•á‡§Ç ‡§≤‡§ó‡§æ‡§è‡§Ç‡•§"
        },
        "onions": {
            "en": "Onions are biennial bulbs grown as annuals. Prefer cool weather for growth, warm weather for bulbing. Long day vs short day varieties.",
            "ta": "‡Æµ‡ØÜ‡Æô‡Øç‡Æï‡Ææ‡ÆØ‡ÆÆ‡Øç ‡Æá‡Æ∞‡ØÅ ‡ÆÜ‡Æ£‡Øç‡Æü‡ØÅ ‡Æ™‡ÆØ‡Æø‡Æ∞‡Ææ‡Æï ‡Æµ‡Æ≥‡Æ∞‡Øç‡Æï‡Øç‡Æï‡Æ™‡Øç‡Æ™‡Æü‡ØÅ‡ÆÆ‡Øç ‡ÆÜ‡Æ£‡Øç‡Æü‡ØÅ ‡Æ™‡ÆØ‡Æø‡Æ∞‡Øç. ‡Æµ‡Æ≥‡Æ∞‡Øç‡Æö‡Øç‡Æö‡Æø‡Æï‡Øç‡Æï‡ØÅ ‡Æï‡ØÅ‡Æ≥‡Æø‡Æ∞‡Øç ‡Æï‡Ææ‡Æ≤‡Æ®‡Æø‡Æ≤‡Øà‡ÆØ‡Øà ‡Æµ‡Æø‡Æ∞‡ØÅ‡ÆÆ‡Øç‡Æ™‡ØÅ‡ÆÆ‡Øç‡•§",
            "te": "‡∞â‡∞≤‡±ç‡∞≤‡∞ø‡∞™‡∞æ‡∞Ø‡∞≤‡±Å ‡∞∞‡±Ü‡∞Ç‡∞°‡±á‡∞≥‡±ç‡∞≤ ‡∞¨‡∞≤‡±ç‡∞¨‡±Å‡∞≤‡±Å ‡∞µ‡∞æ‡∞∞‡±ç‡∞∑‡∞ø‡∞ï ‡∞™‡∞Ç‡∞ü‡∞≤‡±Å‡∞ó‡∞æ ‡∞™‡±Ü‡∞∞‡±Å‡∞ó‡±Å‡∞§‡∞æ‡∞Ø‡∞ø‡•§ ‡∞™‡±Ü‡∞∞‡±Å‡∞ó‡±Å‡∞¶‡∞≤‡∞ï‡±Å ‡∞ö‡∞≤‡±ç‡∞≤‡∞®‡∞ø ‡∞µ‡∞æ‡∞§‡∞æ‡∞µ‡∞∞‡∞£‡∞Ç ‡∞ï‡∞æ‡∞µ‡∞æ‡∞≤‡∞ø‡•§",
            "ml": "‡¥â‡¥≥‡µç‡¥≥‡¥ø ‡¥µ‡¥æ‡µº‡¥∑‡¥ø‡¥ï ‡¥µ‡¥ø‡¥≥‡¥Ø‡¥æ‡¥Ø‡¥ø ‡¥µ‡¥≥‡µº‡¥§‡µç‡¥§‡µÅ‡¥®‡µç‡¥® ‡¥¶‡µç‡¥µ‡¥ø‡¥µ‡¥æ‡µº‡¥∑‡¥ø‡¥ï ‡¥¨‡µæ‡¥¨‡µÅ‡¥ï‡µæ. ‡¥µ‡¥≥‡µº‡¥ö‡µç‡¥ö‡¥Ø‡µç‡¥ï‡µç‡¥ï‡µç ‡¥§‡¥£‡µÅ‡¥§‡µç‡¥§ ‡¥ï‡¥æ‡¥≤‡¥æ‡¥µ‡¥∏‡µç‡¥• ‡¥á‡¥∑‡µç‡¥ü‡¥™‡µç‡¥™‡µÜ‡¥ü‡µÅ‡¥®‡µç‡¥®‡µÅ‡•§",
            "hi": "‡§™‡•ç‡§Ø‡§æ‡§ú ‡§¶‡•ç‡§µ‡§ø‡§µ‡§æ‡§∞‡•ç‡§∑‡§ø‡§ï ‡§¨‡§≤‡•ç‡§¨ ‡§π‡•à‡§Ç ‡§ú‡•ã ‡§µ‡§æ‡§∞‡•ç‡§∑‡§ø‡§ï ‡§´‡§∏‡§≤ ‡§ï‡•á ‡§∞‡•Ç‡§™ ‡§Æ‡•á‡§Ç ‡§â‡§ó‡§æ‡§è ‡§ú‡§æ‡§§‡•á ‡§π‡•à‡§Ç‡•§"
        },
        "carrots": {
            "en": "Carrots are cool-season root vegetables. Need loose, deep soil. Direct seed in garden. Thin seedlings. Harvest when roots reach desired size.",
            "ta": "‡Æï‡Øá‡Æ∞‡Æü‡Øç ‡Æï‡ØÅ‡Æ≥‡Æø‡Æ∞‡Øç‡Æï‡Ææ‡Æ≤ ‡Æµ‡Øá‡Æ∞‡Øç ‡Æï‡Ææ‡ÆØ‡Øç‡Æï‡Æ±‡Æø‡•§ ‡Æ§‡Æ≥‡Æ∞‡Øç‡Æµ‡Ææ‡Æ©, ‡ÆÜ‡Æ¥‡ÆÆ‡Ææ‡Æ© ‡ÆÆ‡Æ£‡Øç ‡Æ§‡Øá‡Æµ‡Øà‡•§ ‡Æ§‡Øã‡Æü‡Øç‡Æü‡Æ§‡Øç‡Æ§‡Æø‡Æ≤‡Øç ‡Æ®‡Øá‡Æ∞‡Æü‡Æø ‡Æµ‡Æø‡Æ§‡Øà‡•§",
            "te": "‡∞ï‡±ç‡∞Ø‡∞æ‡∞∞‡±Ü‡∞ü‡±ç‡∞≤‡±Å ‡∞ö‡∞≤‡±ç‡∞≤‡∞®‡∞ø ‡∞ï‡∞æ‡∞≤‡∞™‡±Å ‡∞µ‡±á‡∞∞‡±Å ‡∞ï‡±Ç‡∞∞‡∞ó‡∞æ‡∞Ø‡∞≤‡±Å. ‡∞µ‡∞¶‡±Å‡∞≤‡±Å‡∞ó‡∞æ, ‡∞≤‡±ã‡∞§‡±à‡∞® ‡∞Æ‡∞ü‡±ç‡∞ü‡∞ø ‡∞Ö‡∞µ‡∞∏‡∞∞‡∞Ç‡•§",
            "ml": "‡¥ï‡¥æ‡¥∞‡¥±‡µç‡¥±‡µç ‡¥§‡¥£‡µÅ‡¥§‡µç‡¥§ ‡¥ï‡¥æ‡¥≤‡¥æ‡¥µ‡¥∏‡µç‡¥•‡¥Ø‡¥ø‡¥≤‡µÜ ‡¥µ‡µá‡¥∞‡µç ‡¥™‡¥ö‡µç‡¥ö‡¥ï‡µç‡¥ï‡¥±‡¥ø. ‡¥Ö‡¥Ø‡¥û‡µç‡¥û‡¥§‡µÅ‡¥Ç ‡¥Ü‡¥¥‡¥Æ‡µÅ‡¥≥‡µç‡¥≥‡¥§‡µÅ‡¥Æ‡¥æ‡¥Ø ‡¥Æ‡¥£‡µç‡¥£‡µç ‡¥Ü‡¥µ‡¥∂‡µç‡¥Ø‡¥Ç‡•§",
            "hi": "‡§ó‡§æ‡§ú‡§∞ ‡§†‡§Ç‡§°‡•á ‡§Æ‡•å‡§∏‡§Æ ‡§ï‡•Ä ‡§ú‡§°‡§º ‡§∏‡§¨‡•ç‡§ú‡•Ä ‡§π‡•à‡•§ ‡§¢‡•Ä‡§≤‡•Ä, ‡§ó‡§π‡§∞‡•Ä ‡§Æ‡§ø‡§ü‡•ç‡§ü‡•Ä ‡§ö‡§æ‡§π‡§ø‡§è‡•§"
        },
        # Fruits
        "apples": {
            "en": "Apples are temperate fruit trees. Require chill hours in winter. Plant in spring. Need cross-pollination. Harvest in fall when ripe.",
            "ta": "‡ÆÜ‡Æ™‡Øç‡Æ™‡Æø‡Æ≥‡Øç ‡ÆÆ‡Æø‡Æ§‡ÆÆ‡Ææ‡Æ© ‡Æ™‡Æ¥ ‡ÆÆ‡Æ∞‡Æô‡Øç‡Æï‡Æ≥‡Øç. ‡Æï‡ØÅ‡Æ≥‡Æø‡Æ∞‡Øç‡Æï‡Ææ‡Æ≤‡Æ§‡Øç‡Æ§‡Æø‡Æ≤‡Øç ‡Æï‡ØÅ‡Æ≥‡Æø‡Æ∞‡Øç ‡ÆÆ‡Æ£‡Æø ‡Æ®‡Øá‡Æ∞‡ÆÆ‡Øç ‡Æ§‡Øá‡Æµ‡Øà‡•§ ‡Æµ‡Æö‡Æ®‡Øç‡Æ§ ‡Æï‡Ææ‡Æ≤‡Æ§‡Øç‡Æ§‡Æø‡Æ≤‡Øç ‡Æ®‡Æü‡Æµ‡ØÅ‡•§",
            "te": "‡∞Ü‡∞™‡∞ø‡∞≤‡±ç‡∞∏‡±ç ‡∞∏‡∞Æ‡∞∂‡±Ä‡∞§‡±ã‡∞∑‡±ç‡∞£ ‡∞™‡∞Ç‡∞°‡±ç‡∞≤ ‡∞ö‡±Ü‡∞ü‡±ç‡∞≤‡±Å. ‡∞∂‡±Ä‡∞§‡∞æ‡∞ï‡∞æ‡∞≤‡∞Ç‡∞≤‡±ã ‡∞ö‡∞≤‡±ç‡∞≤‡∞®‡∞ø ‡∞ó‡∞Ç‡∞ü‡∞≤‡±Å ‡∞Ö‡∞µ‡∞∏‡∞∞‡∞Ç‡•§",
            "ml": "‡¥Ü‡¥™‡µç‡¥™‡¥ø‡µæ ‡¥Æ‡¥ø‡¥§‡¥∂‡µÄ‡¥§‡µã‡¥∑‡µç‡¥£ ‡¥´‡¥≤‡¥µ‡µÉ‡¥ï‡µç‡¥∑‡¥ô‡µç‡¥ô‡µæ. ‡¥∂‡µÄ‡¥§‡¥ï‡¥æ‡¥≤‡¥§‡µç‡¥§‡µç ‡¥§‡¥£‡µÅ‡¥§‡µç‡¥§ ‡¥Æ‡¥£‡¥ø‡¥ï‡µç‡¥ï‡µÇ‡¥±‡µÅ‡¥ï‡µæ ‡¥Ü‡¥µ‡¥∂‡µç‡¥Ø‡¥Ç‡•§",
            "hi": "‡§∏‡•á‡§¨ ‡§∏‡§Æ‡§∂‡•Ä‡§§‡•ã‡§∑‡•ç‡§£ ‡§´‡§≤‡•ã‡§Ç ‡§ï‡•á ‡§™‡•á‡§°‡§º ‡§π‡•à‡§Ç‡•§ ‡§∏‡§∞‡•ç‡§¶‡•Ä ‡§Æ‡•á‡§Ç ‡§†‡§Ç‡§°‡•á ‡§ò‡§Ç‡§ü‡•á ‡§ö‡§æ‡§π‡§ø‡§è‡•§"
        },
        "oranges": {
            "en": "Oranges are citrus fruits. Need warm, frost-free climate. Regular watering required. Harvest when fully colored and sweet.",
            "ta": "‡ÆÜ‡Æ∞‡Æû‡Øç‡Æö‡ØÅ ‡Æö‡Æø‡Æü‡Øç‡Æ∞‡Æ∏‡Øç ‡Æ™‡Æ¥‡Æô‡Øç‡Æï‡Æ≥‡Øç. ‡Æµ‡ØÜ‡Æ™‡Øç‡Æ™‡ÆÆ‡Ææ‡Æ©, ‡Æâ‡Æ±‡Øà‡Æ™‡Æ©‡Æø ‡Æá‡Æ≤‡Øç‡Æ≤‡Ææ‡Æ§ ‡Æï‡Ææ‡Æ≤‡Æ®‡Æø‡Æ≤‡Øà ‡Æ§‡Øá‡Æµ‡Øà‡•§",
            "te": "‡∞®‡∞æ‡∞∞‡∞ø‡∞Ç‡∞ú‡∞≤‡±Å ‡∞∏‡∞ø‡∞ü‡±ç‡∞∞‡∞∏‡±ç ‡∞™‡∞Ç‡∞°‡±ç‡∞≤‡±Å. ‡∞µ‡±Ü‡∞ö‡±ç‡∞ö‡∞®‡∞ø, ‡∞Æ‡∞Ç‡∞ö‡±Å ‡∞≤‡±á‡∞®‡∞ø ‡∞µ‡∞æ‡∞§‡∞æ‡∞µ‡∞∞‡∞£‡∞Ç ‡∞Ö‡∞µ‡∞∏‡∞∞‡∞Ç‡•§",
            "ml": "‡¥ì‡¥±‡¥û‡µç‡¥ö‡µç ‡¥∏‡¥ø‡¥ü‡µç‡¥∞‡¥∏‡µç ‡¥´‡¥≤‡¥ô‡µç‡¥ô‡µæ. ‡¥ö‡µÇ‡¥ü‡µÅ‡¥≥‡µç‡¥≥‡¥§‡µÅ‡¥Ç ‡¥§‡µÅ‡¥∑‡¥æ‡¥∞‡¥∞‡¥π‡¥ø‡¥§‡¥µ‡µÅ‡¥Æ‡¥æ‡¥Ø ‡¥ï‡¥æ‡¥≤‡¥æ‡¥µ‡¥∏‡µç‡¥• ‡¥Ü‡¥µ‡¥∂‡µç‡¥Ø‡¥Ç‡•§",
            "hi": "‡§∏‡§Ç‡§§‡§∞‡•á ‡§ñ‡§ü‡•ç‡§ü‡•á ‡§´‡§≤ ‡§π‡•à‡§Ç‡•§ ‡§ó‡§∞‡•ç‡§Æ, ‡§™‡§æ‡§≤‡§æ ‡§∞‡§π‡§ø‡§§ ‡§ú‡§≤‡§µ‡§æ‡§Ø‡•Å ‡§ö‡§æ‡§π‡§ø‡§è‡•§"
        },
        "bananas": {
            "en": "Bananas are tropical fruits. Need hot, humid climate. Require rich, well-drained soil. Harvest bunches when plump but green.",
            "ta": "‡Æµ‡Ææ‡Æ¥‡Øà‡Æ™‡Øç‡Æ™‡Æ¥‡ÆÆ‡Øç ‡Æµ‡ØÜ‡Æ™‡Øç‡Æ™‡ÆÆ‡Æ£‡Øç‡Æü‡Æ≤ ‡Æ™‡Æ¥‡Æô‡Øç‡Æï‡Æ≥‡Øç. ‡Æµ‡ØÜ‡Æ™‡Øç‡Æ™‡ÆÆ‡Ææ‡Æ©, ‡Æà‡Æ∞‡Æ™‡Øç‡Æ™‡Æ§‡ÆÆ‡Ææ‡Æ© ‡Æï‡Ææ‡Æ≤‡Æ®‡Æø‡Æ≤‡Øà ‡Æ§‡Øá‡Æµ‡Øà‡•§",
            "te": "‡∞Ö‡∞∞‡∞ü‡∞ø‡∞™‡∞Ç‡∞°‡±ç‡∞≤‡±Å ‡∞â‡∞∑‡±ç‡∞£‡∞Æ‡∞Ç‡∞°‡∞≤ ‡∞™‡∞Ç‡∞°‡±ç‡∞≤‡±Å. ‡∞µ‡±á‡∞°‡∞ø‡∞Æ‡∞ø‡∞ó‡∞ø‡∞≤‡∞ø‡∞®, ‡∞§‡±á‡∞Æ‡∞§‡±ã ‡∞ï‡±Ç‡∞°‡∞ø‡∞® ‡∞µ‡∞æ‡∞§‡∞æ‡∞µ‡∞∞‡∞£‡∞Ç ‡∞Ö‡∞µ‡∞∏‡∞∞‡∞Ç‡•§",
            "ml": "‡¥µ‡¥æ‡¥¥‡¥™‡µç‡¥™‡¥¥‡¥Ç ‡¥â‡¥∑‡µç‡¥£‡¥Æ‡µá‡¥ñ‡¥≤‡¥æ ‡¥´‡¥≤‡¥ô‡µç‡¥ô‡µæ. ‡¥ö‡µÇ‡¥ü‡µÅ‡¥≥‡µç‡¥≥‡¥§‡µÅ‡¥Ç ‡¥à‡µº‡¥™‡µç‡¥™‡¥Æ‡µÅ‡¥≥‡µç‡¥≥‡¥§‡µÅ‡¥Æ‡¥æ‡¥Ø ‡¥ï‡¥æ‡¥≤‡¥æ‡¥µ‡¥∏‡µç‡¥• ‡¥Ü‡¥µ‡¥∂‡µç‡¥Ø‡¥Ç‡•§",
            "hi": "‡§ï‡•á‡§≤‡•á ‡§â‡§∑‡•ç‡§£‡§ï‡§ü‡§ø‡§¨‡§Ç‡§ß‡•Ä‡§Ø ‡§´‡§≤ ‡§π‡•à‡§Ç‡•§ ‡§ó‡§∞‡•ç‡§Æ, ‡§®‡§Æ ‡§ú‡§≤‡§µ‡§æ‡§Ø‡•Å ‡§ö‡§æ‡§π‡§ø‡§è‡•§"
        },
        "grapes": {
            "en": "Grapes are perennial vines. Need warm, dry growing season. Require trellising support. Harvest when sugar content is optimal.",
            "ta": "‡Æ§‡Æø‡Æ∞‡Ææ‡Æü‡Øç‡Æö‡Øà ‡Æ™‡Æ≤ ‡ÆÜ‡Æ£‡Øç‡Æü‡ØÅ ‡Æï‡Øä‡Æü‡Æø‡Æï‡Æ≥‡Øç. ‡Æµ‡ØÜ‡Æ™‡Øç‡Æ™‡ÆÆ‡Ææ‡Æ©, ‡Æµ‡Æ±‡Æ£‡Øç‡Æü ‡Æµ‡Æ≥‡Æ∞‡Øç‡Æö‡Øç‡Æö‡Æø ‡Æï‡Ææ‡Æ≤‡ÆÆ‡Øç ‡Æ§‡Øá‡Æµ‡Øà‡•§",
            "te": "‡∞¶‡±ç‡∞∞‡∞æ‡∞ï‡±ç‡∞∑‡∞≤‡±Å ‡∞¨‡∞π‡±Å‡∞è‡∞≥‡±ç‡∞≤ ‡∞§‡±Ä‡∞ó‡∞≤‡±Å. ‡∞µ‡±Ü‡∞ö‡±ç‡∞ö‡∞®‡∞ø, ‡∞™‡±ä‡∞°‡∞ø ‡∞™‡±Ü‡∞∞‡±Å‡∞ó‡±Å‡∞¶‡∞≤ ‡∞ï‡∞æ‡∞≤‡∞Ç ‡∞Ö‡∞µ‡∞∏‡∞∞‡∞Ç‡•§",
            "ml": "‡¥Æ‡µÅ‡¥®‡µç‡¥§‡¥ø‡¥∞‡¥ø ‡¥¨‡¥π‡µÅ‡¥µ‡¥æ‡µº‡¥∑‡¥ø‡¥ï ‡¥µ‡¥≥‡µç‡¥≥‡¥ø‡¥ï‡µæ. ‡¥ö‡µÇ‡¥ü‡µÅ‡¥≥‡µç‡¥≥‡¥§‡µÅ‡¥Ç ‡¥µ‡¥∞‡¥£‡µç‡¥ü‡¥§‡µÅ‡¥Æ‡¥æ‡¥Ø ‡¥µ‡¥≥‡µº‡¥ö‡µç‡¥ö‡¥æ ‡¥ï‡¥æ‡¥≤‡¥Ç ‡¥Ü‡¥µ‡¥∂‡µç‡¥Ø‡¥Ç‡•§",
            "hi": "‡§Ö‡§Ç‡§ó‡•Ç‡§∞ ‡§¨‡§æ‡§∞‡§π‡§Æ‡§æ‡§∏‡•Ä ‡§¨‡•á‡§≤ ‡§π‡•à‡§Ç‡•§ ‡§ó‡§∞‡•ç‡§Æ, ‡§∏‡•Ç‡§ñ‡§æ ‡§¨‡§¢‡§º‡§®‡•á ‡§ï‡§æ ‡§Æ‡•å‡§∏‡§Æ ‡§ö‡§æ‡§π‡§ø‡§è‡•§"
        },
        # Cash Crops
        "cotton": {
            "en": "Cotton is a warm-season fiber crop. Requires long, hot growing season. Deep, well-drained soil needed. Harvest when bolls open.",
            "ta": "‡Æ™‡Æ∞‡ØÅ‡Æ§‡Øç‡Æ§‡Æø ‡Æµ‡ØÜ‡Æ™‡Øç‡Æ™‡Æï‡Ææ‡Æ≤ ‡Æ®‡Ææ‡Æ∞‡Øç ‡Æ™‡ÆØ‡Æø‡Æ∞‡Øç. ‡Æ®‡ØÄ‡Æ£‡Øç‡Æü, ‡Æµ‡ØÜ‡Æ™‡Øç‡Æ™‡ÆÆ‡Ææ‡Æ© ‡Æµ‡Æ≥‡Æ∞‡Øç‡Æö‡Øç‡Æö‡Æø ‡Æï‡Ææ‡Æ≤‡ÆÆ‡Øç ‡Æ§‡Øá‡Æµ‡Øà‡•§",
            "te": "‡∞™‡∞§‡±ç‡∞§‡∞ø ‡∞µ‡±á‡∞∏‡∞µ‡∞ø ‡∞ï‡∞æ‡∞≤‡∞™‡±Å ‡∞®‡∞æ‡∞∞‡±Å ‡∞™‡∞Ç‡∞ü. ‡∞∏‡±Å‡∞¶‡±Ä‡∞∞‡±ç‡∞ò‡∞Æ‡±à‡∞®, ‡∞µ‡±á‡∞°‡∞ø‡∞Æ‡∞ø‡∞ó‡∞ø‡∞≤‡∞ø‡∞® ‡∞™‡±Ü‡∞∞‡±Å‡∞ó‡±Å‡∞¶‡∞≤ ‡∞ï‡∞æ‡∞≤‡∞Ç ‡∞Ö‡∞µ‡∞∏‡∞∞‡∞Ç‡•§",
            "ml": "‡¥™‡¥∞‡µÅ‡¥§‡µç‡¥§‡¥ø ‡¥µ‡µá‡¥®‡µΩ‡¥ï‡µç‡¥ï‡¥æ‡¥≤ ‡¥®‡¥æ‡¥∞‡µç ‡¥µ‡¥ø‡¥≥. ‡¥¶‡µÄ‡µº‡¥ò‡¥µ‡µÅ‡¥Ç ‡¥ö‡µÇ‡¥ü‡µÅ‡¥≥‡µç‡¥≥‡¥§‡µÅ‡¥Æ‡¥æ‡¥Ø ‡¥µ‡¥≥‡µº‡¥ö‡µç‡¥ö‡¥æ ‡¥ï‡¥æ‡¥≤‡¥Ç ‡¥Ü‡¥µ‡¥∂‡µç‡¥Ø‡¥Ç‡•§",
            "hi": "‡§ï‡§™‡§æ‡§∏ ‡§ó‡§∞‡•ç‡§Æ ‡§Æ‡•å‡§∏‡§Æ ‡§ï‡•Ä ‡§∞‡•á‡§∂‡§æ ‡§´‡§∏‡§≤ ‡§π‡•à‡•§ ‡§≤‡§Ç‡§¨‡§æ, ‡§ó‡§∞‡•ç‡§Æ ‡§¨‡§¢‡§º‡§®‡•á ‡§ï‡§æ ‡§Æ‡•å‡§∏‡§Æ ‡§ö‡§æ‡§π‡§ø‡§è‡•§"
        },
        "sugarcane": {
            "en": "Sugarcane is a tropical cash crop. Requires hot, humid climate. 12-18 month crop cycle. Needs abundant water. Harvest when stalks are mature.",
            "ta": "‡Æï‡Æ∞‡ØÅ‡ÆÆ‡Øç‡Æ™‡ØÅ ‡Æµ‡ØÜ‡Æ™‡Øç‡Æ™‡ÆÆ‡Æ£‡Øç‡Æü‡Æ≤ ‡Æ™‡Æ£‡Æ™‡Øç ‡Æ™‡ÆØ‡Æø‡Æ∞‡Øç. ‡Æµ‡ØÜ‡Æ™‡Øç‡Æ™‡ÆÆ‡Ææ‡Æ©, ‡Æà‡Æ∞‡Æ™‡Øç‡Æ™‡Æ§‡ÆÆ‡Ææ‡Æ© ‡Æï‡Ææ‡Æ≤‡Æ®‡Æø‡Æ≤‡Øà ‡Æ§‡Øá‡Æµ‡Øà‡•§",
            "te": "‡∞ö‡±Ü‡∞∞‡∞ï‡±Å ‡∞â‡∞∑‡±ç‡∞£‡∞Æ‡∞Ç‡∞°‡∞≤ ‡∞µ‡∞æ‡∞£‡∞ø‡∞ú‡±ç‡∞Ø ‡∞™‡∞Ç‡∞ü. ‡∞µ‡±á‡∞°‡∞ø‡∞Æ‡∞ø‡∞ó‡∞ø‡∞≤‡∞ø‡∞®, ‡∞§‡±á‡∞Æ‡∞§‡±ã ‡∞ï‡±Ç‡∞°‡∞ø‡∞® ‡∞µ‡∞æ‡∞§‡∞æ‡∞µ‡∞∞‡∞£‡∞Ç ‡∞Ö‡∞µ‡∞∏‡∞∞‡∞Ç‡•§",
            "ml": "‡¥ï‡¥∞‡¥ø‡¥Æ‡µç‡¥™‡µç ‡¥â‡¥∑‡µç‡¥£‡¥Æ‡µá‡¥ñ‡¥≤‡¥æ ‡¥µ‡¥æ‡¥£‡¥ø‡¥ú‡µç‡¥Ø ‡¥µ‡¥ø‡¥≥. ‡¥ö‡µÇ‡¥ü‡µÅ‡¥≥‡µç‡¥≥‡¥§‡µÅ‡¥Ç ‡¥à‡µº‡¥™‡µç‡¥™‡¥Æ‡µÅ‡¥≥‡µç‡¥≥‡¥§‡µÅ‡¥Æ‡¥æ‡¥Ø ‡¥ï‡¥æ‡¥≤‡¥æ‡¥µ‡¥∏‡µç‡¥• ‡¥Ü‡¥µ‡¥∂‡µç‡¥Ø‡¥Ç‡•§",
            "hi": "‡§ó‡§®‡•ç‡§®‡§æ ‡§â‡§∑‡•ç‡§£‡§ï‡§ü‡§ø‡§¨‡§Ç‡§ß‡•Ä‡§Ø ‡§®‡§ï‡§¶‡•Ä ‡§´‡§∏‡§≤ ‡§π‡•à‡•§ ‡§ó‡§∞‡•ç‡§Æ, ‡§®‡§Æ ‡§ú‡§≤‡§µ‡§æ‡§Ø‡•Å ‡§ö‡§æ‡§π‡§ø‡§è‡•§"
        },
        "coffee": {
            "en": "Coffee is a tropical perennial shrub. Needs high altitude, consistent rainfall. Shade-grown preferred. Harvest cherries when ripe.",
            "ta": "‡Æï‡Ææ‡Æ™‡Æø ‡Æµ‡ØÜ‡Æ™‡Øç‡Æ™‡ÆÆ‡Æ£‡Øç‡Æü‡Æ≤ ‡Æ™‡Æ≤ ‡ÆÜ‡Æ£‡Øç‡Æü‡ØÅ ‡Æ™‡ØÅ‡Æ§‡Æ∞‡Øç. ‡Æâ‡ÆØ‡Æ∞‡Øç ‡Æ™‡Æï‡ØÅ‡Æ§‡Æø, ‡Æ®‡Æø‡Æ≤‡Øà‡ÆØ‡Ææ‡Æ© ‡ÆÆ‡Æ¥‡Øà ‡Æ§‡Øá‡Æµ‡Øà‡•§",
            "te": "‡∞ï‡∞æ‡∞´‡±Ä ‡∞â‡∞∑‡±ç‡∞£‡∞Æ‡∞Ç‡∞°‡∞≤ ‡∞¨‡∞π‡±Å‡∞è‡∞≥‡±ç‡∞≤ ‡∞™‡±ä‡∞¶. ‡∞é‡∞§‡±ç‡∞§‡±à‡∞® ‡∞™‡±ç‡∞∞‡∞æ‡∞Ç‡∞§‡∞Ç, ‡∞∏‡±ç‡∞•‡∞ø‡∞∞‡∞Æ‡±à‡∞® ‡∞µ‡∞∞‡±ç‡∞∑‡∞™‡∞æ‡∞§‡∞Ç ‡∞Ö‡∞µ‡∞∏‡∞∞‡∞Ç‡•§",
            "ml": "‡¥ï‡¥æ‡¥™‡µç‡¥™‡¥ø ‡¥â‡¥∑‡µç‡¥£‡¥Æ‡µá‡¥ñ‡¥≤‡¥æ ‡¥¨‡¥π‡µÅ‡¥µ‡¥æ‡µº‡¥∑‡¥ø‡¥ï ‡¥ï‡µÅ‡¥±‡µç‡¥±‡¥ø‡¥ö‡µç‡¥ö‡µÜ‡¥ü‡¥ø. ‡¥â‡¥Ø‡µº‡¥®‡µç‡¥® ‡¥™‡µç‡¥∞‡¥¶‡µá‡¥∂‡¥Ç, ‡¥∏‡µç‡¥•‡¥ø‡¥∞‡¥Æ‡¥æ‡¥Ø ‡¥Æ‡¥¥ ‡¥Ü‡¥µ‡¥∂‡µç‡¥Ø‡¥Ç‡•§",
            "hi": "‡§ï‡•â‡§´‡•Ä ‡§â‡§∑‡•ç‡§£‡§ï‡§ü‡§ø‡§¨‡§Ç‡§ß‡•Ä‡§Ø ‡§¨‡§æ‡§∞‡§π‡§Æ‡§æ‡§∏‡•Ä ‡§ù‡§æ‡§°‡§º‡•Ä ‡§π‡•à‡•§ ‡§ä‡§Ç‡§ö‡§æ‡§à, ‡§≤‡§ó‡§æ‡§§‡§æ‡§∞ ‡§¨‡§æ‡§∞‡§ø‡§∂ ‡§ö‡§æ‡§π‡§ø‡§è‡•§"
        },
        "tea": {
            "en": "Tea is a perennial evergreen shrub. Prefers cool, misty climate. Well-drained acidic soil needed. Harvest young leaves regularly.",
            "ta": "‡Æ§‡Øá‡ÆØ‡Æø‡Æ≤‡Øà ‡Æ™‡Æ≤ ‡ÆÜ‡Æ£‡Øç‡Æü‡ØÅ ‡Æ™‡Æö‡ØÅ‡ÆÆ‡Øà‡ÆØ‡Ææ‡Æ© ‡Æ™‡ØÅ‡Æ§‡Æ∞‡Øç. ‡Æï‡ØÅ‡Æ≥‡Æø‡Æ∞‡Øç, ‡ÆÆ‡ØÇ‡Æü‡ØÅ‡Æ™‡Æ©‡Æø ‡Æï‡Ææ‡Æ≤‡Æ®‡Æø‡Æ≤‡Øà‡ÆØ‡Øà ‡Æµ‡Æø‡Æ∞‡ØÅ‡ÆÆ‡Øç‡Æ™‡ØÅ‡ÆÆ‡Øç‡•§",
            "te": "‡∞§‡±á‡∞®‡±Ä‡∞∞‡±Å ‡∞¨‡∞π‡±Å‡∞è‡∞≥‡±ç‡∞≤ ‡∞∏‡∞§‡∞§ ‡∞π‡∞∞‡∞ø‡∞§ ‡∞™‡±ä‡∞¶. ‡∞ö‡∞≤‡±ç‡∞≤‡∞®‡∞ø, ‡∞™‡±ä‡∞ó‡∞Æ‡∞Ç‡∞ö‡±Å‡∞§‡±ã ‡∞ï‡±Ç‡∞°‡∞ø‡∞® ‡∞µ‡∞æ‡∞§‡∞æ‡∞µ‡∞∞‡∞£‡∞æ‡∞®‡±ç‡∞®‡∞ø ‡∞á‡∞∑‡±ç‡∞ü‡∞™‡∞°‡±Å‡∞§‡±Å‡∞Ç‡∞¶‡∞ø‡•§",
            "ml": "‡¥ö‡¥æ‡¥Ø ‡¥¨‡¥π‡µÅ‡¥µ‡¥æ‡µº‡¥∑‡¥ø‡¥ï ‡¥®‡¥ø‡¥§‡µç‡¥Ø‡¥π‡¥∞‡¥ø‡¥§ ‡¥ï‡µÅ‡¥±‡µç‡¥±‡¥ø‡¥ö‡µç‡¥ö‡µÜ‡¥ü‡¥ø. ‡¥§‡¥£‡µÅ‡¥§‡µç‡¥§‡¥§‡µÅ‡¥Ç ‡¥Æ‡µÇ‡¥ü‡¥ø‡¥ï‡µç‡¥ï‡µÜ‡¥ü‡µç‡¥ü‡¥ø‡¥Ø‡¥§‡µÅ‡¥Æ‡¥æ‡¥Ø ‡¥ï‡¥æ‡¥≤‡¥æ‡¥µ‡¥∏‡µç‡¥• ‡¥á‡¥∑‡µç‡¥ü‡¥™‡µç‡¥™‡µÜ‡¥ü‡µÅ‡¥®‡µç‡¥®‡µÅ‡•§",
            "hi": "‡§ö‡§æ‡§Ø ‡§¨‡§æ‡§∞‡§π‡§Æ‡§æ‡§∏‡•Ä ‡§∏‡§¶‡§æ‡§¨‡§π‡§æ‡§∞ ‡§ù‡§æ‡§°‡§º‡•Ä ‡§π‡•à‡•§ ‡§†‡§Ç‡§°‡•Ä, ‡§ß‡•Å‡§Ç‡§ß‡§≤‡•Ä ‡§ú‡§≤‡§µ‡§æ‡§Ø‡•Å ‡§™‡§∏‡§Ç‡§¶ ‡§ï‡§∞‡§§‡•Ä ‡§π‡•à‡•§"
        }
    },
    "soil": {
        "clay": {
            "en": "Clay soil retains water well but drains slowly. Good for rice cultivation. Add organic matter to improve drainage. Test pH regularly. Suitable for crops that need consistent moisture.",
            "ta": "‡Æï‡Æ≥‡Æø‡ÆÆ‡Æ£‡Øç ‡ÆÆ‡Æ£‡Øç ‡Æ®‡ØÄ‡Æ∞‡Øà ‡Æ®‡Æ©‡Øç‡Æ±‡Ææ‡Æï ‡Æ§‡Æï‡Øç‡Æï‡Æµ‡Øà‡Æï‡Øç‡Æï‡Æø‡Æ±‡Æ§‡ØÅ ‡ÆÜ‡Æ©‡Ææ‡Æ≤‡Øç ‡ÆÆ‡ØÜ‡Æ§‡ØÅ‡Æµ‡Ææ‡Æï ‡Æµ‡Æü‡Æø‡Æï‡Æø‡Æ±‡Æ§‡ØÅ. ‡Æ®‡ØÜ‡Æ≤‡Øç ‡Æö‡Ææ‡Æï‡ØÅ‡Æ™‡Æü‡Æø‡Æï‡Øç‡Æï‡ØÅ ‡Æ®‡Æ≤‡Øç‡Æ≤‡Æ§‡ØÅ. ‡Æµ‡Æü‡Æø‡Æï‡Ææ‡Æ≤‡Øç ‡ÆÆ‡Øá‡ÆÆ‡Øç‡Æ™‡Æü‡ØÅ‡Æ§‡Øç‡Æ§ ‡Æï‡Æ∞‡Æø‡ÆÆ ‡Æ™‡Øä‡Æ∞‡ØÅ‡Æü‡Øç‡Æï‡Æ≥‡Øà ‡Æö‡Øá‡Æ∞‡Øç‡Æï‡Øç‡Æï‡Æµ‡ØÅ‡ÆÆ‡Øç.",
            "te": "‡∞Æ‡∞ü‡±ç‡∞ü‡∞ø ‡∞Æ‡∞Ç‡∞ö‡∞ø‡∞ó‡∞æ ‡∞®‡±Ä‡∞∞‡±Å ‡∞®‡∞ø‡∞≤‡±Å‡∞™‡±Å‡∞ï‡±Å‡∞Ç‡∞ü‡±Å‡∞Ç‡∞¶‡∞ø ‡∞ï‡∞æ‡∞®‡±Ä ‡∞®‡±Ü‡∞Æ‡±ç‡∞Æ‡∞¶‡∞ø‡∞ó‡∞æ ‡∞™‡∞æ‡∞∞‡∞ø‡∞™‡±ã‡∞§‡±Å‡∞Ç‡∞¶‡∞ø. ‡∞µ‡∞∞‡∞ø ‡∞∏‡∞æ‡∞ó‡±Å‡∞ï‡±Å ‡∞Æ‡∞Ç‡∞ö‡∞ø‡∞¶‡∞ø. ‡∞®‡±Ä‡∞ü‡∞ø ‡∞µ‡∞°‡∞™‡±ã‡∞§‡∞®‡±Å ‡∞Æ‡±Ü‡∞∞‡±Å‡∞ó‡±Å‡∞™‡∞∞‡∞ö‡∞°‡∞æ‡∞®‡∞ø‡∞ï‡∞ø ‡∞∏‡±á‡∞Ç‡∞¶‡±ç‡∞∞‡±Ä‡∞Ø ‡∞™‡∞¶‡∞æ‡∞∞‡±ç‡∞•‡∞æ‡∞≤‡∞®‡±Å ‡∞ï‡∞≤‡∞™‡∞Ç‡∞°‡∞ø.",
            "ml": "‡¥ï‡¥≥‡¥ø‡¥Æ‡¥£‡µç‡¥£‡µç ‡¥µ‡µÜ‡¥≥‡µç‡¥≥‡¥Ç ‡¥®‡¥®‡µç‡¥®‡¥æ‡¥Ø‡¥ø ‡¥®‡¥ø‡¥≤‡¥®‡¥ø‡µº‡¥§‡µç‡¥§‡µÅ‡¥®‡µç‡¥®‡µÅ ‡¥™‡¥ï‡µç‡¥∑‡µá ‡¥™‡¥§‡µÅ‡¥ï‡µç‡¥ï‡µÜ ‡¥í‡¥¥‡µÅ‡¥ï‡µÅ‡¥®‡µç‡¥®‡µÅ. ‡¥®‡µÜ‡¥≤‡µç‡¥≤‡µÅ‡¥ï‡µÉ‡¥∑‡¥ø‡¥ï‡µç‡¥ï‡µç ‡¥®‡¥≤‡µç‡¥≤‡¥§‡µç. ‡¥°‡µç‡¥∞‡µÜ‡¥Ø‡¥ø‡¥®‡µá‡¥ú‡µç ‡¥Æ‡µÜ‡¥ö‡µç‡¥ö‡¥™‡µç‡¥™‡µÜ‡¥ü‡µÅ‡¥§‡µç‡¥§‡¥æ‡µª ‡¥ú‡µà‡¥µ‡¥µ‡¥∏‡µç‡¥§‡µÅ‡¥ï‡µç‡¥ï‡µæ ‡¥ö‡µá‡µº‡¥ï‡µç‡¥ï‡µÅ‡¥ï."
        },
        "sandy": {
            "en": "Sandy soil drains quickly but requires frequent irrigation. Good for root vegetables. Add compost to retain nutrients. Suitable for crops like carrots, potatoes, onions.",
            "ta": "‡ÆÆ‡Æ£‡Æ≤‡Øç ‡ÆÆ‡Æ£‡Øç ‡Æµ‡Æø‡Æ∞‡Øà‡Æµ‡Ææ‡Æï ‡Æµ‡Æü‡Æø‡Æï‡Æø‡Æ±‡Æ§‡ØÅ ‡ÆÜ‡Æ©‡Ææ‡Æ≤‡Øç ‡ÆÖ‡Æü‡Æø‡Æï‡Øç‡Æï‡Æü‡Æø ‡Æ®‡ØÄ‡Æ∞‡Øç‡Æ™‡Øç‡Æ™‡Ææ‡Æö‡Æ©‡ÆÆ‡Øç ‡Æ§‡Øá‡Æµ‡Øà. ‡Æµ‡Øá‡Æ∞‡Øç ‡Æï‡Ææ‡ÆØ‡Øç‡Æï‡Æ±‡Æø‡Æï‡Æ≥‡ØÅ‡Æï‡Øç‡Æï‡ØÅ ‡Æ®‡Æ≤‡Øç‡Æ≤‡Æ§‡ØÅ. ‡Æä‡Æü‡Øç‡Æü‡Æö‡Øç‡Æö‡Æ§‡Øç‡Æ§‡ØÅ‡Æï‡Øç‡Æï‡Æ≥‡Øà ‡Æ§‡Æï‡Øç‡Æï‡Æµ‡Øà‡Æï‡Øç‡Æï ‡Æï‡ÆÆ‡Øç‡Æ™‡Øã‡Æ∏‡Øç‡Æü‡Øç ‡Æö‡Øá‡Æ∞‡Øç‡Æï‡Øç‡Æï‡Æµ‡ØÅ‡ÆÆ‡Øç.",
            "te": "‡∞á‡∞∏‡±Å‡∞ï ‡∞Æ‡∞ü‡±ç‡∞ü‡∞ø ‡∞§‡±ç‡∞µ‡∞∞‡∞ó‡∞æ ‡∞™‡∞æ‡∞∞‡∞ø‡∞™‡±ã‡∞§‡±Å‡∞Ç‡∞¶‡∞ø ‡∞ï‡∞æ‡∞®‡±Ä ‡∞§‡∞∞‡∞ö‡±Å‡∞ó‡∞æ ‡∞®‡±Ä‡∞ü‡∞ø‡∞™‡∞æ‡∞∞‡±Å‡∞¶‡∞≤ ‡∞Ö‡∞µ‡∞∏‡∞∞‡∞Ç. ‡∞µ‡±á‡∞∞‡±ç ‡∞ï‡±Ç‡∞∞‡∞ó‡∞æ‡∞Ø‡∞≤‡∞ï‡±Å ‡∞Æ‡∞Ç‡∞ö‡∞ø‡∞¶‡∞ø. ‡∞™‡±ã‡∞∑‡∞ï‡∞æ‡∞≤‡∞®‡±Å ‡∞®‡∞ø‡∞≤‡±Å‡∞™‡±Å‡∞ï‡±ã‡∞µ‡∞°‡∞æ‡∞®‡∞ø‡∞ï‡∞ø ‡∞ï‡∞Ç‡∞™‡±ã‡∞∏‡±ç‡∞ü‡±ç ‡∞ö‡±á‡∞∞‡±ç‡∞ö‡∞Ç‡∞°‡∞ø.",
            "ml": "‡¥Æ‡¥£‡µΩ‡¥Æ‡¥£‡µç‡¥£‡µç ‡¥µ‡µá‡¥ó‡¥§‡µç‡¥§‡¥ø‡µΩ ‡¥í‡¥¥‡µÅ‡¥ï‡µÅ‡¥®‡µç‡¥®‡µÅ ‡¥™‡¥ï‡µç‡¥∑‡µá ‡¥á‡¥ü‡¥Ø‡µç‡¥ï‡µç‡¥ï‡¥ø‡¥ü‡µÜ ‡¥®‡¥®‡¥Ø‡µç‡¥ï‡µç‡¥ï‡µá‡¥£‡µç‡¥ü‡¥§‡µÅ‡¥£‡µç‡¥ü‡µç. ‡¥±‡µÇ‡¥ü‡µç‡¥ü‡µç ‡¥™‡¥ö‡µç‡¥ö‡¥ï‡µç‡¥ï‡¥±‡¥ø‡¥ï‡µæ‡¥ï‡µç‡¥ï‡µç ‡¥®‡¥≤‡µç‡¥≤‡¥§‡µç. ‡¥™‡µã‡¥∑‡¥ï‡¥ô‡µç‡¥ô‡µæ ‡¥®‡¥ø‡¥≤‡¥®‡¥ø‡µº‡¥§‡µç‡¥§‡¥æ‡µª ‡¥ï‡¥Æ‡µç‡¥™‡µã‡¥∏‡µç‡¥±‡µç‡¥±‡µç ‡¥ö‡µá‡µº‡¥ï‡µç‡¥ï‡µÅ‡¥ï."
        },
        "loamy": {
            "en": "Loamy soil is ideal for most crops. Perfect balance of drainage and retention. Rich in nutrients. Suitable for vegetables, fruits, grains. Maintain with organic matter.",
            "ta": "‡Æï‡Æ≥‡Æø‡¶Æ‡Æ£‡Øç ‡Æï‡Æ≤‡Æ®‡Øç‡Æ§ ‡ÆÆ‡Æ£‡Øç ‡Æ™‡ØÜ‡Æ∞‡ØÅ‡ÆÆ‡Øç‡Æ™‡Ææ‡Æ≤‡Ææ‡Æ© ‡Æ™‡ÆØ‡Æø‡Æ∞‡Øç‡Æï‡Æ≥‡ØÅ‡Æï‡Øç‡Æï‡ØÅ ‡Æè‡Æ±‡Øç‡Æ±‡Æ§‡ØÅ. ‡Æµ‡Æü‡Æø‡Æï‡Ææ‡Æ≤‡Øç ‡ÆÆ‡Æ±‡Øç‡Æ±‡ØÅ‡ÆÆ‡Øç ‡Æ§‡Æï‡Øç‡Æï‡Æµ‡Øà‡Æ™‡Øç‡Æ™‡Æø‡Æ©‡Øç ‡Æö‡Æ∞‡Æø‡ÆØ‡Ææ‡Æ© ‡Æö‡ÆÆ‡Æ®‡Æø‡Æ≤‡Øà. ‡Æä‡Æü‡Øç‡Æü‡Æö‡Øç‡Æö‡Æ§‡Øç‡Æ§‡ØÅ ‡Æ®‡Æø‡Æ±‡Øà‡Æ®‡Øç‡Æ§‡Æ§‡ØÅ.",
            "te": "‡∞≤‡±á‡∞§ ‡∞Æ‡∞ü‡±ç‡∞ü‡∞ø ‡∞ö‡∞æ‡∞≤‡∞æ ‡∞™‡∞Ç‡∞ü‡∞≤‡∞ï‡±Å ‡∞Ö‡∞®‡±Å‡∞µ‡±à‡∞®‡∞¶‡∞ø. ‡∞°‡±ç‡∞∞‡±à‡∞®‡±á‡∞ú‡±ç ‡∞Æ‡∞∞‡∞ø‡∞Ø‡±Å ‡∞∞‡∞ø‡∞ü‡±Ü‡∞®‡±ç‡∞∑‡∞®‡±ç ‡∞Ø‡±ä‡∞ï‡±ç‡∞ï ‡∞™‡∞∞‡∞ø‡∞™‡±Ç‡∞∞‡±ç‡∞£ ‡∞∏‡∞Æ‡∞§‡±Å‡∞≤‡±ç‡∞Ø‡∞§. ‡∞™‡±ã‡∞∑‡∞ï‡∞æ‡∞≤‡∞§‡±ã ‡∞∏‡∞Æ‡±É‡∞¶‡±ç‡∞ß‡∞ø‡∞ó‡∞æ ‡∞â‡∞Ç‡∞ü‡±Å‡∞Ç‡∞¶‡∞ø.",
            "ml": "‡¥™‡¥∂‡¥ø‡¥Æ‡¥Æ‡¥£‡µç‡¥£‡µç ‡¥Æ‡¥ø‡¥ï‡µç‡¥ï ‡¥µ‡¥ø‡¥≥‡¥ï‡µæ‡¥ï‡µç‡¥ï‡µÅ‡¥Ç ‡¥Ö‡¥®‡µÅ‡¥Ø‡µã‡¥ú‡µç‡¥Ø‡¥Ç. ‡¥°‡µç‡¥∞‡µÜ‡¥Ø‡¥ø‡¥®‡µá‡¥ú‡¥ø‡¥®‡µç‡¥±‡µÜ‡¥Ø‡µÅ‡¥Ç ‡¥®‡¥ø‡¥≤‡¥®‡¥ø‡µº‡¥§‡µç‡¥§‡¥≤‡¥ø‡¥®‡µç‡¥±‡µÜ‡¥Ø‡µÅ‡¥Ç ‡¥Æ‡¥ø‡¥ï‡¥ö‡µç‡¥ö ‡¥∏‡¥®‡µç‡¥§‡µÅ‡¥≤‡¥®‡¥Ç. ‡¥™‡µã‡¥∑‡¥ï‡¥ô‡µç‡¥ô‡¥≥‡¥æ‡µΩ ‡¥∏‡¥Æ‡µÉ‡¥¶‡µç‡¥ß‡¥Ç."
        }
    },
    "irrigation": {
        "drip": {
            "en": "Drip irrigation saves 30-50% water. Delivers water directly to plant roots. Reduces weed growth. Initial investment high but long-term savings. Best for row crops and orchards.",
            "ta": "‡Æö‡Øä‡Æü‡Øç‡Æü‡ØÅ ‡Æ®‡ØÄ‡Æ∞‡Øç‡Æ™‡Øç‡Æ™‡Ææ‡Æö‡Æ©‡ÆÆ‡Øç 30-50% ‡Æ®‡ØÄ‡Æ∞‡Øà ‡Æö‡Øá‡ÆÆ‡Æø‡Æï‡Øç‡Æï‡Æø‡Æ±‡Æ§‡ØÅ. ‡Æ§‡Ææ‡Æµ‡Æ∞ ‡Æµ‡Øá‡Æ∞‡Øç‡Æï‡Æ≥‡ØÅ‡Æï‡Øç‡Æï‡ØÅ ‡Æ®‡Øá‡Æ∞‡Æü‡Æø‡ÆØ‡Ææ‡Æï ‡Æ®‡ØÄ‡Æ∞‡Øç ‡Æµ‡Æ¥‡Æô‡Øç‡Æï‡ØÅ‡Æï‡Æø‡Æ±‡Æ§‡ØÅ. ‡Æï‡Æ≥‡Øà ‡Æµ‡Æ≥‡Æ∞‡Øç‡Æö‡Øç‡Æö‡Æø‡ÆØ‡Øà ‡Æï‡ØÅ‡Æ±‡Øà‡Æï‡Øç‡Æï‡Æø‡Æ±‡Æ§‡ØÅ.",
            "te": "‡∞°‡±ç‡∞∞‡∞ø‡∞™‡±ç ‡∞®‡±Ä‡∞ü‡∞ø‡∞™‡∞æ‡∞∞‡±Å‡∞¶‡∞≤ 30-50% ‡∞®‡±Ä‡∞ü‡∞ø‡∞®‡∞ø ‡∞Ü‡∞¶‡∞æ ‡∞ö‡±á‡∞∏‡±ç‡∞§‡±Å‡∞Ç‡∞¶‡∞ø. ‡∞Æ‡±ä‡∞ï‡±ç‡∞ï‡∞≤ ‡∞µ‡±á‡∞∞‡±ç‡∞≤‡∞ï‡±Å ‡∞®‡±á‡∞∞‡±Å‡∞ó‡∞æ ‡∞®‡±Ä‡∞ü‡∞ø‡∞®‡∞ø ‡∞Ö‡∞Ç‡∞¶‡∞ø‡∞∏‡±ç‡∞§‡±Å‡∞Ç‡∞¶‡∞ø. ‡∞ï‡∞≤‡±Å‡∞™‡±Å ‡∞Æ‡±ä‡∞ï‡±ç‡∞ï‡∞≤ ‡∞™‡±Ü‡∞∞‡±Å‡∞ó‡±Å‡∞¶‡∞≤‡∞®‡±Å ‡∞§‡∞ó‡±ç‡∞ó‡∞ø‡∞∏‡±ç‡∞§‡±Å‡∞Ç‡∞¶‡∞ø.",
            "ml": "‡¥°‡µç‡¥∞‡¥ø‡¥™‡µç‡¥™‡µç ‡¥ú‡¥≤‡¥∏‡µá‡¥ö‡¥®‡¥Ç 30-50% ‡¥µ‡µÜ‡¥≥‡µç‡¥≥‡¥Ç ‡¥≤‡¥æ‡¥≠‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥®‡µç‡¥®‡µÅ. ‡¥ö‡µÜ‡¥ü‡¥ø‡¥ï‡¥≥‡µÅ‡¥ü‡µÜ ‡¥µ‡µá‡¥∞‡µÅ‡¥ï‡¥≥‡¥ø‡¥≤‡µá‡¥ï‡µç‡¥ï‡µç ‡¥®‡µá‡¥∞‡¥ø‡¥ü‡µç‡¥ü‡µç ‡¥µ‡µÜ‡¥≥‡µç‡¥≥‡¥Ç ‡¥é‡¥§‡µç‡¥§‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥®‡µç‡¥®‡µÅ. ‡¥ï‡¥≥‡¥ï‡¥≥‡µÅ‡¥ü‡µÜ ‡¥µ‡¥≥‡µº‡¥ö‡µç‡¥ö ‡¥ï‡µÅ‡¥±‡¥Ø‡µç‡¥ï‡µç‡¥ï‡µÅ‡¥®‡µç‡¥®‡µÅ."
        },
        "sprinkler": {
            "en": "Sprinkler irrigation covers large areas efficiently. Good for uniform water distribution. Suitable for most field crops. Requires good water pressure. Can be automated easily.",
            "ta": "‡Æ§‡ØÜ‡Æ≥‡Æø‡Æ™‡Øç‡Æ™‡ØÅ ‡Æ®‡ØÄ‡Æ∞‡Øç‡Æ™‡Øç‡Æ™‡Ææ‡Æö‡Æ©‡ÆÆ‡Øç ‡Æ™‡ØÜ‡Æ∞‡Æø‡ÆØ ‡Æ™‡Æï‡ØÅ‡Æ§‡Æø‡Æï‡Æ≥‡Øà ‡Æ§‡Æø‡Æ±‡ÆÆ‡Øà‡ÆØ‡Ææ‡Æï ‡ÆÆ‡ØÇ‡Æü‡ØÅ‡Æï‡Æø‡Æ±‡Æ§‡ØÅ. ‡Æö‡ØÄ‡Æ∞‡Ææ‡Æ© ‡Æ®‡ØÄ‡Æ∞‡Øç ‡Æµ‡Æø‡Æ®‡Æø‡ÆØ‡Øã‡Æï‡Æ§‡Øç‡Æ§‡Æø‡Æ±‡Øç‡Æï‡ØÅ ‡Æ®‡Æ≤‡Øç‡Æ≤‡Æ§‡ØÅ. ‡Æ™‡ØÜ‡Æ∞‡ØÅ‡ÆÆ‡Øç‡Æ™‡Ææ‡Æ≤‡Ææ‡Æ© ‡Æµ‡ÆØ‡Æ≤‡Øç ‡Æ™‡ÆØ‡Æø‡Æ∞‡Øç‡Æï‡Æ≥‡ØÅ‡Æï‡Øç‡Æï‡ØÅ ‡Æè‡Æ±‡Øç‡Æ±‡Æ§‡ØÅ.",
            "te": "‡∞∏‡±ç‡∞™‡±ç‡∞∞‡∞ø‡∞Ç‡∞ï‡±ç‡∞≤‡∞∞‡±ç ‡∞®‡±Ä‡∞ü‡∞ø‡∞™‡∞æ‡∞∞‡±Å‡∞¶‡∞≤ ‡∞™‡±Ü‡∞¶‡±ç‡∞¶ ‡∞™‡±ç‡∞∞‡∞æ‡∞Ç‡∞§‡∞æ‡∞≤‡∞®‡±Å ‡∞∏‡∞Æ‡∞∞‡±ç‡∞•‡∞µ‡∞Ç‡∞§‡∞Ç‡∞ó‡∞æ ‡∞ï‡∞µ‡∞∞‡±ç ‡∞ö‡±á‡∞∏‡±ç‡∞§‡±Å‡∞Ç‡∞¶‡∞ø. ‡∞è‡∞ï‡∞∞‡±Ä‡∞§‡∞ø ‡∞®‡±Ä‡∞ü‡∞ø ‡∞™‡∞Ç‡∞™‡∞ø‡∞£‡±Ä‡∞ï‡∞ø ‡∞Æ‡∞Ç‡∞ö‡∞ø‡∞¶‡∞ø. ‡∞ö‡∞æ‡∞≤‡∞æ ‡∞µ‡∞∞‡∞≤ ‡∞™‡∞Ç‡∞ü‡∞≤‡∞ï‡±Å ‡∞Ö‡∞®‡±Å‡∞ï‡±Ç‡∞≤‡∞Ç.",
            "ml": "‡¥∏‡µç‡¥™‡µç‡¥∞‡¥ø‡¥ô‡µç‡¥ï‡µç‡¥≥‡µº ‡¥ú‡¥≤‡¥∏‡µá‡¥ö‡¥®‡¥Ç ‡¥µ‡¥≤‡¥ø‡¥Ø ‡¥™‡µç‡¥∞‡¥¶‡µá‡¥∂‡¥ô‡µç‡¥ô‡¥≥‡µÜ ‡¥ï‡¥æ‡¥∞‡µç‡¥Ø‡¥ï‡µç‡¥∑‡¥Æ‡¥Æ‡¥æ‡¥Ø‡¥ø ‡¥Æ‡µÇ‡¥ü‡µÅ‡¥®‡µç‡¥®‡µÅ. ‡¥è‡¥ï‡µÄ‡¥ï‡µÉ‡¥§ ‡¥ú‡¥≤ ‡¥µ‡¥ø‡¥§‡¥∞‡¥£‡¥§‡µç‡¥§‡¥ø‡¥®‡µç ‡¥®‡¥≤‡µç‡¥≤‡¥§‡µç. ‡¥Æ‡¥ø‡¥ï‡µç‡¥ï ‡¥µ‡¥Ø‡µΩ ‡¥µ‡¥ø‡¥≥‡¥ï‡µæ‡¥ï‡µç‡¥ï‡µÅ‡¥Ç ‡¥Ö‡¥®‡µÅ‡¥Ø‡µã‡¥ú‡µç‡¥Ø‡¥Ç."
        }
    },
    "diseases": {
        "blight": {
            "en": "Blight causes dark spots on leaves and stems. Caused by fungal infection. Remove affected parts immediately. Use copper-based fungicides. Ensure good air circulation.",
            "ta": "‡Æï‡Æ∞‡ØÅ‡ÆÆ‡Øà ‡Æ®‡Øã‡ÆØ‡Øç ‡Æá‡Æ≤‡Øà‡Æï‡Æ≥‡Øç ‡ÆÆ‡Æ±‡Øç‡Æ±‡ØÅ‡ÆÆ‡Øç ‡Æ§‡Æ£‡Øç‡Æü‡ØÅ‡Æï‡Æ≥‡Æø‡Æ≤‡Øç ‡Æï‡Æ∞‡ØÅ‡ÆÆ‡Øà‡ÆØ‡Ææ‡Æ© ‡Æ™‡ØÅ‡Æ≥‡Øç‡Æ≥‡Æø‡Æï‡Æ≥‡Øà ‡Æè‡Æ±‡Øç‡Æ™‡Æü‡ØÅ‡Æ§‡Øç‡Æ§‡ØÅ‡Æï‡Æø‡Æ±‡Æ§‡ØÅ. ‡Æ™‡ØÇ‡Æû‡Øç‡Æö‡Øà ‡Æ§‡Øä‡Æ±‡Øç‡Æ±‡Ææ‡Æ≤‡Øç ‡Æè‡Æ±‡Øç‡Æ™‡Æü‡ØÅ‡Æï‡Æø‡Æ±‡Æ§‡ØÅ. ‡Æ™‡Ææ‡Æ§‡Æø‡Æï‡Øç‡Æï‡Æ™‡Øç‡Æ™‡Æü‡Øç‡Æü ‡Æ™‡Æï‡ØÅ‡Æ§‡Æø‡Æï‡Æ≥‡Øà ‡Æâ‡Æü‡Æ©‡Øá ‡ÆÖ‡Æï‡Æ±‡Øç‡Æ±‡Æµ‡ØÅ‡ÆÆ‡Øç.",
            "te": "‡∞¨‡±ç‡∞≤‡±à‡∞ü‡±ç ‡∞Ü‡∞ï‡±Å‡∞≤‡±Å ‡∞Æ‡∞∞‡∞ø‡∞Ø‡±Å ‡∞ï‡∞æ‡∞Ç‡∞°‡∞æ‡∞≤‡∞™‡±à ‡∞Æ‡±Å‡∞¶‡±Å‡∞∞‡±Å ‡∞Æ‡∞ö‡±ç‡∞ö‡∞≤‡∞®‡±Å ‡∞ï‡∞≤‡∞ø‡∞ó‡∞ø‡∞∏‡±ç‡∞§‡±Å‡∞Ç‡∞¶‡∞ø. ‡∞´‡∞Ç‡∞ó‡∞≤‡±ç ‡∞á‡∞®‡±ç‡∞´‡±Ü‡∞ï‡±ç‡∞∑‡∞®‡±ç ‡∞µ‡∞≤‡±ç‡∞≤ ‡∞ï‡∞≤‡±Å‡∞ó‡±Å‡∞§‡±Å‡∞Ç‡∞¶‡∞ø. ‡∞™‡±ç‡∞∞‡∞≠‡∞æ‡∞µ‡∞ø‡∞§ ‡∞≠‡∞æ‡∞ó‡∞æ‡∞≤‡∞®‡±Å ‡∞µ‡±Ü‡∞Ç‡∞ü‡∞®‡±á ‡∞§‡±ä‡∞≤‡∞ó‡∞ø‡∞Ç‡∞ö‡∞Ç‡∞°‡∞ø.",
            "ml": "‡¥¨‡µç‡¥≤‡µà‡¥±‡µç‡¥±‡µç ‡¥á‡¥≤‡¥ï‡¥≥‡¥ø‡¥≤‡µÅ‡¥Ç ‡¥§‡¥£‡µç‡¥ü‡µÅ‡¥ï‡¥≥‡¥ø‡¥≤‡µÅ‡¥Ç ‡¥á‡¥∞‡µÅ‡¥£‡µç‡¥ü ‡¥™‡¥æ‡¥ü‡µÅ‡¥ï‡µæ ‡¥â‡¥£‡µç‡¥ü‡¥æ‡¥ï‡µç‡¥ï‡µÅ‡¥®‡µç‡¥®‡µÅ. ‡¥´‡¥Ç‡¥ó‡µΩ ‡¥Ö‡¥£‡µÅ‡¥¨‡¥æ‡¥ß ‡¥Æ‡µÇ‡¥≤‡¥Æ‡¥æ‡¥£‡µç ‡¥á‡¥§‡µç ‡¥∏‡¥Ç‡¥≠‡¥µ‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥®‡µç‡¥®‡¥§‡µç. ‡¥¨‡¥æ‡¥ß‡¥ø‡¥§ ‡¥≠‡¥æ‡¥ó‡¥ô‡µç‡¥ô‡µæ ‡¥â‡¥ü‡¥®‡µÜ ‡¥®‡µÄ‡¥ï‡µç‡¥ï‡¥Ç ‡¥ö‡µÜ‡¥Ø‡µç‡¥Ø‡µÅ‡¥ï."
        }
    }
}

# Load Knowledge Base (external JSON if present; fallback to built-in)
DATA_PATH = Path(__file__).parent / "data" / "agri_kb.json"

def load_kb() -> Dict[str, Dict]:
    if DATA_PATH.exists():
        try:
            with open(DATA_PATH, "r", encoding="utf-8") as f:
                kb = json.load(f)
            logger.info(f"üìö Loaded external KB: {DATA_PATH}")
            return kb
        except Exception as e:
            logger.warning(f"Could not load external KB ({e}), using built-in fallback.")
    return FALLBACK_KB

AGRICULTURE_KB = load_kb()

# Multilingual, character n-gram based RAG index with crop/soil boosting
kb_index: Dict[str, Dict] = {}

def build_lang_index(lang: str):
    texts: List[str] = []
    keys: List[Tuple[str, str]] = []

    for category, items in AGRICULTURE_KB.items():
        for item, langs in items.items():
            content = (langs.get(lang) or langs.get('en') or '').strip()
            if content:
                texts.append(content)
                keys.append((category, item))

    if not texts:
        # fallback to English entries if none for the language
        for category, items in AGRICULTURE_KB.items():
            for item, langs in items.items():
                content = (langs.get('en') or '').strip()
                if content:
                    texts.append(content)
                    keys.append((category, item))

    vect = TfidfVectorizer(
        analyzer='char_wb',
        ngram_range=(3, 5),
        min_df=1,
        max_features=5000
    )
    mat = vect.fit_transform(texts)

    kb_index[lang] = {
        'vectorizer': vect,
        'vectors': mat,
        'keys': keys,
        'texts': texts
    }
    logger.info(f"‚úÖ RAG index built for '{lang}' with {len(texts)} entries")

def ensure_lang_index(lang: str):
    if lang not in kb_index:
        build_lang_index(lang)

def detect_explicit_crop(query: str, language: str) -> str:
    """Detect crop mentions in multiple languages"""
    crop_synonyms = {
        'en': {
            # Cereals
            'rice': 'rice', 'paddy': 'rice', 'wheat': 'wheat', 'corn': 'corn', 'maize': 'corn',
            'barley': 'barley', 'oats': 'oats', 'millet': 'millet', 'quinoa': 'quinoa',
            # Legumes
            'soybeans': 'soybeans', 'soy': 'soybeans', 'chickpeas': 'chickpeas', 'lentils': 'lentils',
            'beans': 'beans', 'peas': 'peas', 'groundnut': 'groundnut', 'peanut': 'groundnut',
            # Vegetables
            'tomato': 'tomatoes', 'tomatoes': 'tomatoes', 'potato': 'potatoes', 'potatoes': 'potatoes',
            'onion': 'onions', 'onions': 'onions', 'carrot': 'carrots', 'carrots': 'carrots',
            'cabbage': 'cabbage', 'lettuce': 'lettuce', 'spinach': 'spinach', 'broccoli': 'broccoli',
            # Fruits
            'apple': 'apples', 'apples': 'apples', 'orange': 'oranges', 'oranges': 'oranges',
            'banana': 'bananas', 'bananas': 'bananas', 'grape': 'grapes', 'grapes': 'grapes',
            'mango': 'mango', 'papaya': 'papaya', 'pineapple': 'pineapple',
            # Cash crops
            'cotton': 'cotton', 'sugarcane': 'sugarcane', 'coffee': 'coffee', 'tea': 'tea',
            'tobacco': 'tobacco', 'rubber': 'rubber'
        },
        'ta': {
            # Tamil crop names
            '‡ÆÖ‡Æ∞‡Æø‡Æö‡Æø': 'rice', '‡Æ®‡ØÜ‡Æ≤‡Øç': 'rice', '‡Æï‡Øã‡Æ§‡ØÅ‡ÆÆ‡Øà': 'wheat', '‡Æö‡Øã‡Æ≥‡ÆÆ‡Øç': 'corn',
            '‡Æï‡Øá‡Æ¥‡Øç‡Æµ‡Æ∞‡Æï‡ØÅ': 'millet', '‡Æ™‡Ææ‡Æ∞‡Øç‡Æ≤‡Æø': 'barley', '‡Æµ‡ØÜ‡Æ£‡Øç‡Æ£‡Øà‡ÆØ‡Æü‡ØÅ‡Æô‡Øç': 'barley',
            '‡Æö‡Øã‡ÆØ‡Ææ‡Æ™‡ØÄ‡Æ©‡Øç': 'soybeans', '‡Æï‡Øä‡Æ£‡Øç‡Æü‡Øà‡Æï‡Øç‡Æï‡Æü‡Æ≤‡Øà': 'chickpeas', '‡Æ™‡Æ∞‡ØÅ‡Æ™‡Øç‡Æ™‡ØÅ': 'lentils',
            '‡Æ§‡Æï‡Øç‡Æï‡Ææ‡Æ≥‡Æø': 'tomatoes', '‡Æâ‡Æ∞‡ØÅ‡Æ≥‡Øà‡Æï‡Øç‡Æï‡Æø‡Æ¥‡Æô‡Øç‡Æï‡ØÅ': 'potatoes', '‡Æµ‡ØÜ‡Æô‡Øç‡Æï‡Ææ‡ÆØ‡ÆÆ‡Øç': 'onions',
            '‡Æï‡Øá‡Æ∞‡Æü‡Øç': 'carrots', '‡ÆÆ‡ØÅ‡Æü‡Øç‡Æü‡Øà‡Æï‡Øç‡Æï‡Øã‡Æ∏‡Øç': 'cabbage', '‡Æï‡ØÄ‡Æ∞‡Øà': 'spinach',
            '‡ÆÜ‡Æ™‡Øç‡Æ™‡Æø‡Æ≥‡Øç': 'apples', '‡ÆÜ‡Æ∞‡Æû‡Øç‡Æö‡ØÅ': 'oranges', '‡Æµ‡Ææ‡Æ¥‡Øà‡Æ™‡Øç‡Æ™‡Æ¥‡ÆÆ‡Øç': 'bananas',
            '‡Æ§‡Æø‡Æ∞‡Ææ‡Æü‡Øç‡Æö‡Øà': 'grapes', '‡ÆÆ‡Ææ‡ÆÆ‡Øç‡Æ™‡Æ¥‡ÆÆ‡Øç': 'mango', '‡Æ™‡Æ™‡Øç‡Æ™‡Ææ‡Æ≥‡Æø': 'papaya',
            '‡Æ™‡Æ∞‡ØÅ‡Æ§‡Øç‡Æ§‡Æø': 'cotton', '‡Æï‡Æ∞‡ØÅ‡ÆÆ‡Øç‡Æ™‡ØÅ': 'sugarcane', '‡Æï‡Ææ‡Æ™‡Æø': 'coffee', '‡Æ§‡Øá‡ÆØ‡Æø‡Æ≤‡Øà': 'tea'
        },
        'te': {
            # Telugu crop names
            '‡∞µ‡∞∞‡∞ø': 'rice', '‡∞¨‡∞ø‡∞Ø‡±ç‡∞Ø‡∞Ç': 'rice', '‡∞ó‡±ã‡∞ß‡±Å‡∞Æ': 'wheat', '‡∞Æ‡±ä‡∞ï‡±ç‡∞ï‡∞ú‡±ä‡∞®‡±ç‡∞®': 'corn',
            '‡∞ú‡±ä‡∞®‡±ç‡∞®': 'millet', '‡∞¨‡∞æ‡∞∞‡±ç‡∞≤‡±Ä': 'barley', '‡∞µ‡±ã‡∞ü‡±ç‡∞∏‡±ç': 'oats',
            '‡∞∏‡±ã‡∞Ø‡∞æ‡∞¨‡±Ä‡∞®‡±ç‡∞∏‡±ç': 'soybeans', '‡∞∂‡∞®‡∞ó‡∞≤‡±Å': 'chickpeas', '‡∞Æ‡∞∏‡±Ç‡∞∞‡±ç': 'lentils',
            '‡∞ü‡∞Æ‡±ã‡∞ü‡∞æ': 'tomatoes', '‡∞¨‡∞Ç‡∞ó‡∞æ‡∞≥‡∞æ‡∞¶‡±Å‡∞Ç‡∞™': 'potatoes', '‡∞â‡∞≤‡±ç‡∞≤‡∞ø‡∞™‡∞æ‡∞Ø‡∞≤‡±Å': 'onions',
            '‡∞ï‡±ç‡∞Ø‡∞æ‡∞∞‡±Ü‡∞ü‡±ç': 'carrots', '‡∞ï‡∞æ‡∞¨‡±á‡∞ú‡±Ä': 'cabbage', '‡∞™‡∞æ‡∞≤‡∞ï‡±Ç‡∞∞': 'spinach',
            '‡∞Ü‡∞™‡∞ø‡∞≤‡±ç‡∞∏‡±ç': 'apples', '‡∞®‡∞æ‡∞∞‡∞ø‡∞Ç‡∞ú‡∞≤‡±Å': 'oranges', '‡∞Ö‡∞∞‡∞ü‡∞ø‡∞™‡∞Ç‡∞°‡±ç‡∞≤‡±Å': 'bananas',
            '‡∞¶‡±ç‡∞∞‡∞æ‡∞ï‡±ç‡∞∑‡∞≤‡±Å': 'grapes', '‡∞Æ‡∞æ‡∞Æ‡∞ø‡∞°‡∞ø‡∞™‡∞Ç‡∞°‡±Å': 'mango', '‡∞¨‡±ä‡∞™‡±ç‡∞™‡∞æ‡∞Ø‡∞ø': 'papaya',
            '‡∞™‡∞§‡±ç‡∞§‡∞ø': 'cotton', '‡∞ö‡±Ü‡∞∞‡∞ï‡±Å': 'sugarcane', '‡∞ï‡∞æ‡∞´‡±Ä': 'coffee', '‡∞§‡±á‡∞®‡±Ä‡∞∞‡±Å': 'tea'
        },
        'ml': {
            # Malayalam crop names
            '‡¥Ö‡¥∞‡¥ø': 'rice', '‡¥®‡µÜ‡µΩ': 'rice', '‡¥ó‡µã‡¥§‡¥Æ‡µç‡¥™‡µç': 'wheat', '‡¥ö‡µã‡¥≥‡¥Ç': 'corn',
            '‡¥ï‡µá‡¥¥‡µç‡¥µ‡¥∞‡¥ï‡µÅ': 'millet', '‡¥¨‡¥æ‡µº‡¥≤‡¥ø': 'barley', '‡¥ì‡¥ü‡µç‡¥∏‡µç': 'oats',
            '‡¥∏‡µã‡¥Ø‡¥æ‡¥¨‡µÄ‡µª': 'soybeans', '‡¥ö‡µÜ‡¥±‡µÅ‡¥™‡¥Ø‡µº': 'chickpeas', '‡¥™‡¥Ø‡µº': 'lentils',
            '‡¥§‡¥ï‡µç‡¥ï‡¥æ‡¥≥‡¥ø': 'tomatoes', '‡¥â‡¥∞‡µÅ‡¥≥‡¥ï‡µç‡¥ï‡¥ø‡¥¥‡¥ô‡µç‡¥ô‡µç': 'potatoes', '‡¥â‡¥≥‡µç‡¥≥‡¥ø': 'onions',
            '‡¥ï‡¥æ‡¥∞‡¥±‡µç‡¥±‡µç': 'carrots', '‡¥ï‡¥æ‡¥¨‡µá‡¥ú‡µç': 'cabbage', '‡¥ö‡µÄ‡¥∞': 'spinach',
            '‡¥Ü‡¥™‡µç‡¥™‡¥ø‡µæ': 'apples', '‡¥ì‡¥±‡¥û‡µç‡¥ö‡µç': 'oranges', '‡¥µ‡¥æ‡¥¥‡¥™‡µç‡¥™‡¥¥‡¥Ç': 'bananas',
            '‡¥Æ‡µÅ‡¥®‡µç‡¥§‡¥ø‡¥∞‡¥ø': 'grapes', '‡¥Æ‡¥æ‡¥Æ‡µç‡¥™‡¥¥‡¥Ç': 'mango', '‡¥™‡¥™‡µç‡¥™‡¥æ‡¥Ø': 'papaya',
            '‡¥™‡¥∞‡µÅ‡¥§‡µç‡¥§‡¥ø': 'cotton', '‡¥ï‡¥∞‡¥ø‡¥Æ‡µç‡¥™‡µç': 'sugarcane', '‡¥ï‡¥æ‡¥™‡µç‡¥™‡¥ø': 'coffee', '‡¥ö‡¥æ‡¥Ø': 'tea'
        },
        'hi': {
            # Hindi crop names
            '‡§ö‡§æ‡§µ‡§≤': 'rice', '‡§ß‡§æ‡§®': 'rice', '‡§ó‡•á‡§π‡•Ç‡§Ç': 'wheat', '‡§Æ‡§ï‡•ç‡§ï‡§æ': 'corn',
            '‡§¨‡§æ‡§ú‡§∞‡§æ': 'millet', '‡§ú‡•å': 'barley', '‡§ú‡§à': 'oats',
            '‡§∏‡•ã‡§Ø‡§æ‡§¨‡•Ä‡§®': 'soybeans', '‡§ö‡§®‡§æ': 'chickpeas', '‡§Æ‡§∏‡•Ç‡§∞': 'lentils',
            '‡§ü‡§Æ‡§æ‡§ü‡§∞': 'tomatoes', '‡§Ü‡§≤‡•Ç': 'potatoes', '‡§™‡•ç‡§Ø‡§æ‡§ú': 'onions',
            '‡§ó‡§æ‡§ú‡§∞': 'carrots', '‡§™‡§§‡•ç‡§§‡§æ‡§ó‡•ã‡§≠‡•Ä': 'cabbage', '‡§™‡§æ‡§≤‡§ï': 'spinach',
            '‡§∏‡•á‡§¨': 'apples', '‡§∏‡§Ç‡§§‡§∞‡§æ': 'oranges', '‡§ï‡•á‡§≤‡§æ': 'bananas',
            '‡§Ö‡§Ç‡§ó‡•Ç‡§∞': 'grapes', '‡§Ü‡§Æ': 'mango', '‡§™‡§™‡•Ä‡§§‡§æ': 'papaya',
            '‡§ï‡§™‡§æ‡§∏': 'cotton', '‡§ó‡§®‡•ç‡§®‡§æ': 'sugarcane', '‡§ï‡•â‡§´‡•Ä': 'coffee', '‡§ö‡§æ‡§Ø': 'tea'
        }
    }
    
    mapping = crop_synonyms.get(language, crop_synonyms['en'])
    query_lower = query.lower()
    
    for crop_name, standardized_name in mapping.items():
        if crop_name.lower() in query_lower:
            return standardized_name
    
    return ""

def is_agriculture_related(query: str, language: str) -> bool:
    """Check if query is agriculture-related and reject non-agricultural queries"""
    agriculture_keywords = {
        'en': [
            'crop', 'farming', 'agriculture', 'plant', 'soil', 'fertilizer', 'pest', 'disease',
            'irrigation', 'harvest', 'seed', 'growth', 'cultivation', 'farm', 'field',
            'pesticide', 'herbicide', 'organic', 'yield', 'planting', 'sowing', 'tractor',
            'compost', 'manure', 'greenhouse', 'nursery', 'pruning', 'grafting', 'weather',
            'climate', 'rain', 'drought', 'water', 'nitrogen', 'phosphorus', 'potassium',
            'ph', 'acidity', 'alkaline', 'mulch', 'weeds', 'insects', 'fungus', 'bacteria',
            'rice', 'wheat', 'corn', 'barley', 'oats', 'tomato', 'potato', 'onion', 'carrot',
            'apple', 'orange', 'banana', 'grape', 'cotton', 'sugarcane', 'coffee', 'tea',
            'beans', 'peas', 'lentil', 'soybean', 'cabbage', 'lettuce', 'spinach', 'mango'
        ],
        'ta': [
            '‡Æ™‡ÆØ‡Æø‡Æ∞‡Øç', '‡Æµ‡Æø‡Æµ‡Æö‡Ææ‡ÆØ‡ÆÆ‡Øç', '‡Æµ‡Øá‡Æ≥‡Ææ‡Æ£‡Øç‡ÆÆ‡Øà', '‡Æ§‡Ææ‡Æµ‡Æ∞‡ÆÆ‡Øç', '‡ÆÆ‡Æ£‡Øç', '‡Æâ‡Æ∞‡ÆÆ‡Øç', '‡Æ™‡ØÇ‡Æö‡Øç‡Æö‡Æø', '‡Æ®‡Øã‡ÆØ‡Øç',
            '‡Æ®‡ØÄ‡Æ∞‡Øç‡Æ™‡Øç‡Æ™‡Ææ‡Æö‡Æ©‡ÆÆ‡Øç', '‡ÆÖ‡Æ±‡ØÅ‡Æµ‡Æü‡Øà', '‡Æµ‡Æø‡Æ§‡Øà', '‡Æµ‡Æ≥‡Æ∞‡Øç‡Æö‡Øç‡Æö‡Æø', '‡Æö‡Ææ‡Æï‡ØÅ‡Æ™‡Æü‡Æø', '‡Æµ‡ÆØ‡Æ≤‡Øç', '‡ÆÖ‡Æ∞‡Æø‡Æö‡Æø', '‡Æ®‡ØÜ‡Æ≤‡Øç',
            '‡Æï‡Øã‡Æ§‡ØÅ‡ÆÆ‡Øà', '‡Æ§‡Æï‡Øç‡Æï‡Ææ‡Æ≥‡Æø', '‡Æâ‡Æ∞‡ØÅ‡Æ≥‡Øà‡Æï‡Øç‡Æï‡Æø‡Æ¥‡Æô‡Øç‡Æï‡ØÅ', '‡Æµ‡ØÜ‡Æô‡Øç‡Æï‡Ææ‡ÆØ‡ÆÆ‡Øç', '‡Æï‡Øá‡Æ∞‡Æü‡Øç', '‡ÆÜ‡Æ™‡Øç‡Æ™‡Æø‡Æ≥‡Øç', '‡Æ™‡Æ∞‡ØÅ‡Æ§‡Øç‡Æ§‡Æø',
            '‡Æ™‡ØÇ‡Æö‡Øç‡Æö‡Æø‡Æï‡Øç‡Æï‡Øä‡Æ≤‡Øç‡Æ≤‡Æø', '‡Æï‡Æ≥‡Øà‡Æï‡Øç‡Æï‡Øä‡Æ≤‡Øç‡Æ≤‡Æø', '‡Æï‡Æ∞‡Æø‡ÆÆ', '‡Æµ‡Æø‡Æ≥‡Øà‡Æö‡Øç‡Æö‡Æ≤‡Øç', '‡Æ®‡Æü‡Æµ‡ØÅ', '‡Æï‡Æ∞‡ØÅ‡ÆÆ‡Øç‡Æ™‡ØÅ', '‡Æï‡Ææ‡Æ™‡Æø'
        ],
        'te': [
            '‡∞™‡∞Ç‡∞ü', '‡∞µ‡±ç‡∞Ø‡∞µ‡∞∏‡∞æ‡∞Ø‡∞Ç', '‡∞µ‡±á‡∞∑‡∞ß‡∞æ‡∞∞‡∞£', '‡∞Æ‡±ä‡∞ï‡±ç‡∞ï', '‡∞Æ‡∞ü‡±ç‡∞ü‡∞ø', '‡∞é‡∞∞‡±Å‡∞µ‡±Å‡∞≤‡±Å', '‡∞ï‡±Ä‡∞ü‡∞ï‡∞æ‡∞≤‡±Å', '‡∞µ‡±ç‡∞Ø‡∞æ‡∞ß‡∞ø',
            '‡∞®‡±Ä‡∞ü‡∞ø‡∞™‡∞æ‡∞∞‡±Å‡∞¶‡∞≤', '‡∞ï‡±ã‡∞§', '‡∞µ‡∞ø‡∞§‡±ç‡∞§‡∞®‡∞Ç', '‡∞™‡±Ü‡∞∞‡±Å‡∞ó‡±Å‡∞¶‡∞≤', '‡∞∏‡∞æ‡∞ó‡±Å', '‡∞™‡±ä‡∞≤‡∞Ç', '‡∞µ‡∞∞‡∞ø', '‡∞ó‡±ã‡∞ß‡±Å‡∞Æ',
            '‡∞ü‡∞Æ‡±ã‡∞ü‡∞æ', '‡∞¨‡∞Ç‡∞ó‡∞æ‡∞≥‡∞æ‡∞¶‡±Å‡∞Ç‡∞™', '‡∞â‡∞≤‡±ç‡∞≤‡∞ø‡∞™‡∞æ‡∞Ø‡∞≤‡±Å', '‡∞ï‡±ç‡∞Ø‡∞æ‡∞∞‡±Ü‡∞ü‡±ç', '‡∞Ü‡∞™‡∞ø‡∞≤‡±ç‡∞∏‡±ç', '‡∞™‡∞§‡±ç‡∞§‡∞ø', '‡∞ö‡±Ü‡∞∞‡∞ï‡±Å'
        ],
        'ml': [
            '‡¥µ‡¥ø‡¥≥', '‡¥ï‡µÉ‡¥∑‡¥ø', '‡¥ï‡¥æ‡µº‡¥∑‡¥ø‡¥ï‡¥Ç', '‡¥ö‡µÜ‡¥ü‡¥ø', '‡¥Æ‡¥£‡µç‡¥£‡µç', '‡¥µ‡¥≥‡¥Ç', '‡¥ï‡µÄ‡¥ü‡¥Ç', '‡¥∞‡µã‡¥ó‡¥Ç',
            '‡¥ú‡¥≤‡¥∏‡µá‡¥ö‡¥®‡¥Ç', '‡¥µ‡¥ø‡¥≥‡¥µ‡µÜ‡¥ü‡µÅ‡¥™‡µç‡¥™‡µç', '‡¥µ‡¥ø‡¥§‡µç‡¥§‡µç', '‡¥µ‡¥≥‡µº‡¥ö‡µç‡¥ö', '‡¥ï‡µÉ‡¥∑‡¥ø', '‡¥µ‡¥Ø‡µΩ', '‡¥Ö‡¥∞‡¥ø', '‡¥ó‡µã‡¥§‡¥Æ‡µç‡¥™‡µç',
            '‡¥§‡¥ï‡µç‡¥ï‡¥æ‡¥≥‡¥ø', '‡¥â‡¥∞‡µÅ‡¥≥‡¥ï‡µç‡¥ï‡¥ø‡¥¥‡¥ô‡µç‡¥ô‡µç', '‡¥â‡¥≥‡µç‡¥≥‡¥ø', '‡¥ï‡¥æ‡¥∞‡¥±‡µç‡¥±‡µç', '‡¥Ü‡¥™‡µç‡¥™‡¥ø‡µæ', '‡¥™‡¥∞‡µÅ‡¥§‡µç‡¥§‡¥ø', '‡¥ï‡¥∞‡¥ø‡¥Æ‡µç‡¥™‡µç'
        ],
        'hi': [
            '‡§´‡§∏‡§≤', '‡§ñ‡•á‡§§‡•Ä', '‡§ï‡•É‡§∑‡§ø', '‡§™‡•å‡§ß‡§æ', '‡§Æ‡§ø‡§ü‡•ç‡§ü‡•Ä', '‡§ñ‡§æ‡§¶', '‡§ï‡•Ä‡§ü', '‡§¨‡•Ä‡§Æ‡§æ‡§∞‡•Ä',
            '‡§∏‡§ø‡§Ç‡§ö‡§æ‡§à', '‡§ï‡§ü‡§æ‡§à', '‡§¨‡•Ä‡§ú', '‡§µ‡•É‡§¶‡•ç‡§ß‡§ø', '‡§ñ‡•á‡§§‡•Ä', '‡§ñ‡•á‡§§', '‡§ö‡§æ‡§µ‡§≤', '‡§ó‡•á‡§π‡•Ç‡§Ç',
            '‡§ü‡§Æ‡§æ‡§ü‡§∞', '‡§Ü‡§≤‡•Ç', '‡§™‡•ç‡§Ø‡§æ‡§ú', '‡§ó‡§æ‡§ú‡§∞', '‡§∏‡•á‡§¨', '‡§ï‡§™‡§æ‡§∏', '‡§ó‡§®‡•ç‡§®‡§æ'
        ]
    }
    
    # First check for crop names (most important)
    crop_detected = detect_explicit_crop(query, language)
    if crop_detected:
        return True
    
    # Get keywords for the language
    keywords = agriculture_keywords.get(language, agriculture_keywords['en'])
    query_lower = query.lower()
    
    # Check if any agriculture keyword is present
    for keyword in keywords:
        if keyword.lower() in query_lower:
            return True
    
    # Additional check for common agriculture phrases
    agri_phrases = {
        'en': ['grow', 'plant', 'farm', 'soil', 'water', 'sun', 'season', 'harvest', 'food production', 'agricultural'],
        'ta': ['‡Æµ‡Æ≥‡Æ∞‡Øç', '‡Æ®‡Æü', '‡Æ™‡ÆØ‡Æø‡Æ∞‡Øç', '‡Æâ‡Æ£‡Æµ‡ØÅ', '‡ÆÆ‡Æ¥‡Øà', '‡Æï‡Ææ‡Æ≤‡Æ®‡Æø‡Æ≤‡Øà'],
        'te': ['‡∞™‡±Ü‡∞∞‡±Å‡∞ó‡±Å', '‡∞®‡∞æ‡∞ü', '‡∞™‡∞Ç‡∞ü', '‡∞Ü‡∞π‡∞æ‡∞∞‡∞Ç', '‡∞µ‡∞∞‡±ç‡∞∑‡∞Ç', '‡∞µ‡∞æ‡∞§‡∞æ‡∞µ‡∞∞‡∞£‡∞Ç'],
        'ml': ['‡¥µ‡¥≥‡µº', '‡¥®‡¥ü', '‡¥µ‡¥ø‡¥≥', '‡¥≠‡¥ï‡µç‡¥∑‡¥£‡¥Ç', '‡¥Æ‡¥¥', '‡¥ï‡¥æ‡¥≤‡¥æ‡¥µ‡¥∏‡µç‡¥•'],
        'hi': ['‡§â‡§ó', '‡§≤‡§ó‡§æ', '‡§´‡§∏‡§≤', '‡§≠‡•ã‡§ú‡§®', '‡§¨‡§æ‡§∞‡§ø‡§∂', '‡§Æ‡•å‡§∏‡§Æ']
    }
    
    phrases = agri_phrases.get(language, agri_phrases['en'])
    for phrase in phrases:
        if phrase.lower() in query_lower:
            return True
    
    # If nothing matches, it's probably not agriculture-related
    return False

class QueryRequest(BaseModel):
    query: str
    language: str = "en"
    mode: str = "direct"
    user_type: str = "farmer"  # farmer, expert, student
    crop_type: str = ""
    land_size: str = ""
    soil_type: str = ""

def get_rag_context(query: str, language: str = "en", top_k: int = 3, user_crop: str = "", user_soil: str = ""):
    try:
        ensure_lang_index(language)
        idx = kb_index[language]
        vect = idx['vectorizer']
        mat = idx['vectors']
        keys = idx['keys']

        query_vector = vect.transform([query])
        similarities = cosine_similarity(query_vector, mat)[0]

        # Boost by selected crop/soil
        crop_boost = 0.25 if user_crop else 0.0
        soil_boost = 0.15 if user_soil else 0.0
        for i, (cat, item) in enumerate(keys):
            if user_crop and cat == 'crops' and item.lower() == user_crop.lower():
                similarities[i] += crop_boost
            if user_soil and cat == 'soil' and item.lower() == user_soil.lower():
                similarities[i] += soil_boost

        top_indices = similarities.argsort()[-top_k:][::-1]

        relevant_context = []
        for idx_i in top_indices:
            if similarities[idx_i] <= 0:
                continue
            category, item = keys[idx_i]
            context_data = AGRICULTURE_KB[category][item]
            content = context_data.get(language) or context_data.get('en', '')
            relevant_context.append({
                'category': category,
                'item': item,
                'content': content,
                'similarity': float(similarities[idx_i])
            })
        return relevant_context
    except Exception as e:
        logger.error(f"RAG error: {e}")
        return []

@app.get("/", response_class=HTMLResponse)
async def home():
    return """
    <!DOCTYPE html>
    <html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
        <title>üåæ Fast Agriculture AI - Smart Assistant</title>
        <style>
            * {
                margin: 0;
                padding: 0;
                box-sizing: border-box;
                -webkit-tap-highlight-color: transparent;
            }
            body {
                font-family: 'Segoe UI', 'Roboto', sans-serif;
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                min-height: 100vh;
                color: white;
                padding: 10px;
                overflow-x: hidden;
            }
            .container {
                max-width: 400px;
                margin: 0 auto;
                padding: 0 10px;
            }
            .header {
                text-align: center;
                margin-bottom: 20px;
                padding: 20px 0;
            }
            .header h1 {
                font-size: 2.2em;
                margin-bottom: 5px;
                text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            }
            .subtitle {
                font-size: 1em;
                opacity: 0.9;
                margin-bottom: 10px;
            }
            .demo-section {
                background: rgba(255, 255, 255, 0.15);
                border-radius: 15px;
                padding: 20px;
                margin: 15px 0;
                backdrop-filter: blur(10px);
            }
            .section-title {
                font-size: 1.3em;
                margin-bottom: 15px;
                text-align: center;
                color: #FFD700;
                font-weight: bold;
            }
            .option-grid {
                display: grid;
                grid-template-columns: 1fr;
                gap: 12px;
                margin-bottom: 20px;
            }
            .option-button {
                background: rgba(255, 255, 255, 0.2);
                border: 2px solid rgba(255, 255, 255, 0.3);
                border-radius: 12px;
                padding: 15px;
                color: white;
                font-size: 1.1em;
                font-weight: bold;
                cursor: pointer;
                transition: all 0.3s ease;
                text-align: center;
                min-height: 60px;
                display: flex;
                align-items: center;
                justify-content: center;
                text-decoration: none;
            }
            .option-button:hover, .option-button.selected {
                background: rgba(255, 255, 255, 0.3);
                border-color: #FFD700;
                transform: translateY(-2px);
                box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            }
            .option-button.selected {
                background: #FFD700;
                color: #333;
            }
            .quick-questions {
                display: grid;
                grid-template-columns: 1fr;
                gap: 10px;
            }
            .quick-question {
                background: rgba(76, 175, 80, 0.8);
                border: none;
                border-radius: 10px;
                padding: 12px;
                color: white;
                font-size: 1em;
                cursor: pointer;
                transition: all 0.3s ease;
                text-align: left;
                line-height: 1.4;
            }
            .quick-question:hover {
                background: rgba(76, 175, 80, 1);
                transform: translateY(-1px);
            }
            .input-section {
                margin: 20px 0;
            }
            .input-group {
                display: flex;
                flex-direction: column;
                gap: 12px;
                margin-bottom: 15px;
            }
            input, select, textarea {
                padding: 15px;
                border: none;
                border-radius: 10px;
                font-size: 16px;
                background: rgba(255, 255, 255, 0.9);
                color: #333;
                width: 100%;
            }
            textarea {
                min-height: 80px;
                resize: vertical;
            }
            .action-buttons {
                display: grid;
                grid-template-columns: 1fr 1fr;
                gap: 10px;
                margin: 15px 0;
            }
            .btn {
                padding: 15px;
                border: none;
                border-radius: 10px;
                font-size: 1.1em;
                font-weight: bold;
                cursor: pointer;
                transition: all 0.3s ease;
                text-align: center;
            }
            .btn-primary {
                background: #4CAF50;
                color: white;
            }
            .btn-secondary {
                background: #FF9800;
                color: white;
            }
            .btn-voice {
                background: #2196F3;
                color: white;
            }
            .btn:hover {
                transform: translateY(-2px);
                box-shadow: 0 4px 12px rgba(0,0,0,0.2);
            }
            .response {
                background: rgba(255, 255, 255, 0.1);
                border-radius: 12px;
                padding: 20px;
                margin: 20px 0;
                min-height: 100px;
                white-space: pre-wrap;
                line-height: 1.6;
                font-size: 1.1em;
            }
            .loading {
                animation: pulse 1.5s infinite;
                text-align: center;
                font-size: 1.2em;
            }
            @keyframes pulse {
                0% { opacity: 1; }
                50% { opacity: 0.7; }
                100% { opacity: 1; }
            }
            .demo-info {
                background: rgba(76, 175, 80, 0.2);
                border-left: 4px solid #4CAF50;
                padding: 15px;
                margin: 15px 0;
                border-radius: 0 10px 10px 0;
                font-size: 0.95em;
            }
            .status-bar {
                background: rgba(0, 0, 0, 0.2);
                padding: 10px;
                border-radius: 8px;
                margin: 10px 0;
                font-size: 0.9em;
                text-align: center;
            }
            @media (max-width: 480px) {
                .header h1 { font-size: 1.8em; }
                .container { padding: 0 5px; }
                .demo-section { padding: 15px; }
                .action-buttons { grid-template-columns: 1fr; }
            }
        </style>
    </head>
    <body>
        <div class="container">
            <div class="header">
                <h1>üåæ Agriculture AI</h1>
                <div class="subtitle">üé§ Whisper + ÔøΩ Smart Assistant + üîä gTTS</div>
            </div>

            <div class="demo-info">
                <strong>üéØ Enhanced Global Agriculture Assistant:</strong><br>
                üé§ Whisper: Accurate speech recognition in any language<br>
                ü§ñ Smart Assistant: COMPREHENSIVE support for ALL crops worldwide<br>
                üîä gTTS: High-quality Google TTS for Indian languages<br>
                üåæ Global Crops: Cereals, Legumes, Vegetables, Fruits, Cash Crops<br>
                ‚ö° <strong>ALL CROPS SUPPORTED! Clean answers in all languages!</strong>
            </div>

            <!-- Language Selection -->
            <div class="demo-section">
                <div class="section-title">1Ô∏è‚É£ Select Language</div>
                <div class="option-grid">
                    <button class="option-button" onclick="selectLanguage('en')" id="lang-en">
                        üá∫üá∏ English
                    </button>
                    <button class="option-button" onclick="selectLanguage('ta')" id="lang-ta">
                        üáÆüá≥ ‡Æ§‡ÆÆ‡Æø‡Æ¥‡Øç (Tamil)
                    </button>
                    <button class="option-button" onclick="selectLanguage('te')" id="lang-te">
                        üáÆüá≥ ‡∞§‡±Ü‡∞≤‡±Å‡∞ó‡±Å (Telugu)
                    </button>
                    <button class="option-button" onclick="selectLanguage('ml')" id="lang-ml">
                        üáÆüá≥ ‡¥Æ‡¥≤‡¥Ø‡¥æ‡¥≥‡¥Ç (Malayalam)
                    </button>
                </div>
            </div>

            <!-- User Profile -->
            <div class="demo-section">
                <div class="section-title">2Ô∏è‚É£ Your Profile</div>
                <div class="option-grid">
                    <button class="option-button" onclick="selectProfile('farmer')" id="profile-farmer">
                        üë®‚Äçüåæ Farmer
                    </button>
                    <button class="option-button" onclick="selectProfile('expert')" id="profile-expert">
                        üî¨ Agriculture Expert
                    </button>
                    <button class="option-button" onclick="selectProfile('student')" id="profile-student">
                        üéì Student/Learner
                    </button>
                </div>
            </div>

            <!-- Land Details -->
            <div class="demo-section">
                <div class="section-title">3Ô∏è‚É£ Land Details</div>
                <div class="input-group">
                    <select id="cropType">
                        <option value="">Select Main Crop</option>
                        <option value="rice">üåæ Rice/Paddy</option>
                        <option value="wheat">üåæ Wheat</option>
                        <option value="corn">üåΩ Corn/Maize</option>
                        <option value="barley">üåæ Barley</option>
                        <option value="oats">üåæ Oats</option>
                        <option value="soybeans">ü´ò Soybeans</option>
                        <option value="chickpeas">ü´ò Chickpeas</option>
                        <option value="lentils">ü´ò Lentils</option>
                        <option value="tomatoes">üçÖ Tomatoes</option>
                        <option value="potatoes">ü•î Potatoes</option>
                        <option value="onions">üßÖ Onions</option>
                        <option value="carrots">ü•ï Carrots</option>
                        <option value="apples">üçé Apples</option>
                        <option value="oranges">üçä Oranges</option>
                        <option value="bananas">üçå Bananas</option>
                        <option value="grapes">üçá Grapes</option>
                        <option value="cotton">üåø Cotton</option>
                        <option value="sugarcane">üéã Sugarcane</option>
                        <option value="coffee">‚òï Coffee</option>
                        <option value="tea">üçµ Tea</option>
                        <option value="vegetables">ü•¨ Mixed Vegetables</option>
                        <option value="fruits">üçé Mixed Fruits</option>
                        <option value="other">üå± Other Crop</option>
                    </select>
                    <select id="landSize">
                        <option value="">Select Land Size</option>
                        <option value="small">üè† Small (< 2 acres)</option>
                        <option value="medium">üè° Medium (2-10 acres)</option>
                        <option value="large">üè≠ Large (> 10 acres)</option>
                    </select>
                    <select id="soilType">
                        <option value="">Select Soil Type</option>
                        <option value="clay">üü§ Clay Soil</option>
                        <option value="sandy">üü® Sandy Soil</option>
                        <option value="loamy">üü´ Loamy Soil</option>
                        <option value="other">‚ùì Not Sure</option>
                    </select>
                </div>
            </div>

            <!-- Quick Questions -->
            <div class="demo-section">
                <div class="section-title">4Ô∏è‚É£ Quick Questions</div>
                <div class="quick-questions">
                    <button class="quick-question" onclick="askQuickQuestion('What is the best crop for my soil type?')">
                        üå± What crop is best for my soil?
                    </button>
                    <button class="quick-question" onclick="askQuickQuestion('How much water does my crop need and when?')">
                        üíß Water requirements and timing
                    </button>
                    <button class="quick-question" onclick="askQuickQuestion('What fertilizer should I use for maximum yield?')">
                        üß™ Best fertilizers for high yield
                    </button>
                    <button class="quick-question" onclick="askQuickQuestion('How to prevent and treat crop diseases?')">
                        ü¶† Disease prevention and treatment
                    </button>
                    <button class="quick-question" onclick="askQuickQuestion('When is the best time to plant my crop?')">
                        üìÖ Optimal planting seasons
                    </button>
                    <button class="quick-question" onclick="askQuickQuestion('How to control pests naturally?')">
                        üêõ Natural pest control methods
                    </button>
                    <button class="quick-question" onclick="askQuickQuestion('What are the signs of nutrient deficiency?')">
                        üìä Nutrient deficiency symptoms
                    </button>
                    <button class="quick-question" onclick="askQuickQuestion('How to improve soil quality?')">
                        üåç Soil improvement techniques
                    </button>
                </div>
            </div>

            <!-- Custom Question -->
            <div class="demo-section">
                <div class="section-title">üìù Ask Your Question</div>
                <div class="input-section">
                    <textarea id="queryInput" placeholder="Type your agriculture question here..."></textarea>
                    <div class="action-buttons">
                        <button class="btn btn-primary" onclick="askAI()">üöÄ Ask Smart Assistant</button>
                        <button class="btn btn-voice" onclick="startWhisperInput()">üé§ Whisper</button>
                    </div>
                    <button class="btn btn-secondary" onclick="testTTS()" style="width: 100%; margin-top: 10px;">
                        üîä Test gTTS (Google TTS)
                    </button>
                    <button class="btn btn-secondary" onclick="testPhoneticTamil()" style="width: 100%; margin-top: 5px; background: #e53e3e;">
                        üéØ Test Tamil Script (Native pronunciation)
                    </button>
                </div>
            </div>

            <!-- Status Bar -->
            <div class="status-bar" id="statusBar">
                üü¢ Ready | Smart Assistant + Whisper + gTTS | Language: English
            </div>

            <!-- Response Area -->
            <div id="response" class="response">
                Welcome to Enhanced Global Agriculture AI! üåæ<br><br>
                <strong>üåç COMPREHENSIVE CROP SUPPORT:</strong><br>
                ÔøΩ Cereals: Rice, Wheat, Corn, Barley, Oats, Millet<br>
                ü´ò Legumes: Soybeans, Chickpeas, Lentils, Beans, Peas<br>
                ü•¨ Vegetables: Tomatoes, Potatoes, Onions, Carrots, Cabbage<br>
                üçé Fruits: Apples, Oranges, Bananas, Grapes, Mango<br>
                üåø Cash Crops: Cotton, Sugarcane, Coffee, Tea, Tobacco<br><br>
                <strong>ÔøΩÔ∏è Agriculture-Only Assistant:</strong><br>
                ‚úÖ Answers ALL agriculture-related questions<br>
                üåê Clean answers in ALL languages<br>
                üé§ Whisper + ü§ñ Smart RAG + üîä gTTS = Perfect combo!
            </div>
        </div>

        <script>
            let selectedLanguage = 'en';
            let selectedProfile = '';

            // Language selection
            function selectLanguage(lang) {
                selectedLanguage = lang;
                document.querySelectorAll('[id^="lang-"]').forEach(btn => btn.classList.remove('selected'));
                document.getElementById(`lang-${lang}`).classList.add('selected');
                updateStatusBar();
                console.log(`üåç Language selected: ${lang}`);
            }

            // Profile selection
            function selectProfile(profile) {
                selectedProfile = profile;
                document.querySelectorAll('[id^="profile-"]').forEach(btn => btn.classList.remove('selected'));
                document.getElementById(`profile-${profile}`).classList.add('selected');
                updateStatusBar();
                console.log(`üë§ Profile selected: ${profile}`);
            }

            // Update status bar
            function updateStatusBar() {
                const langNames = {
                    'en': 'English',
                    'ta': 'Tamil',
                    'te': 'Telugu',
                    'ml': 'Malayalam'
                };
                
                const status = `üü¢ Ready | Global Crop Assistant + Whisper + gTTS | Language: ${langNames[selectedLanguage]}`;
                document.getElementById('statusBar').textContent = status;
            }

            // Quick question handler
            function askQuickQuestion(question) {
                document.getElementById('queryInput').value = question;
                askAI();
            }

            // Get user details
            function getUserDetails() {
                return {
                    cropType: document.getElementById('cropType').value,
                    landSize: document.getElementById('landSize').value,
                    soilType: document.getElementById('soilType').value
                };
            }

            // MAIN FUNCTION - Ask AI with Smart Assistant + RAG
            async function askAI() {
                console.log('üöÄ askAI function called with Enhanced Global Agriculture Assistant');
                
                const query = document.getElementById('queryInput').value;
                const responseDiv = document.getElementById('response');
                const details = getUserDetails();

                if (!query.trim()) {
                    alert('Please enter a question about agriculture or farming!');
                    return;
                }

                console.log(`üìù Query: "${query}" in language: ${selectedLanguage}`);
                responseDiv.innerHTML = '<div class="loading">üåæ Global Agriculture Assistant analyzing your question with RAG...</div>';

                try {
                    const requestData = {
                        query: query,
                        language: selectedLanguage,
                        mode: 'rag',
                        user_type: selectedProfile,
                        crop_type: details.cropType,
                        land_size: details.landSize,
                        soil_type: details.soilType
                    };

                    const response = await fetch('/query', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify(requestData)
                    });

                    const data = await response.json();
                    console.log('‚úÖ Received Enhanced Agriculture Assistant response:', data);
                    
                    let responseText = `<strong>üåæ Global Agriculture Assistant Response:</strong>\\n\\n${data.answer}`;
                    
                    if (data.rag_sources && data.rag_sources.length > 0) {
                        responseText += `\\n\\nüìö <strong>Knowledge Sources:</strong>\\n`;
                        data.rag_sources.forEach((source, idx) => {
                            responseText += `${idx + 1}. ${source.category.toUpperCase()}: ${source.item}\\n`;
                        });
                    }
                    
                    if (data.restriction) {
                        responseText += `\\n\\nüõ°Ô∏è <strong>Note:</strong> This assistant only responds to agriculture-related questions.`;
                    }
                    
                    responseText += `\\n<hr style="border: 1px solid rgba(255,255,255,0.3); margin: 15px 0;">`;
                    responseText += `üìä Model: ${data.model} | ‚è±Ô∏è Time: ${data.processing_time_ms}ms | üîó Sources: ${data.rag_sources ? data.rag_sources.length : 0}`;
                    
                    responseDiv.innerHTML = responseText;

                    // Use pyttsx3 TTS
                    if (data.answer) {
                        console.log(`üîä Starting pyttsx3 TTS: "${data.answer.substring(0, 50)}..."`);
                        await speakWithPyttsx3(data.answer, selectedLanguage);
                    }

                } catch (error) {
                    console.error('‚ùå Error:', error);
                    responseDiv.innerHTML = `‚ùå Error: ${error.message}`;
                }
            }

            // Enhanced pyttsx3 TTS function
            async function speakWithPyttsx3(text, language) {
                console.log(`üîä Using pyttsx3 TTS for ${language}`);
                
                try {
                    const ttsResponse = await fetch('/generate-tts', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            text: text,
                            language: language
                        })
                    });
                    
                    const ttsData = await ttsResponse.json();
                    
                    if (ttsData.success && ttsData.audio_base64) {
                        console.log(`‚úÖ Using ${ttsData.service} (${ttsData.voice})`);
                        
                        // Create audio element and play (supports both WAV and MP3)
                        const audio = new Audio();
                        const audioFormat = ttsData.audio_format || 'wav';
                        audio.src = `data:audio/${audioFormat};base64,${ttsData.audio_base64}`;
                        
                        return new Promise((resolve) => {
                            audio.onended = () => {
                                console.log('‚úÖ pyttsx3 TTS completed successfully');
                                resolve();
                            };
                            
                            audio.onerror = (error) => {
                                console.error('‚ùå Audio playback error:', error);
                                resolve();
                            };
                            
                            audio.play().catch(error => {
                                console.error('‚ùå Audio play error:', error);
                                resolve();
                            });
                        });
                    } else {
                        console.log('üîÑ pyttsx3 not available, no TTS');
                    }
                    
                } catch (error) {
                    console.error('‚ùå TTS request failed:', error);
                }
            }

            // Whisper speech input function
            async function startWhisperInput() {
                console.log('üé§ Starting Whisper input...');
                
                const responseDiv = document.getElementById('response');
                responseDiv.innerHTML = 'üé§ Listening with Whisper... Speak your agriculture question!';
                
                try {
                    // Use Web API for audio capture
                    const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
                    const mediaRecorder = new MediaRecorder(stream);
                    const audioChunks = [];
                    
                    mediaRecorder.ondataavailable = (event) => {
                        audioChunks.push(event.data);
                    };
                    
                    mediaRecorder.onstop = async () => {
                        const audioBlob = new Blob(audioChunks, { type: 'audio/wav' });
                        const arrayBuffer = await audioBlob.arrayBuffer();
                        const base64Audio = btoa(String.fromCharCode(...new Uint8Array(arrayBuffer)));
                        
                        console.log('üé§ Audio captured, sending to Whisper...');
                        responseDiv.innerHTML = 'üé§ Processing with Whisper...';
                        
                        try {
                            const response = await fetch('/whisper-transcribe', {
                                method: 'POST',
                                headers: {
                                    'Content-Type': 'application/json',
                                },
                                body: JSON.stringify({
                                    audio_data: base64Audio,
                                    language: selectedLanguage
                                })
                            });
                            
                            const data = await response.json();
                            
                            if (data.success) {
                                console.log(`‚úÖ Whisper transcription: "${data.transcribed_text}"`);
                                document.getElementById('queryInput').value = data.transcribed_text;
                                responseDiv.innerHTML = `üé§ Whisper heard: "${data.transcribed_text}"\\n\\nClick "Ask Smart Assistant" to get an answer!`;
                            } else {
                                console.error('‚ùå Whisper failed:', data.error);
                                responseDiv.innerHTML = `‚ùå Whisper error: ${data.error}`;
                            }
                            
                        } catch (error) {
                            console.error('‚ùå Whisper request failed:', error);
                            responseDiv.innerHTML = `‚ùå Whisper request failed: ${error.message}`;
                        }
                        
                        // Stop all tracks
                        stream.getTracks().forEach(track => track.stop());
                    };
                    
                    // Record for 5 seconds
                    mediaRecorder.start();
                    setTimeout(() => {
                        if (mediaRecorder.state === 'recording') {
                            mediaRecorder.stop();
                        }
                    }, 5000);
                    
                } catch (error) {
                    console.error('‚ùå Microphone access failed:', error);
                    responseDiv.innerHTML = `‚ùå Microphone access failed: ${error.message}`;
                }
            }

            // Allow Enter key to submit
            document.getElementById('queryInput').addEventListener('keypress', function(event) {
                if (event.key === 'Enter') {
                    askAI();
                }
            });

            console.log('üöÄ Enhanced Global Agriculture AI ready with comprehensive crop support!');
        </script>
    </body>
    </html>
    """

@app.post("/query")
async def query_agriculture(request: QueryRequest):
    start_time = time.time()
    
    try:
        logger.info(f"üåæ Smart RAG Query: {request.query[:50]}... | Language: {request.language} | Profile: {request.user_type}")
        
        # Get RAG context for agriculture query (removed restriction filter)
        explicit_crop = detect_explicit_crop(request.query, request.language)
        rag_context = get_rag_context(
            request.query,
            request.language,
            top_k=3,
            user_crop=explicit_crop or request.crop_type,
            user_soil=request.soil_type
        )
        
        # Enhanced Smart Agriculture Assistant with comprehensive crop knowledge
        def generate_smart_agriculture_answer(query, language, rag_context, user_context):
            """Generate practical agriculture answers with comprehensive crop support"""
            
            # Build comprehensive answer from RAG context
            if rag_context:
                best_match = rag_context[0]
                answer = best_match['content']
                
                # Add specific advice based on user context and crop type
                crop_type = user_context.get('crop_type', '')
                soil_type = user_context.get('soil_type', '')
                land_size = user_context.get('land_size', '')
                
                # Soil-specific advice
                if soil_type == 'clay':
                    if language == 'ta':
                        answer += " ‡Æï‡Æ≥‡Æø‡ÆÆ‡Æ£‡Øç ‡ÆÆ‡Æ£‡Øç‡Æ£‡ØÅ‡Æï‡Øç‡Æï‡ØÅ: ‡Æ®‡Æ≤‡Øç‡Æ≤ ‡Æµ‡Æü‡Æø‡Æï‡Ææ‡Æ≤‡Øç ‡ÆÖ‡ÆÆ‡Øà‡Æ™‡Øç‡Æ™‡ØÅ ‡ÆÖ‡Æµ‡Æö‡Æø‡ÆØ‡ÆÆ‡Øç. ‡Æï‡Æ∞‡Æø‡ÆÆ‡Æ™‡Øç ‡Æ™‡Øä‡Æ∞‡ØÅ‡Æü‡Øç‡Æï‡Æ≥‡Øà‡Æö‡Øç ‡Æö‡Øá‡Æ∞‡Øç‡Æï‡Øç‡Æï‡Æµ‡ØÅ‡ÆÆ‡Øç."
                    elif language == 'te':
                        answer += " ‡∞Æ‡∞ü‡±ç‡∞ü‡∞ø ‡∞Æ‡∞ü‡±ç‡∞ü‡∞ø‡∞ï‡∞ø: ‡∞Æ‡∞Ç‡∞ö‡∞ø ‡∞°‡±ç‡∞∞‡±à‡∞®‡±á‡∞ú‡±ç ‡∞µ‡±ç‡∞Ø‡∞µ‡∞∏‡±ç‡∞• ‡∞Ö‡∞µ‡∞∏‡∞∞‡∞Ç. ‡∞∏‡±á‡∞Ç‡∞¶‡±ç‡∞∞‡±Ä‡∞Ø ‡∞™‡∞¶‡∞æ‡∞∞‡±ç‡∞•‡∞æ‡∞≤‡∞®‡±Å ‡∞ï‡∞≤‡∞™‡∞Ç‡∞°‡∞ø."
                    elif language == 'ml':
                        answer += " ‡¥ï‡¥≥‡¥ø‡¥Æ‡¥£‡µç‡¥£‡¥ø‡¥®‡µç: ‡¥®‡¥≤‡µç‡¥≤ ‡¥°‡µç‡¥∞‡µÜ‡¥Ø‡¥ø‡¥®‡µá‡¥ú‡µç ‡¥∏‡¥ø‡¥∏‡µç‡¥±‡µç‡¥±‡¥Ç ‡¥Ü‡¥µ‡¥∂‡µç‡¥Ø‡¥Ç. ‡¥ú‡µà‡¥µ‡¥µ‡¥∏‡µç‡¥§‡µÅ‡¥ï‡µç‡¥ï‡µæ ‡¥ö‡µá‡µº‡¥ï‡µç‡¥ï‡µÅ‡¥ï."
                    elif language == 'hi':
                        answer += " ‡§ö‡§ø‡§ï‡§®‡•Ä ‡§Æ‡§ø‡§ü‡•ç‡§ü‡•Ä ‡§ï‡•á ‡§≤‡§ø‡§è: ‡§Ö‡§ö‡•ç‡§õ‡•Ä ‡§ú‡§≤ ‡§®‡§ø‡§ï‡§æ‡§∏‡•Ä ‡§µ‡•ç‡§Ø‡§µ‡§∏‡•ç‡§•‡§æ ‡§ú‡§∞‡•Ç‡§∞‡•Ä‡•§ ‡§ú‡•à‡§µ‡§ø‡§ï ‡§™‡§¶‡§æ‡§∞‡•ç‡§• ‡§Æ‡§ø‡§≤‡§æ‡§è‡§Ç‡•§"
                    else:
                        answer += " For clay soil: Good drainage system essential. Add organic matter to improve structure."
                
                elif soil_type == 'sandy':
                    if language == 'ta':
                        answer += " ‡ÆÆ‡Æ£‡Æ≤‡Øç ‡ÆÆ‡Æ£‡Øç‡Æ£‡ØÅ‡Æï‡Øç‡Æï‡ØÅ: ‡ÆÖ‡Æü‡Æø‡Æï‡Øç‡Æï‡Æü‡Æø ‡Æ®‡ØÄ‡Æ∞‡Øç‡Æ™‡Øç‡Æ™‡Ææ‡Æö‡Æ©‡ÆÆ‡Øç ‡Æ§‡Øá‡Æµ‡Øà‡•§ ‡Æï‡ÆÆ‡Øç‡Æ™‡Øã‡Æ∏‡Øç‡Æü‡Øç ‡Æö‡Øá‡Æ∞‡Øç‡Æ§‡Øç‡Æ§‡ØÅ ‡Æä‡Æü‡Øç‡Æü‡Æö‡Øç‡Æö‡Æ§‡Øç‡Æ§‡ØÅ ‡Æ§‡Æï‡Øç‡Æï‡Æµ‡Øà‡Æï‡Øç‡Æï‡Æµ‡ØÅ‡ÆÆ‡Øç."
                    elif language == 'te':
                        answer += " ‡∞á‡∞∏‡±Å‡∞ï ‡∞Æ‡∞ü‡±ç‡∞ü‡∞ø‡∞ï‡∞ø: ‡∞§‡∞∞‡∞ö‡±Å‡∞ó‡∞æ ‡∞®‡±Ä‡∞ü‡∞ø‡∞™‡∞æ‡∞∞‡±Å‡∞¶‡∞≤ ‡∞Ö‡∞µ‡∞∏‡∞∞‡∞Ç. ‡∞ï‡∞Ç‡∞™‡±ã‡∞∏‡±ç‡∞ü‡±ç ‡∞ö‡±á‡∞∞‡Øç‡∞ö‡∞ø ‡∞™‡±ã‡∞∑‡∞ï‡∞æ‡∞≤‡∞®‡±Å ‡∞®‡∞ø‡∞≤‡±Å‡∞™‡±Å‡∞ï‡±ã‡∞Ç‡∞°‡∞ø."
                    elif language == 'ml':
                        answer += " ‡¥Æ‡¥£‡µΩ‡¥Æ‡¥£‡µç‡¥£‡¥ø‡¥®‡µç: ‡¥á‡¥ü‡¥Ø‡µç‡¥ï‡µç‡¥ï‡¥ø‡¥ü‡µÜ ‡¥®‡¥®‡¥Ø‡µç‡¥ï‡µç‡¥ï‡¥£‡¥Ç. ‡¥ï‡¥Æ‡µç‡¥™‡µã‡¥∏‡µç‡¥±‡µç‡¥±‡µç ‡¥ö‡µá‡µº‡¥§‡µç‡¥§‡µç ‡¥™‡µã‡¥∑‡¥ï‡¥ô‡µç‡¥ô‡µæ ‡¥®‡¥ø‡¥≤‡¥®‡¥ø‡µº‡¥§‡µç‡¥§‡µÅ‡¥ï."
                    elif language == 'hi':
                        answer += " ‡§∞‡•á‡§§‡•Ä‡§≤‡•Ä ‡§Æ‡§ø‡§ü‡•ç‡§ü‡•Ä ‡§ï‡•á ‡§≤‡§ø‡§è: ‡§¨‡§æ‡§∞-‡§¨‡§æ‡§∞ ‡§∏‡§ø‡§Ç‡§ö‡§æ‡§à ‡§ö‡§æ‡§π‡§ø‡§è‡•§ ‡§ï‡§Ç‡§™‡•ã‡§∏‡•ç‡§ü ‡§Æ‡§ø‡§≤‡§æ‡§ï‡§∞ ‡§™‡•ã‡§∑‡§ï ‡§§‡§§‡•ç‡§µ ‡§¨‡§®‡§æ‡§è ‡§∞‡§ñ‡•á‡§Ç‡•§"
                    else:
                        answer += " For sandy soil: Frequent irrigation needed. Add compost to retain nutrients."
                
                # Land size specific advice
                if land_size == 'small':
                    if language == 'ta':
                        answer += " ‡Æö‡Æø‡Æ±‡Æø‡ÆØ ‡Æ®‡Æø‡Æ≤‡Æ§‡Øç‡Æ§‡Æø‡Æ±‡Øç‡Æï‡ØÅ: ‡Æö‡Øä‡Æü‡Øç‡Æü‡ØÅ ‡Æ®‡ØÄ‡Æ∞‡Øç‡Æ™‡Øç‡Æ™‡Ææ‡Æö‡Æ©‡ÆÆ‡Øç, ‡Æö‡ØÜ‡Æô‡Øç‡Æï‡ØÅ‡Æ§‡Øç‡Æ§‡ØÅ ‡Æµ‡Æø‡Æµ‡Æö‡Ææ‡ÆØ‡ÆÆ‡Øç, ‡ÆÆ‡Æ£‡Øç‡Æ£‡Æø‡Æ©‡Øç ‡ÆÆ‡Æ≤‡Øç‡Æö‡Øç‡Æö‡Æø‡Æô‡Øç ‡Æ™‡Æ∞‡Æø‡Æ®‡Øç‡Æ§‡ØÅ‡Æ∞‡Øà‡Æï‡Øç‡Æï‡Æ™‡Øç‡Æ™‡Æü‡ØÅ‡Æï‡Æø‡Æ±‡Æ§‡ØÅ."
                    elif language == 'te':
                        answer += " ‡∞ö‡∞ø‡∞®‡±ç‡∞® ‡∞≠‡±Ç‡∞Æ‡∞ø‡∞ï‡∞ø: ‡∞°‡±ç‡∞∞‡∞ø‡∞™‡±ç ‡∞®‡±Ä‡∞ü‡∞ø‡∞™‡∞æ‡∞∞‡±Å‡∞¶‡∞≤, ‡∞®‡∞ø‡∞≤‡±Å‡∞µ‡±Å ‡∞µ‡±ç‡∞Ø‡∞µ‡∞∏‡∞æ‡∞Ø‡∞Ç, ‡∞Æ‡∞ü‡±ç‡∞ü‡∞ø ‡∞ï‡∞µ‡∞∞‡∞ø‡∞Ç‡∞ó‡±ç ‡∞∏‡∞ø‡∞´‡∞æ‡∞∞‡±ç‡∞∏‡±Å ‡∞ö‡±á‡∞Ø‡∞¨‡∞°‡∞ø‡∞Ç‡∞¶‡∞ø."
                    elif language == 'ml':
                        answer += " ‡¥ö‡µÜ‡¥±‡¥ø‡ÆØ ‡¥≠‡µÇ‡¥Æ‡¥ø‡¥ï‡µç‡¥ï‡µç: ‡¥°‡µç‡¥∞‡¥ø‡¥™‡µç‡¥™‡µç ‡¥ú‡¥≤‡¥∏‡µá‡¥ö‡¥®‡¥Ç, ‡¥≤‡¥Ç‡¥¨‡¥Æ‡¥æ‡¥Ø ‡¥ï‡µÉ‡¥∑‡¥ø, ‡¥Æ‡¥£‡µç‡¥£‡µç ‡¥Æ‡µæ‡¥ö‡µç‡¥ö‡¥ø‡¥Ç‡¥ó‡µç ‡¥∂‡µÅ‡¥™‡¥æ‡µº‡¥∂ ‡¥ö‡µÜ‡¥Ø‡µç‡¥Ø‡µÅ‡¥®‡µç‡¥®‡µÅ."
                    elif language == 'hi':
                        answer += " ‡§õ‡•ã‡§ü‡•Ä ‡§ú‡§Æ‡•Ä‡§® ‡§ï‡•á ‡§≤‡§ø‡§è: ‡§°‡•ç‡§∞‡§ø‡§™ ‡§∏‡§ø‡§Ç‡§ö‡§æ‡§à, ‡§ä‡§∞‡•ç‡§ß‡•ç‡§µ‡§æ‡§ß‡§∞ ‡§ñ‡•á‡§§‡•Ä, ‡§Æ‡§ø‡§ü‡•ç‡§ü‡•Ä ‡§Æ‡§≤‡•ç‡§ö‡§ø‡§Ç‡§ó ‡§ï‡•Ä ‡§∏‡§ø‡§´‡§æ‡§∞‡§ø‡§∂‡•§"
                    else:
                        answer += " For small land: Drip irrigation, vertical farming, soil mulching recommended."
                
                # Seasonal advice
                import datetime
                current_month = datetime.datetime.now().month
                
                if 6 <= current_month <= 10:  # Monsoon/Kharif season
                    if language == 'ta':
                        answer += " ‡Æ§‡Æ±‡Øç‡Æ™‡Øã‡Æ§‡ØÅ ‡Æï‡Æ∞‡ØÄ‡Æ™‡Øç ‡Æ™‡Æ∞‡ØÅ‡Æµ‡ÆÆ‡Øç. ‡ÆÖ‡Æ∞‡Æø‡Æö‡Æø, ‡Æ™‡Æ∞‡ØÅ‡Æ§‡Øç‡Æ§‡Æø, ‡Æö‡Øã‡Æ≥‡ÆÆ‡Øç, ‡Æï‡Æ∞‡ØÅ‡ÆÆ‡Øç‡Æ™‡ØÅ ‡ÆÜ‡Æï‡Æø‡ÆØ‡Æµ‡Æ±‡Øç‡Æ±‡ØÅ‡Æï‡Øç‡Æï‡ØÅ ‡Æè‡Æ±‡Øç‡Æ± ‡Æï‡Ææ‡Æ≤‡ÆÆ‡Øç."
                    elif language == 'te':
                        answer += " ‡∞™‡±ç‡∞∞‡∞∏‡±ç‡∞§‡±Å‡∞§‡∞Ç ‡∞ñ‡∞∞‡±Ä‡∞´‡±ç ‡∞∏‡±Ä‡∞ú‡∞®‡±ç. ‡∞µ‡∞∞‡∞ø, ‡∞™‡∞§‡±ç‡∞§‡∞ø, ‡∞Æ‡±ä‡∞ï‡±ç‡∞ï‡∞ú‡±ä‡∞®‡±ç‡∞®, ‡∞ö‡±Ü‡∞∞‡∞ï‡±Å‡∞ï‡±Å ‡∞Ö‡∞®‡±Å‡∞µ‡±à‡∞® ‡∞∏‡∞Æ‡∞Ø‡∞Ç."
                    elif language == 'ml':
                        answer += " ‡¥á‡¥™‡µç‡¥™‡µã‡µæ ‡¥ñ‡¥∞‡µÄ‡¥´‡µç ‡¥∏‡µÄ‡¥∏‡µ∫. ‡¥Ö‡¥∞‡¥ø, ‡¥™‡¥∞‡µÅ‡¥§‡µç‡¥§‡¥ø, ‡¥ö‡µã‡¥≥‡¥Ç, ‡¥ï‡¥∞‡¥ø‡¥Æ‡µç‡¥™‡µç ‡¥é‡¥®‡µç‡¥®‡¥ø‡¥µ‡¥Ø‡µç‡¥ï‡µç‡¥ï‡µç ‡¥Ö‡¥®‡µÅ‡¥Ø‡µã‡¥ú‡µç‡¥Ø‡¥Æ‡¥æ‡¥Ø ‡¥∏‡¥Æ‡¥Ø‡¥Ç."
                    elif language == 'hi':
                        answer += " ‡§Ö‡§≠‡•Ä ‡§ñ‡§∞‡•Ä‡§´ ‡§Æ‡•å‡§∏‡§Æ‡•§ ‡§ß‡§æ‡§®, ‡§ï‡§™‡§æ‡§∏, ‡§Æ‡§ï‡•ç‡§ï‡§æ, ‡§ó‡§®‡•ç‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§â‡§™‡§Ø‡•Å‡§ï‡•ç‡§§ ‡§∏‡§Æ‡§Ø‡•§"
                    else:
                        answer += " Current Kharif season. Suitable time for rice, cotton, corn, sugarcane."
                
                elif 11 <= current_month <= 4:  # Winter/Rabi season
                    if language == 'ta':
                        answer += " ‡Æ§‡Æ±‡Øç‡Æ™‡Øã‡Æ§‡ØÅ ‡Æ∞‡Æ™‡Æø ‡Æ™‡Æ∞‡ØÅ‡Æµ‡ÆÆ‡Øç. ‡Æï‡Øã‡Æ§‡ØÅ‡ÆÆ‡Øà, ‡Æ™‡Ææ‡Æ∞‡Øç‡Æ≤‡Æø, ‡Æï‡Æü‡ØÅ‡Æï‡ØÅ, ‡Æ™‡Æü‡Øç‡Æü‡Ææ‡Æ£‡Æø ‡ÆÜ‡Æï‡Æø‡ÆØ‡Æµ‡Æ±‡Øç‡Æ±‡ØÅ‡Æï‡Øç‡Æï‡ØÅ ‡Æè‡Æ±‡Øç‡Æ± ‡Æï‡Ææ‡Æ≤‡ÆÆ‡Øç."
                    elif language == 'te':
                        answer += " ‡∞™‡±ç‡∞∞‡∞∏‡±ç‡∞§‡±Å‡∞§‡∞Ç ‡∞∞‡∞¨‡±Ä ‡∞∏‡±Ä‡∞ú‡∞®‡±ç. ‡∞ó‡±ã‡∞ß‡±Å‡∞Æ, ‡∞¨‡∞æ‡∞∞‡±ç‡∞≤‡±Ä, ‡∞Ü‡∞µ‡∞æ‡∞≤‡±Å, ‡∞¨‡∞†‡∞æ‡∞®‡±Å‡∞≤ ‡∞ï‡±ã‡∞∏‡∞Ç ‡∞Ö‡∞®‡±Å‡∞µ‡±à‡∞® ‡∞∏‡∞Æ‡∞Ø‡∞Ç."
                    elif language == 'ml':
                        answer += " ‡¥á‡¥™‡µç‡¥™‡µã‡µæ ‡¥±‡¥¨‡µÄ ‡¥∏‡µÄ‡¥∏‡µ∫. ‡¥ó‡µã‡¥§‡¥Æ‡µç‡¥™‡µç, ‡¥¨‡¥æ‡µº‡¥≤‡¥ø, ‡¥ï‡¥ü‡µÅ‡¥ï‡µç, ‡¥™‡¥Ø‡µº ‡¥é‡¥®‡µç‡¥®‡¥ø‡¥µ‡¥Ø‡µç‡¥ï‡µç‡¥ï‡µç ‡¥Ö‡¥®‡µÅ‡¥Ø‡µã‡¥ú‡µç‡¥Ø‡¥Æ‡¥æ‡¥Ø ‡¥∏‡¥Æ‡¥Ø‡¥Ç."
                    elif language == 'hi':
                        answer += " ‡§Ö‡§≠‡•Ä ‡§∞‡§¨‡•Ä ‡§Æ‡•å‡§∏‡§Æ‡•§ ‡§ó‡•á‡§π‡•Ç‡§Ç, ‡§ú‡•å, ‡§∏‡§∞‡§∏‡•ã‡§Ç, ‡§Æ‡§ü‡§∞ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§â‡§™‡§Ø‡•Å‡§ï‡•ç‡§§ ‡§∏‡§Æ‡§Ø‡•§"
                    else:
                        answer += " Current Rabi season. Suitable time for wheat, barley, mustard, peas."
                
                return answer
            
            # Enhanced fallback responses with comprehensive crop support
            practical_fallbacks = {
                'en': {
                    'general': "For general farming: 1) Test soil pH (6.0-7.5 optimal), 2) Use organic compost, 3) Follow proper irrigation schedule, 4) Monitor for pests. I can help with any crop - cereals (rice, wheat, corn), legumes (soybeans, chickpeas), vegetables (tomatoes, potatoes), fruits (apples, oranges), or cash crops (cotton, sugarcane).",
                    'fertilizer': "Balanced NPK fertilizer guide: Most crops need 40kg Urea + 25kg DAP + 15kg MOP per acre. Split application - half at sowing, rest after 30-45 days. Organic options: compost, vermicompost, green manure.",
                    'pest': "Integrated pest management: 1) Neem oil spray (5ml/liter), 2) Remove affected parts, 3) Yellow sticky traps, 4) Beneficial insects, 5) Crop rotation. Specific treatments vary by crop and pest type.",
                    'disease': "Disease prevention: 1) Proper spacing for air circulation, 2) Avoid overhead watering, 3) Remove infected parts immediately, 4) Copper-based fungicides for fungal issues, 5) Resistant varieties when available."
                },
                'ta': {
                    'general': "‡Æ™‡Øä‡Æ§‡ØÅ‡Æµ‡Ææ‡Æ© ‡Æµ‡Øá‡Æ≥‡Ææ‡Æ£‡Øç‡ÆÆ‡Øà‡Æï‡Øç‡Æï‡ØÅ: 1) ‡ÆÆ‡Æ£‡Øç pH ‡Æö‡Øã‡Æ§‡Æ©‡Øà (6.0-7.5 ‡Æö‡Æø‡Æ±‡Æ®‡Øç‡Æ§‡Æ§‡ØÅ), 2) ‡Æï‡Æ∞‡Æø‡ÆÆ ‡Æï‡ÆÆ‡Øç‡Æ™‡Øã‡Æ∏‡Øç‡Æü‡Øç ‡Æ™‡ÆØ‡Æ©‡Øç‡Æ™‡Æü‡ØÅ‡Æ§‡Øç‡Æ§‡Æµ‡ØÅ‡ÆÆ‡Øç, 3) ‡Æö‡Æ∞‡Æø‡ÆØ‡Ææ‡Æ© ‡Æ®‡ØÄ‡Æ∞‡Øç‡Æ™‡Øç‡Æ™‡Ææ‡Æö‡Æ©‡ÆÆ‡Øç, 4) ‡Æ™‡ØÇ‡Æö‡Øç‡Æö‡Æø‡Æï‡Æ≥‡Øç ‡Æï‡Æ£‡Øç‡Æï‡Ææ‡Æ£‡Æø‡Æ™‡Øç‡Æ™‡ØÅ. ‡Æ®‡Ææ‡Æ©‡Øç ‡ÆÖ‡Æ©‡Øà‡Æ§‡Øç‡Æ§‡ØÅ ‡Æ™‡ÆØ‡Æø‡Æ∞‡Øç‡Æï‡Æ≥‡ØÅ‡Æï‡Øç‡Æï‡ØÅ‡ÆÆ‡Øç ‡Æâ‡Æ§‡Æµ ‡ÆÆ‡ØÅ‡Æü‡Æø‡ÆØ‡ØÅ‡ÆÆ‡Øç - ‡Æ§‡Ææ‡Æ©‡Æø‡ÆØ‡Æô‡Øç‡Æï‡Æ≥‡Øç, ‡Æ™‡Æ∞‡ØÅ‡Æ™‡Øç‡Æ™‡ØÅ ‡Æµ‡Æï‡Øà‡Æï‡Æ≥‡Øç, ‡Æï‡Ææ‡ÆØ‡Øç‡Æï‡Æ±‡Æø‡Æï‡Æ≥‡Øç, ‡Æ™‡Æ¥‡Æô‡Øç‡Æï‡Æ≥‡Øç, ‡Æ™‡Æ£‡Æ™‡Øç‡Æ™‡ÆØ‡Æø‡Æ∞‡Øç‡Æï‡Æ≥‡Øç.",
                    'fertilizer': "‡Æö‡ÆÆ‡Æö‡Øç‡Æö‡ØÄ‡Æ∞‡Øç NPK ‡Æâ‡Æ∞‡ÆÆ‡Øç: ‡Æ™‡ØÜ‡Æ∞‡ØÅ‡ÆÆ‡Øç‡Æ™‡Ææ‡Æ≤‡Ææ‡Æ© ‡Æ™‡ÆØ‡Æø‡Æ∞‡Øç‡Æï‡Æ≥‡ØÅ‡Æï‡Øç‡Æï‡ØÅ ‡Æè‡Æï‡Øç‡Æï‡Æ∞‡ØÅ‡Æï‡Øç‡Æï‡ØÅ 40‡Æï‡Æø‡Æ≤‡Øã ‡ÆØ‡ØÇ‡Æ∞‡Æø‡ÆØ‡Ææ + 25‡Æï‡Æø‡Æ≤‡Øã DAP + 15‡Æï‡Æø‡Æ≤‡Øã MOP. ‡Æ™‡Æø‡Æ∞‡Æø‡Æ§‡Øç‡Æ§ ‡Æ™‡ÆØ‡Æ©‡Øç‡Æ™‡Ææ‡Æü‡ØÅ - ‡Æ™‡Ææ‡Æ§‡Æø ‡Æµ‡Æø‡Æ§‡Øà‡Æï‡Øç‡Æï‡ØÅ‡ÆÆ‡Øç‡Æ™‡Øã‡Æ§‡ØÅ, ‡ÆÆ‡ØÄ‡Æ§‡ÆÆ‡Øç 30-45 ‡Æ®‡Ææ‡Æü‡Øç‡Æï‡Æ≥‡ØÅ‡Æï‡Øç‡Æï‡ØÅ‡Æ™‡Øç ‡Æ™‡Æø‡Æ±‡Æï‡ØÅ.",
                    'pest': "‡Æí‡Æ∞‡ØÅ‡Æô‡Øç‡Æï‡Æø‡Æ£‡Øà‡Æ®‡Øç‡Æ§ ‡Æ™‡ØÇ‡Æö‡Øç‡Æö‡Æø ‡ÆÆ‡Øá‡Æ≤‡Ææ‡Æ£‡Øç‡ÆÆ‡Øà: 1) ‡Æµ‡Øá‡Æ™‡Øç‡Æ™ ‡Æé‡Æ£‡Øç‡Æ£‡ØÜ‡ÆØ‡Øç ‡Æ§‡ØÜ‡Æ≥‡Æø‡Æ™‡Øç‡Æ™‡ØÅ, 2) ‡Æ™‡Ææ‡Æ§‡Æø‡Æï‡Øç‡Æï‡Æ™‡Øç‡Æ™‡Æü‡Øç‡Æü ‡Æ™‡Æï‡ØÅ‡Æ§‡Æø‡Æï‡Æ≥‡Øà ‡ÆÖ‡Æï‡Æ±‡Øç‡Æ±‡Æµ‡ØÅ‡ÆÆ‡Øç, 3) ‡ÆÆ‡Æû‡Øç‡Æö‡Æ≥‡Øç ‡Æí‡Æü‡Øç‡Æü‡ØÅ‡ÆÆ‡Øç ‡Æ™‡Øä‡Æ±‡Æø‡Æï‡Æ≥‡Øç, 4) ‡Æ™‡ÆØ‡Æ©‡Øç‡Æ™‡Æü‡Øà ‡Æ™‡ØÇ‡Æö‡Øç‡Æö‡Æø‡Æï‡Æ≥‡Øç, 5) ‡Æ™‡ÆØ‡Æø‡Æ∞‡Øç ‡Æö‡ØÅ‡Æ¥‡Æ±‡Øç‡Æö‡Æø.",
                    'disease': "‡Æ®‡Øã‡ÆØ‡Øç ‡Æ§‡Æü‡ØÅ‡Æ™‡Øç‡Æ™‡ØÅ: 1) ‡Æï‡Ææ‡Æ±‡Øç‡Æ±‡Øã‡Æü‡Øç‡Æü‡Æ§‡Øç‡Æ§‡Æø‡Æ±‡Øç‡Æï‡ØÅ ‡Æö‡Æ∞‡Æø‡ÆØ‡Ææ‡Æ© ‡Æá‡Æü‡Øà‡Æµ‡ØÜ‡Æ≥‡Æø, 2) ‡Æá‡Æ≤‡Øà‡Æï‡Æ≥‡Æø‡Æ≤‡Øç ‡Æ®‡Øá‡Æ∞‡Æü‡Æø ‡Æ®‡ØÄ‡Æ∞‡Øç ‡Æ§‡ØÜ‡Æ≥‡Æø‡Æ™‡Øç‡Æ™‡ØÅ ‡Æ§‡Æµ‡Æø‡Æ∞‡Øç‡Æï‡Øç‡Æï‡Æµ‡ØÅ‡ÆÆ‡Øç, 3) ‡Æ™‡Ææ‡Æ§‡Æø‡Æï‡Øç‡Æï‡Æ™‡Øç‡Æ™‡Æü‡Øç‡Æü ‡Æ™‡Æï‡ØÅ‡Æ§‡Æø‡Æï‡Æ≥‡Øà ‡Æâ‡Æü‡Æ©‡Øá ‡ÆÖ‡Æï‡Æ±‡Øç‡Æ±‡Æµ‡ØÅ‡ÆÆ‡Øç."
                },
                'te': {
                    'general': "‡∞∏‡∞æ‡∞ß‡∞æ‡∞∞‡∞£ ‡∞µ‡±ç‡∞Ø‡∞µ‡∞∏‡∞æ‡∞Ø‡∞æ‡∞®‡∞ø‡∞ï‡∞ø: 1) ‡∞Æ‡∞ü‡±ç‡∞ü‡∞ø pH ‡∞™‡∞∞‡±Ä‡∞ï‡±ç‡∞∑ (6.0-7.5 ‡∞â‡∞§‡±ç‡∞§‡∞Æ‡∞Ç), 2) ‡∞∏‡±á‡∞Ç‡∞¶‡±ç‡∞∞‡±Ä‡∞Ø ‡∞ï‡∞Ç‡∞™‡±ã‡∞∏‡±ç‡∞ü‡±ç ‡∞â‡∞™‡∞Ø‡±ã‡∞ó‡∞ø‡∞Ç‡∞ö‡∞Ç‡∞°‡∞ø, 3) ‡∞∏‡∞∞‡±à‡∞® ‡∞®‡±Ä‡∞ü‡∞ø‡∞™‡∞æ‡∞∞‡±Å‡∞¶‡∞≤, 4) ‡∞ï‡±Ä‡∞ü‡∞ï‡∞æ‡∞≤ ‡∞™‡∞∞‡±ç‡∞Ø‡∞µ‡±á‡∞ï‡±ç‡∞∑‡∞£. ‡∞®‡±á‡∞®‡±Å ‡∞Ö‡∞®‡±ç‡∞®‡∞ø ‡∞™‡∞Ç‡∞ü‡∞≤‡∞ï‡±Å ‡∞∏‡∞π‡∞æ‡∞Ø‡∞Ç ‡∞ö‡±á‡∞Ø‡∞ó‡∞≤‡∞®‡±Å.",
                    'fertilizer': "‡∞∏‡∞Æ‡∞§‡±Å‡∞≤‡±ç‡∞Ø NPK ‡∞é‡∞∞‡±Å‡∞µ‡±Å: ‡∞ö‡∞æ‡∞≤‡∞æ ‡∞™‡∞Ç‡∞ü‡∞≤‡∞ï‡±Å ‡∞é‡∞ï‡∞∞‡∞ï‡±Å 40‡∞ï‡∞ø‡∞≤‡±ã ‡∞Ø‡±Ç‡∞∞‡∞ø‡∞Ø‡∞æ + 25‡∞ï‡∞ø‡∞≤‡±ã DAP + 15‡∞ï‡∞ø‡∞≤‡±ã MOP. ‡∞µ‡∞ø‡∞≠‡∞ú‡∞ø‡∞§ ‡∞Ö‡∞™‡±ç‡∞≤‡∞ø‡∞ï‡±á‡∞∑‡∞®‡±ç - ‡∞∏‡∞ó‡∞Ç ‡∞µ‡∞ø‡∞§‡±ç‡∞§‡∞®‡∞æ‡∞≤‡±ã, ‡∞Æ‡∞ø‡∞ó‡∞ø‡∞≤‡∞ø‡∞Ç‡∞¶‡∞ø 30-45 ‡∞∞‡±ã‡∞ú‡±Å‡∞≤ ‡∞§‡∞∞‡±ç‡∞µ‡∞æ‡∞§.",
                    'pest': "‡∞∏‡∞Æ‡∞ó‡±ç‡∞∞ ‡∞ï‡±Ä‡∞ü‡∞ï ‡∞®‡∞ø‡∞∞‡±ç‡∞µ‡∞π‡∞£: 1) ‡∞µ‡±á‡∞™ ‡∞®‡±Ç‡∞®‡±Ü ‡∞∏‡±ç‡∞™‡±ç‡∞∞‡±á, 2) ‡∞™‡±ç‡∞∞‡∞≠‡∞æ‡∞µ‡∞ø‡∞§ ‡∞≠‡∞æ‡∞ó‡∞æ‡∞≤‡∞®‡±Å ‡∞§‡±ä‡∞≤‡∞ó‡∞ø‡∞Ç‡∞ö‡∞Ç‡∞°‡∞ø, 3) ‡∞™‡∞∏‡±Å‡∞™‡±Å ‡∞ú‡∞ø‡∞ó‡±Å‡∞∞‡±Å ‡∞â‡∞ö‡±ç‡∞ö‡±Å‡∞≤‡±Å, 4) ‡∞™‡±ç‡∞∞‡∞Ø‡±ã‡∞ú‡∞®‡∞ï‡∞∞‡∞Æ‡±à‡∞® ‡∞ï‡±Ä‡∞ü‡∞ï‡∞æ‡∞≤‡±Å.",
                    'disease': "‡∞µ‡±ç‡∞Ø‡∞æ‡∞ß‡∞ø ‡∞®‡∞ø‡∞µ‡∞æ‡∞∞‡∞£: 1) ‡∞ó‡∞æ‡∞≤‡∞ø ‡∞™‡±ç‡∞∞‡∞∏‡∞∞‡∞£ ‡∞ï‡±ã‡∞∏‡∞Ç ‡∞∏‡∞∞‡±à‡∞® ‡∞Ö‡∞Ç‡∞§‡∞∞‡∞Ç, 2) ‡∞™‡±à ‡∞®‡±Å‡∞Ç‡∞°‡∞ø ‡∞®‡±Ä‡∞∞‡±Å ‡∞™‡±ã‡∞Ø‡∞°‡∞Ç ‡∞Æ‡∞æ‡∞®‡±Å‡∞ï‡±ã‡∞Ç‡∞°‡∞ø, 3) ‡∞∏‡±ã‡∞ï‡∞ø‡∞® ‡∞≠‡∞æ‡∞ó‡∞æ‡∞≤‡∞®‡±Å ‡∞µ‡±Ü‡∞Ç‡∞ü‡∞®‡±á ‡∞§‡±ä‡∞≤‡∞ó‡∞ø‡∞Ç‡∞ö‡∞Ç‡∞°‡∞ø."
                },
                'ml': {
                    'general': "‡¥™‡µä‡¥§‡µÅ‡¥µ‡¥æ‡¥Ø ‡¥ï‡µÉ‡¥∑‡¥ø‡¥ï‡µç‡¥ï‡µç: 1) ‡¥Æ‡¥£‡µç‡¥£‡¥ø‡¥®‡µç‡¥±‡µÜ pH ‡¥™‡¥∞‡¥ø‡¥∂‡µã‡¥ß‡¥® (6.0-7.5 ‡¥â‡¥§‡µç‡¥§‡¥Æ‡¥Ç), 2) ‡¥ú‡µà‡¥µ ‡¥ï‡¥Æ‡µç‡¥™‡µã‡¥∏‡µç‡¥±‡µç‡¥±‡µç ‡¥â‡¥™‡¥Ø‡µã‡¥ó‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥ï, 3) ‡¥∂‡¥∞‡¥ø‡¥Ø‡¥æ‡¥Ø ‡¥ú‡¥≤‡¥∏‡µá‡¥ö‡¥®‡¥Ç, 4) ‡¥ï‡µÄ‡¥ü‡¥ô‡µç‡¥ô‡¥≥‡µÅ‡¥ü‡µÜ ‡¥®‡¥ø‡¥∞‡µÄ‡¥ï‡µç‡¥∑‡¥£‡¥Ç. ‡¥é‡¥®‡¥ø‡¥ï‡µç‡¥ï‡µç ‡¥é‡¥≤‡µç‡¥≤‡¥æ ‡¥µ‡¥ø‡¥≥‡¥ï‡µæ‡¥ï‡µç‡¥ï‡µÅ‡¥Ç ‡¥∏‡¥π‡¥æ‡¥Ø‡¥ø‡¥ï‡µç‡¥ï‡¥æ‡µª ‡¥ï‡¥¥‡¥ø‡¥Ø‡µÅ‡¥Ç.",
                    'fertilizer': "‡¥∏‡¥Æ‡¥§‡µÅ‡¥≤‡¥ø‡¥§‡¥Æ‡¥æ‡¥Ø NPK ‡¥µ‡¥≥‡¥Ç: ‡¥Æ‡¥ø‡¥ï‡µç‡¥ï ‡¥µ‡¥ø‡¥≥‡¥ï‡µæ‡¥ï‡µç‡¥ï‡µÅ‡¥Ç ‡¥è‡¥ï‡µç‡¥ï‡¥±‡¥ø‡¥®‡µç 40‡¥ï‡¥ø‡¥≤‡µã ‡¥Ø‡µÇ‡¥±‡¥ø‡¥Ø + 25‡¥ï‡¥ø‡¥≤‡µã DAP + 15‡¥ï‡¥ø‡¥≤‡µã MOP. ‡¥µ‡¥ø‡¥≠‡¥ú‡¥ø‡¥§ ‡¥™‡µç‡¥∞‡¥Ø‡µã‡¥ó‡¥Ç - ‡¥™‡¥ï‡µÅ‡¥§‡¥ø ‡¥µ‡¥ø‡¥§‡¥Ø‡µç‡¥ï‡µç‡¥ï‡µÅ‡¥Æ‡µç‡¥™‡µã‡µæ, ‡¥¨‡¥æ‡¥ï‡µç‡¥ï‡¥ø 30-45 ‡¥¶‡¥ø‡¥µ‡¥∏‡¥ô‡µç‡¥ô‡µæ‡¥ï‡µç‡¥ï‡µç ‡¥∂‡µá‡¥∑‡¥Ç.",
                    'pest': "‡¥∏‡¥Ç‡¥Ø‡µã‡¥ú‡¥ø‡¥§ ‡¥ï‡µÄ‡¥ü ‡¥™‡¥∞‡¥ø‡¥™‡¥æ‡¥≤‡¥®‡¥Ç: 1) ‡¥µ‡µá‡¥™‡µç‡¥™‡µÜ‡¥£‡µç‡¥£ ‡¥∏‡µç‡¥™‡µç‡¥∞‡µá, 2) ‡¥¨‡¥æ‡¥ß‡¥ø‡¥§ ‡¥≠‡¥æ‡¥ó‡¥ô‡µç‡¥ô‡µæ ‡¥®‡µÄ‡¥ï‡µç‡¥ï‡¥Ç ‡¥ö‡µÜ‡¥Ø‡µç‡¥Ø‡µÅ‡¥ï, 3) ‡¥Æ‡¥û‡µç‡¥û ‡¥í‡¥ü‡µç‡¥ü‡µÅ‡¥®‡µç‡¥® ‡¥ï‡µÜ‡¥£‡¥ø‡¥ï‡µæ.",
                    'disease': "‡¥∞‡µã‡¥ó ‡¥™‡µç‡¥∞‡¥§‡¥ø‡¥∞‡µã‡¥ß‡¥Ç: 1) ‡¥µ‡¥æ‡¥Ø‡µÅ ‡¥∏‡¥û‡µç‡¥ö‡¥æ‡¥∞‡¥§‡µç‡¥§‡¥ø‡¥®‡µç ‡¥∂‡¥∞‡¥ø‡¥Ø‡¥æ‡¥Ø ‡¥Ö‡¥ï‡¥≤‡¥Ç, 2) ‡¥Æ‡µÅ‡¥ï‡¥≥‡¥ø‡µΩ ‡¥®‡¥ø‡¥®‡µç‡¥®‡µç ‡¥µ‡µÜ‡¥≥‡µç‡¥≥‡¥Ç ‡¥í‡¥¥‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥®‡µç‡¥®‡¥§‡µç ‡¥í‡¥¥‡¥ø‡¥µ‡¥æ‡¥ï‡µç‡¥ï‡µÅ‡¥ï, 3) ‡¥∞‡µã‡¥ó‡¥¨‡¥æ‡¥ß‡¥ø‡¥§ ‡¥≠‡¥æ‡¥ó‡¥ô‡µç‡¥ô‡µæ ‡¥â‡¥ü‡¥®‡µÜ ‡¥®‡µÄ‡¥ï‡µç‡¥ï‡¥Ç ‡¥ö‡µÜ‡¥Ø‡µç‡¥Ø‡µÅ‡¥ï."
                },
                'hi': {
                    'general': "‡§∏‡§æ‡§Æ‡§æ‡§®‡•ç‡§Ø ‡§ï‡•É‡§∑‡§ø ‡§ï‡•á ‡§≤‡§ø‡§è: 1) ‡§Æ‡§ø‡§ü‡•ç‡§ü‡•Ä pH ‡§ú‡§æ‡§Ç‡§ö (6.0-7.5 ‡§Ü‡§¶‡§∞‡•ç‡§∂), 2) ‡§ú‡•à‡§µ‡§ø‡§ï ‡§ñ‡§æ‡§¶ ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó, 3) ‡§â‡§ö‡§ø‡§§ ‡§∏‡§ø‡§Ç‡§ö‡§æ‡§à, 4) ‡§ï‡•Ä‡§ü ‡§®‡§ø‡§ó‡§∞‡§æ‡§®‡•Ä‡•§ ‡§Æ‡•à‡§Ç ‡§∏‡§≠‡•Ä ‡§´‡§∏‡§≤‡•ã‡§Ç ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Æ‡§¶‡§¶ ‡§ï‡§∞ ‡§∏‡§ï‡§§‡§æ ‡§π‡•Ç‡§Ç‡•§",
                    'fertilizer': "‡§∏‡§Ç‡§§‡•Å‡§≤‡§ø‡§§ NPK ‡§â‡§∞‡•ç‡§µ‡§∞‡§ï: ‡§Ö‡§ß‡§ø‡§ï‡§æ‡§Ç‡§∂ ‡§´‡§∏‡§≤‡•ã‡§Ç ‡§ï‡•á ‡§≤‡§ø‡§è ‡§™‡•ç‡§∞‡§§‡§ø ‡§è‡§ï‡§°‡§º 40‡§ï‡§ø‡§≤‡•ã ‡§Ø‡•Ç‡§∞‡§ø‡§Ø‡§æ + 25‡§ï‡§ø‡§≤‡•ã DAP + 15‡§ï‡§ø‡§≤‡•ã MOP‡•§ ‡§µ‡§ø‡§≠‡§æ‡§ú‡§ø‡§§ ‡§â‡§™‡§Ø‡•ã‡§ó - ‡§Ü‡§ß‡§æ ‡§¨‡•Å‡§Ü‡§à ‡§ï‡•á ‡§∏‡§Æ‡§Ø, ‡§¨‡§æ‡§ï‡•Ä 30-45 ‡§¶‡§ø‡§® ‡§¨‡§æ‡§¶‡•§",
                    'pest': "‡§è‡§ï‡•Ä‡§ï‡•É‡§§ ‡§ï‡•Ä‡§ü ‡§™‡•ç‡§∞‡§¨‡§Ç‡§ß‡§®: 1) ‡§®‡•Ä‡§Æ ‡§§‡•á‡§≤ ‡§∏‡•ç‡§™‡•ç‡§∞‡•á, 2) ‡§™‡•ç‡§∞‡§≠‡§æ‡§µ‡§ø‡§§ ‡§≠‡§æ‡§ó‡•ã‡§Ç ‡§ï‡•ã ‡§π‡§ü‡§æ‡§è‡§Ç, 3) ‡§™‡•Ä‡§≤‡•á ‡§ö‡§ø‡§™‡§ö‡§ø‡§™‡•á ‡§ú‡§æ‡§≤, 4) ‡§≤‡§æ‡§≠‡§ï‡§æ‡§∞‡•Ä ‡§ï‡•Ä‡§°‡§º‡•á‡•§",
                    'disease': "‡§∞‡•ã‡§ó ‡§∞‡•ã‡§ï‡§•‡§æ‡§Æ: 1) ‡§π‡§µ‡§æ ‡§ï‡•á ‡§∏‡§Ç‡§ö‡§æ‡§∞ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§â‡§ö‡§ø‡§§ ‡§¶‡•Ç‡§∞‡•Ä, 2) ‡§ä‡§™‡§∞ ‡§∏‡•á ‡§™‡§æ‡§®‡•Ä ‡§¶‡•á‡§®‡§æ ‡§¨‡§ö‡•á‡§Ç, 3) ‡§∏‡§Ç‡§ï‡•ç‡§∞‡§Æ‡§ø‡§§ ‡§≠‡§æ‡§ó‡•ã‡§Ç ‡§ï‡•ã ‡§§‡•Å‡§∞‡§Ç‡§§ ‡§π‡§ü‡§æ‡§è‡§Ç‡•§"
                }
            }
            
            # Determine response category based on query analysis
            query_lower = query.lower()
            if any(word in query_lower for word in ['fertilizer', 'urea', 'dap', 'nutrients', '‡¶â‡¶∞‡§Æ‡ßç', '‡∞é‡∞∞‡±Å‡∞µ‡±Å‡∞≤‡±Å', '‡¥µ‡¥≥‡¥Ç', '‡§ñ‡§æ‡§¶']):
                category = 'fertilizer'
            elif any(word in query_lower for word in ['pest', 'insect', 'bug', 'spray', '‡¶™‡ßÇ‡¶ö‡ßç‡¶ö‡¶ø', '‡∞ï‡±Ä‡∞ü‡∞ï‡∞æ‡∞≤‡±Å', '‡¥ï‡µÄ‡¥ü‡¥Ç', '‡§ï‡•Ä‡§ü']):
                category = 'pest'
            elif any(word in query_lower for word in ['disease', 'fungus', 'rot', 'blight', '‡¶®‡ßã‡¶Ø‡¶º', '‡∞µ‡±ç‡∞Ø‡∞æ‡∞ß‡∞ø', '‡¥∞‡µã‡¥ó‡¥Ç', '‡§¨‡•Ä‡§Æ‡§æ‡§∞‡•Ä']):
                category = 'disease'
            else:
                category = 'general'
            
            return practical_fallbacks.get(language, practical_fallbacks['en']).get(category, practical_fallbacks['en']['general'])
        
        # Generate comprehensive answer
        user_context = {
            "profile": request.user_type,
            "crop": request.crop_type,
            "land_size": request.land_size,
            "soil_type": request.soil_type
        }
        
        answer = generate_smart_agriculture_answer(
            request.query, 
            request.language, 
            rag_context, 
            user_context
        )
        
        processing_time = (time.time() - start_time) * 1000
        
        return {
            "answer": answer,
            "confidence": 0.95,
            "processing_time_ms": round(processing_time),
            "language": request.language,
            "mode": "comprehensive_agriculture_assistant",
            "model": "Enhanced Smart RAG with Global Crop Support",
            "rag_sources": [{"category": ctx['category'], "item": ctx['item'], "similarity": ctx['similarity']} for ctx in rag_context],
            "user_context": user_context,
            "supported_crops": "All global crops supported including cereals, legumes, vegetables, fruits, cash crops"
        }
        
    except Exception as e:
        logger.error(f"‚ùå Error: {str(e)}")
        
        # Enhanced fallback with agriculture focus
        practical_fallback = {
            'en': "I'm your comprehensive agriculture assistant for ALL crops worldwide. Ask me about: Cereals (rice, wheat, corn, barley), Legumes (soybeans, chickpeas, lentils), Vegetables (tomatoes, potatoes, onions), Fruits (apples, oranges, bananas), Cash crops (cotton, sugarcane, coffee). I provide soil, pest, fertilizer, and growing advice!",
            'ta': "‡Æ®‡Ææ‡Æ©‡Øç ‡Æâ‡Æ≤‡Æï‡Æ≥‡Ææ‡Æµ‡Æø‡ÆØ ‡ÆÖ‡Æ©‡Øà‡Æ§‡Øç‡Æ§‡ØÅ ‡Æ™‡ÆØ‡Æø‡Æ∞‡Øç‡Æï‡Æ≥‡ØÅ‡Æï‡Øç‡Æï‡ØÅ‡ÆÆ‡Øç ‡Æµ‡Æø‡Æ∞‡Æø‡Æµ‡Ææ‡Æ© ‡Æµ‡Øá‡Æ≥‡Ææ‡Æ£‡Øç ‡Æâ‡Æ§‡Æµ‡Æø‡ÆØ‡Ææ‡Æ≥‡Æ∞‡Øç. ‡Æé‡Æ©‡Øç‡Æ©‡Æø‡Æü‡ÆÆ‡Øç ‡Æï‡Øá‡Æ≥‡ØÅ‡Æô‡Øç‡Æï‡Æ≥‡Øç: ‡Æ§‡Ææ‡Æ©‡Æø‡ÆØ‡Æô‡Øç‡Æï‡Æ≥‡Øç, ‡Æ™‡Æ∞‡ØÅ‡Æ™‡Øç‡Æ™‡ØÅ ‡Æµ‡Æï‡Øà‡Æï‡Æ≥‡Øç, ‡Æï‡Ææ‡ÆØ‡Øç‡Æï‡Æ±‡Æø‡Æï‡Æ≥‡Øç, ‡Æ™‡Æ¥‡Æô‡Øç‡Æï‡Æ≥‡Øç, ‡Æ™‡Æ£‡Æ™‡Øç‡Æ™‡ÆØ‡Æø‡Æ∞‡Øç‡Æï‡Æ≥‡Øç ‡Æ™‡Æ±‡Øç‡Æ±‡Æø.",
            'te': "‡∞®‡±á‡∞®‡±Å ‡∞™‡±ç‡∞∞‡∞™‡∞Ç‡∞ö‡∞µ‡±ç‡∞Ø‡∞æ‡∞™‡±ç‡∞§ ‡∞Ö‡∞®‡±ç‡∞®‡∞ø ‡∞™‡∞Ç‡∞ü‡∞≤‡∞ï‡±Å ‡∞∏‡∞Æ‡∞ó‡±ç‡∞∞ ‡∞µ‡±ç‡∞Ø‡∞µ‡∞∏‡∞æ‡∞Ø ‡∞∏‡∞π‡∞æ‡∞Ø‡∞ï‡±Å‡∞°‡∞®‡±Å. ‡∞®‡∞®‡±ç‡∞®‡±Å ‡∞Ö‡∞°‡∞ó‡∞Ç‡∞°‡∞ø: ‡∞ß‡∞æ‡∞®‡±ç‡∞Ø‡∞æ‡∞≤‡±Å, ‡∞ó‡∞ø‡∞Ç‡∞ú‡∞≤‡±Å, ‡∞ï‡±Ç‡∞∞‡∞ó‡∞æ‡∞Ø‡∞≤‡±Å, ‡∞™‡∞Ç‡∞°‡±ç‡∞≤‡±Å, ‡∞µ‡∞æ‡∞£‡∞ø‡∞ú‡±ç‡∞Ø ‡∞™‡∞Ç‡∞ü‡∞≤ ‡∞ó‡±Å‡∞∞‡∞ø‡∞Ç‡∞ö‡∞ø.",
            'ml': "‡¥û‡¥æ‡µª ‡¥≤‡µã‡¥ï‡¥Æ‡µÜ‡¥Æ‡µç‡¥™‡¥æ‡¥ü‡µÅ‡¥Æ‡µÅ‡¥≥‡µç‡¥≥ ‡¥é‡¥≤‡µç‡¥≤‡¥æ ‡¥µ‡¥ø‡¥≥‡¥ï‡µæ‡¥ï‡µç‡¥ï‡µÅ‡¥Ç ‡¥∏‡¥Æ‡¥ó‡µç‡¥∞ ‡¥ï‡¥æ‡µº‡¥∑‡¥ø‡¥ï ‡¥∏‡¥π‡¥æ‡¥Ø‡¥ø‡¥Ø‡¥æ‡¥£‡µç. ‡¥é‡¥®‡µç‡¥®‡µã‡¥ü‡µç ‡¥ö‡µã‡¥¶‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥ï: ‡¥ß‡¥æ‡¥®‡µç‡¥Ø‡¥ô‡µç‡¥ô‡µæ, ‡¥™‡¥Ø‡µº‡¥µ‡µº‡¥ó‡µç‡¥ó‡¥ô‡µç‡¥ô‡µæ, ‡¥™‡¥ö‡µç‡¥ö‡¥ï‡µç‡¥ï‡¥±‡¥ø‡¥ï‡µæ, ‡¥´‡¥≤‡¥ô‡µç‡¥ô‡µæ, ‡¥µ‡¥æ‡¥£‡¥ø‡¥ú‡µç‡¥Ø ‡¥µ‡¥ø‡¥≥‡¥ï‡µæ.",
            'hi': "‡§Æ‡•à‡§Ç ‡§¶‡•Å‡§®‡§ø‡§Ø‡§æ ‡§≠‡§∞ ‡§ï‡•Ä ‡§∏‡§≠‡•Ä ‡§´‡§∏‡§≤‡•ã‡§Ç ‡§ï‡•á ‡§≤‡§ø‡§è ‡§µ‡•ç‡§Ø‡§æ‡§™‡§ï ‡§ï‡•É‡§∑‡§ø ‡§∏‡§π‡§æ‡§Ø‡§ï ‡§π‡•Ç‡§Ç‡•§ ‡§Æ‡•Å‡§ù‡§∏‡•á ‡§™‡•Ç‡§õ‡•á‡§Ç: ‡§Ö‡§®‡§æ‡§ú, ‡§¶‡§æ‡§≤‡•á‡§Ç, ‡§∏‡§¨‡•ç‡§ú‡§ø‡§Ø‡§æ‡§Ç, ‡§´‡§≤, ‡§®‡§ï‡§¶‡•Ä ‡§´‡§∏‡§≤‡•ã‡§Ç ‡§ï‡•á ‡§¨‡§æ‡§∞‡•á ‡§Æ‡•á‡§Ç‡•§"
        }
        
        return {
            "answer": practical_fallback.get(request.language, practical_fallback['en']),
            "confidence": 0.8,
            "processing_time_ms": round((time.time() - start_time) * 1000),
            "language": request.language,
            "mode": "enhanced_fallback",
            "model": "Global Crop Assistant",
            "error": "handled_gracefully"
        }

@app.post("/whisper-transcribe")
async def whisper_transcribe(request: dict):
    """Transcribe audio using Whisper model"""
    try:
        audio_data = request.get("audio_data", "")
        language = request.get("language", "en")
        
        if not audio_data:
            raise HTTPException(status_code=400, detail="Audio data is required")
        
        logger.info(f"üé§ Transcribing audio with Whisper for {language}")
        
        # Decode base64 audio data
        audio_bytes = base64.b64decode(audio_data)
        
        # Save to temporary file
        with tempfile.NamedTemporaryFile(suffix=".wav", delete=False) as temp_audio:
            temp_audio.write(audio_bytes)
            temp_audio_path = temp_audio.name
        
        try:
            # Transcribe with Whisper
            result = whisper_model.transcribe(
                temp_audio_path,
                language=language if language != 'en' else None  # Let Whisper auto-detect if not English
            )
            
            transcribed_text = result["text"].strip()
            detected_language = result.get("language", language)
            
            logger.info(f"‚úÖ Whisper transcription: '{transcribed_text[:50]}...'")
            
            return {
                "success": True,
                "transcribed_text": transcribed_text,
                "detected_language": detected_language,
                "confidence": result.get("avg_logprob", 0.8)
            }
            
        finally:
            # Clean up temporary file
            if os.path.exists(temp_audio_path):
                os.unlink(temp_audio_path)
                
    except Exception as e:
        logger.error(f"‚ùå Whisper transcription failed: {e}")
        return {
            "success": False,
            "error": str(e),
            "message": "Whisper transcription failed"
        }

@app.post("/generate-tts")
async def generate_tts(request: dict):
    """Generate TTS using gTTS (Google Text-to-Speech) - Perfect for Indian languages"""
    try:
        text = request.get("text", "")
        language = request.get("language", "en")
        
        if not text:
            raise HTTPException(status_code=400, detail="Text is required")
        
        logger.info(f"üîä gTTS Request: {text[:50]}... in {language}")
        
        # Clean and prepare text
        text = re.sub(r'\s+', ' ', text.strip())
        text = text[:500]  # Limit length for gTTS
        
        # Map language codes for gTTS
        gtts_language_map = {
            'en': 'en',
            'ta': 'ta',
            'te': 'te', 
            'ml': 'ml',
            'hi': 'hi',
            'kn': 'kn',  # Kannada
            'bn': 'bn',  # Bengali
            'gu': 'gu',  # Gujarati
            'mr': 'mr',  # Marathi
            'pa': 'pa'   # Punjabi
        }
        
        gtts_lang = gtts_language_map.get(language, 'en')
        logger.info(f"üéµ Using gTTS for {language} -> {gtts_lang}")
        
        # Generate TTS using gTTS
        tts = gTTS(text=text, lang=gtts_lang, slow=False)
        
        # Save to temporary file
        temp_audio = tempfile.mktemp(suffix=".mp3")
        tts.save(temp_audio)
        
        # Convert MP3 to base64 for web playback
        if os.path.exists(temp_audio) and os.path.getsize(temp_audio) > 0:
            with open(temp_audio, "rb") as audio_file:
                audio_base64 = base64.b64encode(audio_file.read()).decode('utf-8')
            
            # Clean up temporary file
            os.unlink(temp_audio)
            
            logger.info(f"‚úÖ gTTS generated successfully for {language}")
            
            return {
                "success": True,
                "audio_base64": audio_base64,
                "service": f"gTTS-{gtts_lang}",
                "voice": f"Google-{language}",
                "language": language,
                "audio_format": "mp3",
                "message": f"Generated high-quality gTTS for {language}"
            }
        else:
            raise Exception("gTTS failed to generate audio file")
            
    except Exception as e:
        logger.error(f"‚ùå gTTS generation failed: {e}")
        
        # Fallback to browser TTS
        return {
            "success": False,
            "use_browser_tts": True,
            "message": f"gTTS failed: {str(e)}. Using browser TTS fallback."
        }

if __name__ == "__main__":
    import uvicorn
    import os
    
    # Get port from environment variable for Railway deployment
    port = int(os.environ.get("PORT", 8002))
    
    logger.info("üåæ Starting Enhanced Global Agriculture AI with Whisper + Smart Assistant + gTTS...")
    logger.info("üéµ Perfect Tamil/Telugu/Malayalam pronunciation with Google TTS!")
    logger.info(f"üöÄ Server starting on port {port}")
    
    # For production deployment, bind to all interfaces
    uvicorn.run(app, host="0.0.0.0", port=port)
